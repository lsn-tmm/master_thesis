/home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf/lib/misc.py:46: H5pyDeprecationWarning: Using default_file_mode other than 'r' is deprecated. Pass the mode to h5py.File() instead.
  h5py.get_config().default_file_mode = 'a'
#####################################################
START: sto-6g
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:39 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 4
num. orbitals of irrep E1x = 1
num. orbitals of irrep E1y = 1
number of shells = 4
number of NR pGTOs = 36
number of NR cGTOs = 6
basis = sto-6g
ecp = {}
CPU time:         0.85
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpk5nu1fm2
max_memory 4000 MB (current use 76 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpk5nu1fm2
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 76 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.342720850757893  LUMO (A1) = 0.479940048466636
Initial guess E= -75.058842175396  |g|= 0.187919
macro= 0  E= -75.0755577221575  delta_E= -0.0167155  |g|= 0.187919  1 KF 4 JK
macro= 1  E= -75.0756000457001  delta_E= -4.23235e-05  |g|= 0.00909564  1 KF 4 JK
macro= 2  E= -75.0756000459116  delta_E= -2.11529e-10  |g|= 2.09324e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 3  E=-75.0756000459116  |g|= 2.09324e-05  total 4 KF 15 JK
converged SCF energy = -75.0756000459116
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpk5nu1fm2
max_memory 4000 MB (current use 80 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpk5nu1fm2
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 80 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.0896986597165579  LUMO (A1) = 0.626301261056972
Initial guess E= -75.0756000459116  |g|= 2.06916e-06
macro= 0  E= -75.075600045912  delta_E= -3.55271e-13  |g|= 2.06916e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 1  E=-75.075600045912  |g|= 2.06916e-06  total 2 KF 4 JK
converged SCF energy = -75.075600045912
**** SCF Summaries ****
Total Energy =                         -75.075600045911969
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.951787973894540
Two-electron Energy =                   33.510489580699911
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y
double occ                     3    1    0
single occ                     0    0    1
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.536044276208   | -20.5493648305845  | -20.5227237218315  occ= 2
MO #2   (A1  #2 ) energy= -1.21890203110246  | -1.29532624317259  | -1.14247781903234  occ= 2
MO #3   (A1  #3 ) energy= -0.534065655257627 | -0.558389729601291 | -0.509741580913962 occ= 2
MO #4   (E1x #1 ) energy= -0.411377359625964 | -0.435107921322088 | -0.387646797929841 occ= 2
MO #5   (E1y #1 ) energy= -0.0896987471422486 | -0.53003016810658  | 0.350632673822082  occ= 1
MO #6   (A1  #4 ) energy= 0.626301244904258  | 0.610650705751679  | 0.641951784056836  occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99998
pop of  0 O 2s        1.85341
pop of  0 O 2px       2.00000
pop of  0 O 2py       1.00000
pop of  0 O 2pz       1.26799
pop of  1 H 1s        0.87862
 ** Mulliken atomic charges  **
charge of  0O =     -0.12138
charge of  1H =      0.12138
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.31297

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (5, 5)
frozen orbitals 1
max_memory 4000 MB (current use 85 MB)
E(UMP2) = -75.0916946186105  E_corr = -0.0160945726985469

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (5, 5)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 85 MB)
Init t2, MP2 energy = -0.0160945726985469
UCISD converged
E(UCISD) = -75.10140007958449  E_corr = -0.02580003367252986

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (5, 5)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 86 MB)
Init t2, MP2 energy = -0.0160945726985469
Init E_corr(CCSD) = -0.0166525533275788
cycle = 1  E_corr(CCSD) = -0.0223010954439906  dE = -0.00564854212  norm(t1,t2) = 0.0296278
cycle = 2  E_corr(CCSD) = -0.0243707869504739  dE = -0.00206969151  norm(t1,t2) = 0.0122536
cycle = 3  E_corr(CCSD) = -0.0257541964059731  dE = -0.00138340946  norm(t1,t2) = 0.00573736
cycle = 4  E_corr(CCSD) = -0.0257697990089229  dE = -1.56026029e-05  norm(t1,t2) = 0.00177121
cycle = 5  E_corr(CCSD) = -0.0258034308793102  dE = -3.36318704e-05  norm(t1,t2) = 0.00055901
cycle = 6  E_corr(CCSD) = -0.0257978243901558  dE = 5.60648915e-06  norm(t1,t2) = 0.000114373
cycle = 7  E_corr(CCSD) = -0.0258003821268071  dE = -2.55773665e-06  norm(t1,t2) = 2.26311e-05
cycle = 8  E_corr(CCSD) = -0.0257998546037568  dE = 5.2752305e-07  norm(t1,t2) = 4.67184e-06
cycle = 9  E_corr(CCSD) = -0.0257998241056933  dE = 3.04980635e-08  norm(t1,t2) = 6.34388e-07
UCCSD converged
E(UCCSD) = -75.10139987001767  E_corr = -0.02579982410569326
UCCSD(T) correction = -1.72001716451721e-07
Active space CI wfn symmetry = E1y
<class 'pyscf.mcscf.casci_symm.SymAdaptedCASCI'> does not have attributes  frozen

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 0
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1y
Density matrix diagonal elements [1.99394643 1.97626913 1.99930189 1.         0.03048255]
CASCI converged
CASCI E = -75.1014003303362  E(CI) = -19.3020589690354  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 0
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpk5nu1fm2
max_memory 4000 MB (current use 86 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1y
CASCI E = -75.1014003303362  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (1 JK  1 micro), CASSCF E = -75.1014003305381  dE = -2.0195046e-10  S^2 = 0.7500000
               |grad[o]|=    0  |grad[c]|= 1.4548042540727833e-05  |ddm|=1.6e-05
1-step CASSCF converged in 1 macro (1 JK 1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99394592 1.97627008 1.99930205 1.         0.03048195]
CASSCF energy = -75.1014003305381
CASCI E = -75.1014003305381  E(CI) = -19.3020589692373  S^2 = 0.7500000
Hartree-Fock    -75.07560004591197
Moller-Plesset  -75.09169461861052
CISD            -75.1014000795845
CCSD            -75.10139987001766
CCSD(T)         -75.10140004201938
CASCI           -75.10140033033618
CASSCF          -75.10140033053813
#####################################################
END: sto-6g
#####################################################
#####################################################
START: 6-31g
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:40 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 7
num. orbitals of irrep E1x = 2
num. orbitals of irrep E1y = 2
number of shells = 7
number of NR pGTOs = 26
number of NR cGTOs = 11
basis = 6-31g
ecp = {}
CPU time:         3.95
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpxe5qdyyn
max_memory 4000 MB (current use 86 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpxe5qdyyn
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 86 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.430456755694774  LUMO (A1) = 0.172052130326996
Initial guess E= -75.3508958363396  |g|= 0.183362
macro= 0  E= -75.360353858271  delta_E= -0.00945802  |g|= 0.183362  2 KF 5 JK
macro= 1  E= -75.3609667716054  delta_E= -0.000612913  |g|= 0.072473  2 KF 5 JK
macro= 2  E= -75.359856218127  delta_E= 0.00111055  |g|= 0.0428274  2 KF 5 JK
macro= 3  E= -75.3602523555145  delta_E= -0.000396137  |g|= 0.0841569  2 KF 5 JK
macro= 4  E= -75.3602637305941  delta_E= -1.13751e-05  |g|= 0.06111  2 KF 5 JK
macro= 5  E= -75.3601445519741  delta_E= 0.000119179  |g|= 0.0751901  2 KF 5 JK
macro= 6  E= -75.3604086124369  delta_E= -0.00026406  |g|= 0.0651525  2 KF 5 JK
macro= 7  E= -75.3601541123875  delta_E= 0.0002545  |g|= 0.0715494  2 KF 5 JK
macro= 8  E= -75.3604305995936  delta_E= -0.000276487  |g|= 0.0649499  2 KF 5 JK
macro= 9  E= -75.3601590016915  delta_E= 0.000271598  |g|= 0.0710002  2 KF 5 JK
macro= 10  E= -75.360431184779  delta_E= -0.000272183  |g|= 0.0647784  2 KF 5 JK
macro= 11  E= -75.3601583679414  delta_E= 0.000272817  |g|= 0.071006  2 KF 5 JK
macro= 12  E= -75.360430571475  delta_E= -0.000272204  |g|= 0.0647785  2 KF 5 JK
macro= 13  E= -75.3601568110841  delta_E= 0.00027376  |g|= 0.0710336  2 KF 5 JK
macro= 14  E= -75.3604302205604  delta_E= -0.000273409  |g|= 0.0648139  2 KF 5 JK
macro= 15  E= -75.3601552057249  delta_E= 0.000275015  |g|= 0.0710505  2 KF 5 JK
macro= 16  E= -75.3604299497744  delta_E= -0.000274744  |g|= 0.0648537  2 KF 5 JK
macro= 17  E= -75.3601536131561  delta_E= 0.000276337  |g|= 0.0710641  2 KF 5 JK
macro= 18  E= -75.3604296886743  delta_E= -0.000276076  |g|= 0.0648938  2 KF 5 JK
macro= 19  E= -75.3601520250898  delta_E= 0.000277664  |g|= 0.0710769  2 KF 5 JK
macro= 20  E= -75.3604294271812  delta_E= -0.000277402  |g|= 0.0649341  2 KF 5 JK
macro= 21  E= -75.3601504385144  delta_E= 0.000278989  |g|= 0.0710895  2 KF 5 JK
macro= 22  E= -75.3604291647336  delta_E= -0.000278726  |g|= 0.0649744  2 KF 5 JK
macro= 23  E= -75.3601488530353  delta_E= 0.000280312  |g|= 0.0711022  2 KF 5 JK
macro= 24  E= -75.3604289013852  delta_E= -0.000280048  |g|= 0.0650147  2 KF 5 JK
macro= 25  E= -75.3601472686521  delta_E= 0.000281633  |g|= 0.0711148  2 KF 5 JK
macro= 26  E= -75.3604286371402  delta_E= -0.000281368  |g|= 0.065055  2 KF 5 JK
macro= 27  E= -75.3601456853844  delta_E= 0.000282952  |g|= 0.0711274  2 KF 5 JK
macro= 28  E= -75.3604283719948  delta_E= -0.000282687  |g|= 0.0650951  2 KF 5 JK
macro= 29  E= -75.3601441032476  delta_E= 0.000284269  |g|= 0.0711401  2 KF 5 JK
macro= 30  E= -75.3604281059497  delta_E= -0.000284003  |g|= 0.0651353  2 KF 5 JK
macro= 31  E= -75.3601425222562  delta_E= 0.000285584  |g|= 0.0711528  2 KF 5 JK
macro= 32  E= -75.3604278390081  delta_E= -0.000285317  |g|= 0.0651753  2 KF 5 JK
macro= 33  E= -75.3601409424246  delta_E= 0.000286897  |g|= 0.0711654  2 KF 5 JK
macro= 34  E= -75.3604275711746  delta_E= -0.000286629  |g|= 0.0652153  2 KF 5 JK
macro= 35  E= -75.3601393637676  delta_E= 0.000288207  |g|= 0.0711781  2 KF 5 JK
macro= 36  E= -75.360427302454  delta_E= -0.000287939  |g|= 0.0652552  2 KF 5 JK
macro= 37  E= -75.3601377862994  delta_E= 0.000289516  |g|= 0.0711909  2 KF 5 JK
macro= 38  E= -75.3604270328511  delta_E= -0.000289247  |g|= 0.0652951  2 KF 5 JK
macro= 39  E= -75.3601362100345  delta_E= 0.000290823  |g|= 0.0712036  2 KF 5 JK
macro= 40  E= -75.3604267623713  delta_E= -0.000290552  |g|= 0.0653349  2 KF 5 JK
macro= 41  E= -75.3601346349876  delta_E= 0.000292127  |g|= 0.0712163  2 KF 5 JK
macro= 42  E= -75.3604264910195  delta_E= -0.000291856  |g|= 0.0653747  2 KF 5 JK
macro= 43  E= -75.3601330611729  delta_E= 0.00029343  |g|= 0.0712291  2 KF 5 JK
macro= 44  E= -75.3604262188009  delta_E= -0.000293158  |g|= 0.0654144  2 KF 5 JK
macro= 45  E= -75.3601314886049  delta_E= 0.00029473  |g|= 0.0712419  2 KF 5 JK
macro= 46  E= -75.3604259457206  delta_E= -0.000294457  |g|= 0.065454  2 KF 5 JK
macro= 47  E= -75.3601299172979  delta_E= 0.000296028  |g|= 0.0712546  2 KF 5 JK
macro= 48  E= -75.3604256717839  delta_E= -0.000295754  |g|= 0.0654936  2 KF 5 JK
macro= 49  E= -75.3601283472662  delta_E= 0.000297325  |g|= 0.0712674  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3601283472662  |g|= 0.0712674  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3601283472662
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpxe5qdyyn
max_memory 4000 MB (current use 86 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpxe5qdyyn
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 86 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.256786069210388  LUMO (A1) = 0.213814107177222
Initial guess E= -75.3601283472662  |g|= 0.065533
macro= 0  E= -75.359639842118  delta_E= 0.000488505  |g|= 0.065533  2 KF 5 JK
macro= 1  E= -75.3608984877223  delta_E= -0.00125865  |g|= 0.0890234  2 KF 5 JK
macro= 2  E= -75.3600052442794  delta_E= 0.000893243  |g|= 0.0456857  2 KF 5 JK
macro= 3  E= -75.360871321857  delta_E= -0.000866078  |g|= 0.0806832  2 KF 5 JK
macro= 4  E= -75.3598929464847  delta_E= 0.000978375  |g|= 0.0428871  2 KF 5 JK
macro= 5  E= -75.360411023969  delta_E= -0.000518077  |g|= 0.0829584  2 KF 5 JK
macro= 6  E= -75.3602646570386  delta_E= 0.000146367  |g|= 0.0563913  2 KF 5 JK
macro= 7  E= -75.3608924194841  delta_E= -0.000627762  |g|= 0.0746928  2 KF 5 JK
macro= 8  E= -75.3599352436448  delta_E= 0.000957176  |g|= 0.0426662  2 KF 5 JK
macro= 9  E= -75.3603746696469  delta_E= -0.000439426  |g|= 0.0822345  2 KF 5 JK
macro= 10  E= -75.3602814348797  delta_E= 9.32348e-05  |g|= 0.0575432  2 KF 5 JK
macro= 11  E= -75.3609001743882  delta_E= -0.00061874  |g|= 0.074429  2 KF 5 JK
macro= 12  E= -75.3599124919414  delta_E= 0.000987682  |g|= 0.0424374  2 KF 5 JK
macro= 13  E= -75.3603466495541  delta_E= -0.000434158  |g|= 0.0828133  2 KF 5 JK
macro= 14  E= -75.360269264591  delta_E= 7.7385e-05  |g|= 0.0582515  2 KF 5 JK
macro= 15  E= -75.3609073514895  delta_E= -0.000638087  |g|= 0.0748941  2 KF 5 JK
macro= 16  E= -75.3598805991625  delta_E= 0.00102675  |g|= 0.0421918  2 KF 5 JK
macro= 17  E= -75.360316715484  delta_E= -0.000436116  |g|= 0.083575  2 KF 5 JK
macro= 18  E= -75.360253661703  delta_E= 6.30538e-05  |g|= 0.0589743  2 KF 5 JK
macro= 19  E= -75.360207786351  delta_E= 4.58754e-05  |g|= 0.0754717  2 KF 5 JK
macro= 20  E= -75.3604051456806  delta_E= -0.000197359  |g|= 0.0631912  2 KF 5 JK
macro= 21  E= -75.3609251012451  delta_E= -0.000519956  |g|= 0.0715899  2 KF 5 JK
macro= 22  E= -75.3598742420509  delta_E= 0.00105086  |g|= 0.0417646  2 KF 5 JK
macro= 23  E= -75.3602627051436  delta_E= -0.000388463  |g|= 0.0838368  2 KF 5 JK
macro= 24  E= -75.3602488549622  delta_E= 1.38502e-05  |g|= 0.0605042  2 KF 5 JK
macro= 25  E= -75.3601397692669  delta_E= 0.000109086  |g|= 0.0756755  2 KF 5 JK
macro= 26  E= -75.3603950995502  delta_E= -0.00025533  |g|= 0.0650209  2 KF 5 JK
macro= 27  E= -75.3601482694601  delta_E= 0.00024683  |g|= 0.0720159  2 KF 5 JK
macro= 28  E= -75.3604166500266  delta_E= -0.000268381  |g|= 0.0649891  2 KF 5 JK
macro= 29  E= -75.3601530377727  delta_E= 0.000263612  |g|= 0.0714352  2 KF 5 JK
macro= 30  E= -75.3604175090787  delta_E= -0.000264471  |g|= 0.0648745  2 KF 5 JK
macro= 31  E= -75.3601527302568  delta_E= 0.000264779  |g|= 0.0714091  2 KF 5 JK
macro= 32  E= -75.3604170670343  delta_E= -0.000264337  |g|= 0.0648837  2 KF 5 JK
macro= 33  E= -75.3601515696298  delta_E= 0.000265497  |g|= 0.0714218  2 KF 5 JK
macro= 34  E= -75.3604167898449  delta_E= -0.00026522  |g|= 0.0649147  2 KF 5 JK
macro= 35  E= -75.3601503549551  delta_E= 0.000266435  |g|= 0.0714322  2 KF 5 JK
macro= 36  E= -75.3604165663705  delta_E= -0.000266211  |g|= 0.0649463  2 KF 5 JK
macro= 37  E= -75.3601491483618  delta_E= 0.000267418  |g|= 0.0714419  2 KF 5 JK
macro= 38  E= -75.360416348544  delta_E= -0.0002672  |g|= 0.0649772  2 KF 5 JK
macro= 39  E= -75.3601479454969  delta_E= 0.000268403  |g|= 0.0714518  2 KF 5 JK
macro= 40  E= -75.3604161302169  delta_E= -0.000268185  |g|= 0.0650078  2 KF 5 JK
macro= 41  E= -75.3601467444112  delta_E= 0.000269386  |g|= 0.0714618  2 KF 5 JK
macro= 42  E= -75.3604159113171  delta_E= -0.000269167  |g|= 0.0650383  2 KF 5 JK
macro= 43  E= -75.3601455448532  delta_E= 0.000270366  |g|= 0.0714719  2 KF 5 JK
macro= 44  E= -75.3604156919833  delta_E= -0.000270147  |g|= 0.0650686  2 KF 5 JK
macro= 45  E= -75.3601443468225  delta_E= 0.000271345  |g|= 0.0714819  2 KF 5 JK
macro= 46  E= -75.360415472255  delta_E= -0.000271125  |g|= 0.0650989  2 KF 5 JK
macro= 47  E= -75.3601431503287  delta_E= 0.000272322  |g|= 0.071492  2 KF 5 JK
macro= 48  E= -75.3604152521435  delta_E= -0.000272102  |g|= 0.0651292  2 KF 5 JK
macro= 49  E= -75.3601419553787  delta_E= 0.000273297  |g|= 0.0715021  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3601419553787  |g|= 0.0715021  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3601419553787
**** SCF Summaries ****
Total Energy =                         -75.360141955378708
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.410722881435873
Two-electron Energy =                   32.684882578774499
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y
double occ                     3    0    1
single occ                     0    1    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6679007068989  | -20.6835753665231  | -20.6522260472746  occ= 2
MO #2   (A1  #2 ) energy= -1.32578028686733  | -1.39451942910562  | -1.25704114462904  occ= 2
MO #3   (A1  #3 ) energy= -0.657578635459198 | -0.678933572136822 | -0.636223698781574 occ= 2
MO #4   (E1y #1 ) energy= -0.547245980718322 | -0.566586085374526 | -0.527905876062118 occ= 2
MO #5   (E1x #1 ) energy= -0.25529643303054  | -0.643946503999341 | 0.133353637938261  occ= 1
MO #6   (A1  #4 ) energy= 0.213765925157388  | 0.208010573364841  | 0.219521276949935  occ= 0
MO #7   (A1  #5 ) energy= 1.08087506981017   | 1.07288048713355   | 1.0888696524868    occ= 0
MO #8   (E1y #2 ) energy= 1.12683809048732   | 1.11832948829782   | 1.13534669267682   occ= 0
MO #9   (E1x #2 ) energy= 1.14261378574464   | 1.06386171653211   | 1.22136585495717   occ= 0
MO #10  (A1  #6 ) energy= 1.19599383503536   | 1.18484086714193   | 1.2071468029288    occ= 0
MO #11  (A1  #7 ) energy= 1.51021162985111   | 1.49104651059447   | 1.52937674910774   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.82628
pop of  0 O 3s        0.00439
pop of  0 O 2px       0.99919
pop of  0 O 2py       1.99838
pop of  0 O 2pz       1.48717
pop of  0 O 3px       0.00081
pop of  0 O 3py       0.00162
pop of  0 O 3pz       0.00068
pop of  1 H 1s        0.66006
pop of  1 H 2s        0.02143
 ** Mulliken atomic charges  **
charge of  0O =     -0.31851
charge of  1H =      0.31851
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  2.12204

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (10, 10)
frozen orbitals 1
max_memory 4000 MB (current use 86 MB)
Init E(MP2) = -0.0894055596107243
cycle = 1  E_corr(MP2) = -0.0894055596107243  dE = 0  norm(t2) = 2.35113e-16
E(UMP2) = -75.4495475149894  E_corr = -0.0894055596107243

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (10, 10)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 86 MB)
Init t2, MP2 energy = -0.0894055596107243
UCISD converged
E(UCISD) = -75.45810074069304  E_corr = -0.09795878531433287

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (10, 10)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 86 MB)
Init t2, MP2 energy = -0.0894055596107244
Init E_corr(CCSD) = -0.0915368622382538
cycle = 1  E_corr(CCSD) = -0.0972983988634196  dE = -0.00576153663  norm(t1,t2) = 0.0317653
cycle = 2  E_corr(CCSD) = -0.0994886527904968  dE = -0.00219025393  norm(t1,t2) = 0.0112969
cycle = 3  E_corr(CCSD) = -0.100802867257579  dE = -0.00131421447  norm(t1,t2) = 0.00547793
cycle = 4  E_corr(CCSD) = -0.100847197778346  dE = -4.43305208e-05  norm(t1,t2) = 0.00154451
cycle = 5  E_corr(CCSD) = -0.10083300982863  dE = 1.41879497e-05  norm(t1,t2) = 0.000713221
cycle = 6  E_corr(CCSD) = -0.100842795278929  dE = -9.7854503e-06  norm(t1,t2) = 0.000278437
cycle = 7  E_corr(CCSD) = -0.100843260167076  dE = -4.64888148e-07  norm(t1,t2) = 8.19094e-05
cycle = 8  E_corr(CCSD) = -0.100843368486741  dE = -1.08319665e-07  norm(t1,t2) = 1.49762e-05
cycle = 9  E_corr(CCSD) = -0.10084334444385  dE = 2.40428909e-08  norm(t1,t2) = 3.34422e-06
cycle = 10  E_corr(CCSD) = -0.100843311973417  dE = 3.24704331e-08  norm(t1,t2) = 6.40501e-07
UCCSD converged
E(UCCSD) = -75.46098526735213  E_corr = -0.100843311973417
UCCSD(T) correction = -0.000670231743167214
Active space CI wfn symmetry = E1x

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 5
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1x
Density matrix diagonal elements [1.99843409 1.99521549 1.99989873 1.         0.00645169]
CASCI converged
CASCI E = -75.3652866865899  E(CI) = -19.5382143604777  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 5
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpxe5qdyyn
max_memory 4000 MB (current use 86 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1x
CASCI E = -75.3652866865899  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (13 JK  3 micro), CASSCF E = -75.3722796108339  dE = -0.0069929242  S^2 = 0.7500000
               |grad[o]|=0.0672  |grad[c]|= 0.008801164396434316  |ddm|=0.0149
macro iter 2 (13 JK  3 micro), CASSCF E = -75.3805145970042  dE = -0.0082349862  S^2 = 0.7500000
               |grad[o]|=0.063  |grad[c]|= 0.008984732012986617  |ddm|=0.0135
macro iter 3 (13 JK  3 micro), CASSCF E = -75.3864963051149  dE = -0.0059817081  S^2 = 0.7500000
               |grad[o]|=0.0508  |grad[c]|= 0.006064752167958317  |ddm|=0.00475
macro iter 4 (14 JK  4 micro), CASSCF E = -75.388179179669  dE = -0.0016828746  S^2 = 0.7500000
               |grad[o]|=0.0267  |grad[c]|= 0.002245718360789505  |ddm|=0.00565
macro iter 5 (3 JK  1 micro), CASSCF E = -75.3881792278555  dE = -4.8186521e-08  S^2 = 0.7500000
               |grad[o]|=0.000179  |grad[c]|= 0.00012389767160542048  |ddm|=3.4e-05
1-step CASSCF converged in 5 macro (56 JK 14 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99394217 1.98004729 1.99970848 1.         0.02630206]
CASSCF energy = -75.3881792278555
CASCI E = -75.3881792278555  E(CI) = -19.5611069017433  S^2 = 0.7500000
Hartree-Fock    -75.36014195537871
Moller-Plesset  -75.44954751498943
CISD            -75.45810074069304
CCSD            -75.46098526735213
CCSD(T)         -75.4616554990953
CASCI           -75.36528668658993
CASSCF          -75.38817922785555
#####################################################
END: 6-31g
#####################################################
#####################################################
START: 6-31++g
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:41 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 10
num. orbitals of irrep E1x = 3
num. orbitals of irrep E1y = 3
number of shells = 10
number of NR pGTOs = 31
number of NR cGTOs = 16
basis = 6-31++g
ecp = {}
CPU time:         7.07
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpx1zaqykk
max_memory 4000 MB (current use 87 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpx1zaqykk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 87 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.428212614631262  LUMO (A1) = 0.039640178163842
Initial guess E= -75.3557998850465  |g|= 0.167199
macro= 0  E= -75.3646728100176  delta_E= -0.00887292  |g|= 0.167199  2 KF 5 JK
macro= 1  E= -75.3640269089886  delta_E= 0.000645901  |g|= 0.0866706  2 KF 5 JK
macro= 2  E= -75.3647095085032  delta_E= -0.0006826  |g|= 0.082633  2 KF 5 JK
macro= 3  E= -75.3636240907838  delta_E= 0.00108542  |g|= 0.0880611  2 KF 5 JK
macro= 4  E= -75.365013927635  delta_E= -0.00138984  |g|= 0.0911484  2 KF 5 JK
macro= 5  E= -75.3657438602161  delta_E= -0.000729933  |g|= 0.0821187  2 KF 5 JK
macro= 6  E= -75.3639261041379  delta_E= 0.00181776  |g|= 0.0461002  2 KF 5 JK
macro= 7  E= -75.3634768040037  delta_E= 0.0004493  |g|= 0.0987438  2 KF 5 JK
macro= 8  E= -75.3648844068059  delta_E= -0.0014076  |g|= 0.0922511  2 KF 5 JK
macro= 9  E= -75.3635180674875  delta_E= 0.00136634  |g|= 0.0851741  2 KF 5 JK
macro= 10  E= -75.3649323420051  delta_E= -0.00141427  |g|= 0.092563  2 KF 5 JK
macro= 11  E= -75.3635281656958  delta_E= 0.00140418  |g|= 0.084417  2 KF 5 JK
macro= 12  E= -75.3649262044112  delta_E= -0.00139804  |g|= 0.0923777  2 KF 5 JK
macro= 13  E= -75.3635111646918  delta_E= 0.00141504  |g|= 0.0846238  2 KF 5 JK
macro= 14  E= -75.3649196872836  delta_E= -0.00140852  |g|= 0.0926249  2 KF 5 JK
macro= 15  E= -75.3634929766974  delta_E= 0.00142671  |g|= 0.0848237  2 KF 5 JK
macro= 16  E= -75.3649130288141  delta_E= -0.00142005  |g|= 0.0928919  2 KF 5 JK
macro= 17  E= -75.36347480891  delta_E= 0.00143822  |g|= 0.0850245  2 KF 5 JK
macro= 18  E= -75.3649064073589  delta_E= -0.0014316  |g|= 0.0931577  2 KF 5 JK
macro= 19  E= -75.3634568608481  delta_E= 0.00144955  |g|= 0.0852235  2 KF 5 JK
macro= 20  E= -75.3648998038003  delta_E= -0.00144294  |g|= 0.0934187  2 KF 5 JK
macro= 21  E= -75.3634391278636  delta_E= 0.00146068  |g|= 0.085421  2 KF 5 JK
macro= 22  E= -75.3648932204163  delta_E= -0.00145409  |g|= 0.0936752  2 KF 5 JK
macro= 23  E= -75.3634216112808  delta_E= 0.00147161  |g|= 0.0856171  2 KF 5 JK
macro= 24  E= -75.3648866587815  delta_E= -0.00146505  |g|= 0.0939272  2 KF 5 JK
macro= 25  E= -75.3634043116177  delta_E= 0.00148235  |g|= 0.0858116  2 KF 5 JK
macro= 26  E= -75.3648801205506  delta_E= -0.00147581  |g|= 0.0941747  2 KF 5 JK
macro= 27  E= -75.3633872292785  delta_E= 0.00149289  |g|= 0.0860046  2 KF 5 JK
macro= 28  E= -75.3648736073181  delta_E= -0.00148638  |g|= 0.0944178  2 KF 5 JK
macro= 29  E= -75.3633703644949  delta_E= 0.00150324  |g|= 0.086196  2 KF 5 JK
macro= 30  E= -75.3648671206231  delta_E= -0.00149676  |g|= 0.0946564  2 KF 5 JK
macro= 31  E= -75.3633537173385  delta_E= 0.0015134  |g|= 0.0863858  2 KF 5 JK
macro= 32  E= -75.3648606619486  delta_E= -0.00150694  |g|= 0.0948908  2 KF 5 JK
macro= 33  E= -75.3633372877268  delta_E= 0.00152337  |g|= 0.0865741  2 KF 5 JK
macro= 34  E= -75.3648542327224  delta_E= -0.00151694  |g|= 0.0951209  2 KF 5 JK
macro= 35  E= -75.3633210754311  delta_E= 0.00153316  |g|= 0.0867606  2 KF 5 JK
macro= 36  E= -75.3648478343168  delta_E= -0.00152676  |g|= 0.0953468  2 KF 5 JK
macro= 37  E= -75.3633050800823  delta_E= 0.00154275  |g|= 0.0869456  2 KF 5 JK
macro= 38  E= -75.3648414680503  delta_E= -0.00153639  |g|= 0.0955685  2 KF 5 JK
macro= 39  E= -75.3632893011785  delta_E= 0.00155217  |g|= 0.0871288  2 KF 5 JK
macro= 40  E= -75.364835135188  delta_E= -0.00154583  |g|= 0.0957861  2 KF 5 JK
macro= 41  E= -75.363273738091  delta_E= 0.0015614  |g|= 0.0873104  2 KF 5 JK
macro= 42  E= -75.3648288369419  delta_E= -0.0015551  |g|= 0.0959996  2 KF 5 JK
macro= 43  E= -75.3632583900712  delta_E= 0.00157045  |g|= 0.0874903  2 KF 5 JK
macro= 44  E= -75.364822574472  delta_E= -0.00156418  |g|= 0.0962092  2 KF 5 JK
macro= 45  E= -75.3632432562561  delta_E= 0.00157932  |g|= 0.0876685  2 KF 5 JK
macro= 46  E= -75.3648163488875  delta_E= -0.00157309  |g|= 0.0964149  2 KF 5 JK
macro= 47  E= -75.3632283356753  delta_E= 0.00158801  |g|= 0.087845  2 KF 5 JK
macro= 48  E= -75.3648101612467  delta_E= -0.00158183  |g|= 0.0966166  2 KF 5 JK
macro= 49  E= -75.3632136272559  delta_E= 0.00159653  |g|= 0.0880197  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3632136272559  |g|= 0.0880197  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3632136272559
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpx1zaqykk
max_memory 4000 MB (current use 87 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpx1zaqykk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 87 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.286764392523403  LUMO (A1) = 0.0409429005297588
Initial guess E= -75.3632136272559  |g|= 0.0968146
macro= 0  E= -75.3641675171877  delta_E= -0.00095389  |g|= 0.0968146  2 KF 5 JK
macro= 1  E= -75.3656052110531  delta_E= -0.00143769  |g|= 0.0957388  2 KF 5 JK
macro= 2  E= -75.3645012116469  delta_E= 0.001104  |g|= 0.0548436  2 KF 5 JK
macro= 3  E= -75.3655320676428  delta_E= -0.00103086  |g|= 0.0882547  2 KF 5 JK
macro= 4  E= -75.3644131857783  delta_E= 0.00111888  |g|= 0.052097  2 KF 5 JK
macro= 5  E= -75.3655174597576  delta_E= -0.00110427  |g|= 0.0896814  2 KF 5 JK
macro= 6  E= -75.3643480207198  delta_E= 0.00116944  |g|= 0.0518005  2 KF 5 JK
macro= 7  E= -75.36551584357  delta_E= -0.00116782  |g|= 0.0907787  2 KF 5 JK
macro= 8  E= -75.3643095055265  delta_E= 0.00120634  |g|= 0.0517161  2 KF 5 JK
macro= 9  E= -75.3655175020726  delta_E= -0.001208  |g|= 0.0914481  2 KF 5 JK
macro= 10  E= -75.3642800025575  delta_E= 0.0012375  |g|= 0.0516442  2 KF 5 JK
macro= 11  E= -75.365520012893  delta_E= -0.00124001  |g|= 0.09197  2 KF 5 JK
macro= 12  E= -75.3642536351802  delta_E= 0.00126638  |g|= 0.0515829  2 KF 5 JK
macro= 13  E= -75.3655228233069  delta_E= -0.00126919  |g|= 0.0924349  2 KF 5 JK
macro= 14  E= -75.3642292623192  delta_E= 0.00129356  |g|= 0.0515438  2 KF 5 JK
macro= 15  E= -75.3655258744363  delta_E= -0.00129661  |g|= 0.0928608  2 KF 5 JK
macro= 16  E= -75.3642073262623  delta_E= 0.00131855  |g|= 0.0515434  2 KF 5 JK
macro= 17  E= -75.3655292925323  delta_E= -0.00132197  |g|= 0.0932441  2 KF 5 JK
macro= 18  E= -75.3641891239105  delta_E= 0.00134017  |g|= 0.0516066  2 KF 5 JK
macro= 19  E= -75.3655333438426  delta_E= -0.00134422  |g|= 0.093573  2 KF 5 JK
macro= 20  E= -75.3641764779854  delta_E= 0.00135687  |g|= 0.0517622  2 KF 5 JK
macro= 21  E= -75.365538383304  delta_E= -0.00136191  |g|= 0.0938334  2 KF 5 JK
macro= 22  E= -75.3641703285503  delta_E= 0.00136805  |g|= 0.0520161  2 KF 5 JK
macro= 23  E= -75.3655445483138  delta_E= -0.00137422  |g|= 0.0940214  2 KF 5 JK
macro= 24  E= -75.3641679019082  delta_E= 0.00137665  |g|= 0.0523006  2 KF 5 JK
macro= 25  E= -75.3655512318201  delta_E= -0.00138333  |g|= 0.0941701  2 KF 5 JK
macro= 26  E= -75.3641628750066  delta_E= 0.00138836  |g|= 0.0524888  2 KF 5 JK
macro= 27  E= -75.3655573104293  delta_E= -0.00139444  |g|= 0.0943509  2 KF 5 JK
macro= 28  E= -75.3641515114305  delta_E= 0.0014058  |g|= 0.0525239  2 KF 5 JK
macro= 29  E= -75.3655622762412  delta_E= -0.00141076  |g|= 0.0946088  2 KF 5 JK
macro= 30  E= -75.3641354447717  delta_E= 0.00142683  |g|= 0.0524624  2 KF 5 JK
macro= 31  E= -75.3655664752044  delta_E= -0.00143103  |g|= 0.0949241  2 KF 5 JK
macro= 32  E= -75.3641178795182  delta_E= 0.0014486  |g|= 0.0523738  2 KF 5 JK
macro= 33  E= -75.3655704233389  delta_E= -0.00145254  |g|= 0.0952566  2 KF 5 JK
macro= 34  E= -75.3641006709998  delta_E= 0.00146975  |g|= 0.0522869  2 KF 5 JK
macro= 35  E= -75.3655743992796  delta_E= -0.00147373  |g|= 0.0955827  2 KF 5 JK
macro= 36  E= -75.3640842713813  delta_E= 0.00149013  |g|= 0.0522025  2 KF 5 JK
macro= 37  E= -75.3655784619592  delta_E= -0.00149419  |g|= 0.0958967  2 KF 5 JK
macro= 38  E= -75.3640685489612  delta_E= 0.00150991  |g|= 0.0521144  2 KF 5 JK
macro= 39  E= -75.3655825831237  delta_E= -0.00151403  |g|= 0.0962007  2 KF 5 JK
macro= 40  E= -75.3640533330186  delta_E= 0.00152925  |g|= 0.0520186  2 KF 5 JK
macro= 41  E= -75.3655867327461  delta_E= -0.0015334  |g|= 0.0964974  2 KF 5 JK
macro= 42  E= -75.3640385601792  delta_E= 0.00154817  |g|= 0.0519143  2 KF 5 JK
macro= 43  E= -75.3655909002772  delta_E= -0.00155234  |g|= 0.096788  2 KF 5 JK
macro= 44  E= -75.3640242267072  delta_E= 0.00156667  |g|= 0.0518019  2 KF 5 JK
macro= 45  E= -75.3655950848047  delta_E= -0.00157086  |g|= 0.0970727  2 KF 5 JK
macro= 46  E= -75.3640103218516  delta_E= 0.00158476  |g|= 0.0516817  2 KF 5 JK
macro= 47  E= -75.3655992828392  delta_E= -0.00158896  |g|= 0.0973518  2 KF 5 JK
macro= 48  E= -75.3639968023736  delta_E= 0.00160248  |g|= 0.0515537  2 KF 5 JK
macro= 49  E= -75.3656034836086  delta_E= -0.00160668  |g|= 0.0976253  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3656034836086  |g|= 0.0976253  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3656034836086
**** SCF Summaries ****
Total Energy =                         -75.365603483608623
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.344990747945616
Two-electron Energy =                   32.613688917054333
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y
double occ                     3    1    0
single occ                     0    0    1
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6732517480229  | -20.6891342964026  | -20.6573691996431  occ= 2
MO #2   (A1  #2 ) energy= -1.33578326164704  | -1.40393739941084  | -1.26762912388324  occ= 2
MO #3   (A1  #3 ) energy= -0.66711805088632  | -0.688188840374251 | -0.646047261398389 occ= 2
MO #4   (E1x #1 ) energy= -0.556745481828836 | -0.575767968883109 | -0.537722994774563 occ= 2
MO #5   (E1y #1 ) energy= -0.266792613920756 | -0.651815829066888 | 0.11823060122537   occ= 1
MO #6   (A1  #4 ) energy= 0.041757346756699  | 0.0406935978901911 | 0.0428210956232069 occ= 0
MO #7   (E1x #2 ) energy= 0.244353244458358  | 0.242733007496711  | 0.245973481420005  occ= 0
MO #8   (E1y #2 ) energy= 0.244614706766597  | 0.229037123707375  | 0.260192289825819  occ= 0
MO #9   (A1  #5 ) energy= 0.245090421832561  | 0.243259706539965  | 0.246921137125158  occ= 0
MO #10  (A1  #6 ) energy= 0.27837906594991   | 0.272285317078433  | 0.284472814821382  occ= 0
MO #11  (A1  #7 ) energy= 0.355897904839556  | 0.351436732263952  | 0.360359077415156  occ= 0
MO #12  (A1  #8 ) energy= 1.27886374680962   | 1.27164226250592   | 1.28608523111331   occ= 0
MO #13  (E1x #3 ) energy= 1.36864503721773   | 1.36075588384045   | 1.37653419059501   occ= 0
MO #14  (E1y #3 ) energy= 1.37737418244423   | 1.30782093731028   | 1.44692742757818   occ= 0
MO #15  (A1  #9 ) energy= 1.43547703932431   | 1.42758409969625   | 1.44336997895236   occ= 0
MO #16  (A1  #10) energy= 1.79217802192531   | 1.77385136158262   | 1.81050468226799   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.82547
pop of  0 O 3s        0.00880
pop of  0 O 4s        0.00255
pop of  0 O 2px       1.99735
pop of  0 O 2py       0.99866
pop of  0 O 2pz       1.49803
pop of  0 O 3px       0.00121
pop of  0 O 3py       0.00061
pop of  0 O 3pz       0.00235
pop of  0 O 4px       0.00144
pop of  0 O 4py       0.00073
pop of  0 O 4pz       0.00194
pop of  1 H 1s        0.63887
pop of  1 H 2s        0.01400
pop of  1 H 3s        0.00800
 ** Mulliken atomic charges  **
charge of  0O =     -0.33914
charge of  1H =      0.33914
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  2.16455

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (15, 15)
frozen orbitals 1
max_memory 4000 MB (current use 87 MB)
Init E(MP2) = -0.0935093536861275
cycle = 1  E_corr(MP2) = -0.0935093536861275  dE = -1.38777878e-17  norm(t2) = 8.76569e-16
E(UMP2) = -75.4591128372948  E_corr = -0.0935093536861275

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (15, 15)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 87 MB)
Init t2, MP2 energy = -0.0935093536861278
UCISD converged
E(UCISD) = -75.46783394710376  E_corr = -0.1022304634951274

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (15, 15)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 87 MB)
Init t2, MP2 energy = -0.0935093536861276
Init E_corr(CCSD) = -0.0952474152770924
cycle = 1  E_corr(CCSD) = -0.100597083832338  dE = -0.00534966856  norm(t1,t2) = 0.0467006
cycle = 2  E_corr(CCSD) = -0.103569000286513  dE = -0.00297191645  norm(t1,t2) = 0.0155991
cycle = 3  E_corr(CCSD) = -0.105100484071496  dE = -0.00153148378  norm(t1,t2) = 0.00859084
cycle = 4  E_corr(CCSD) = -0.105413680707857  dE = -0.000313196636  norm(t1,t2) = 0.00268656
cycle = 5  E_corr(CCSD) = -0.105382979416183  dE = 3.07012917e-05  norm(t1,t2) = 0.00138769
cycle = 6  E_corr(CCSD) = -0.105403433007419  dE = -2.04535912e-05  norm(t1,t2) = 0.000392678
cycle = 7  E_corr(CCSD) = -0.105409959828016  dE = -6.5268206e-06  norm(t1,t2) = 0.000146759
cycle = 8  E_corr(CCSD) = -0.105410528426162  dE = -5.68598146e-07  norm(t1,t2) = 4.69336e-05
cycle = 9  E_corr(CCSD) = -0.10541013440727  dE = 3.94018892e-07  norm(t1,t2) = 1.91504e-05
cycle = 10  E_corr(CCSD) = -0.105409949435314  dE = 1.84971956e-07  norm(t1,t2) = 6.41637e-06
cycle = 11  E_corr(CCSD) = -0.105409855432395  dE = 9.40029195e-08  norm(t1,t2) = 3.12012e-06
cycle = 12  E_corr(CCSD) = -0.105409829175602  dE = 2.62567922e-08  norm(t1,t2) = 1.1914e-06
cycle = 13  E_corr(CCSD) = -0.105409823712014  dE = 5.46358796e-09  norm(t1,t2) = 5.34148e-07
UCCSD converged
E(UCCSD) = -75.47101330732063  E_corr = -0.1054098237120145
UCCSD(T) correction = -0.0011184366593355
Active space CI wfn symmetry = E1y

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 10
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1y
Density matrix diagonal elements [1.99992973e+00 1.99992188e+00 1.99999657e+00 1.00000000e+00
 1.51815574e-04]
CASCI converged
CASCI E = -75.3657530972128  E(CI) = -19.5388041367845  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 10
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpx1zaqykk
max_memory 4000 MB (current use 87 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1y
CASCI E = -75.3657530972128  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.3705892041056  dE = -0.0048361069  S^2 = 0.7500000
               |grad[o]|=0.0485  |grad[c]|= 0.021579290772448356  |ddm|=0.00558
macro iter 2 (21 JK  4 micro), CASSCF E = -75.3852819315003  dE = -0.014692727  S^2 = 0.7500000
               |grad[o]|=0.0383  |grad[c]|= 0.02552128279904293  |ddm|=0.0169
macro iter 3 (18 JK  4 micro), CASSCF E = -75.3934291122446  dE = -0.0081471807  S^2 = 0.7500000
               |grad[o]|=0.0346  |grad[c]|= 0.00905054933693515  |ddm|=0.0115
macro iter 4 (9 JK  4 micro), CASSCF E = -75.3934333319606  dE = -4.219716e-06  S^2 = 0.7500000
               |grad[o]|=0.00251  |grad[c]|= 0.00010739605742504165  |ddm|=0.00174
macro iter 5 (1 JK  1 micro), CASSCF E = -75.3934333319793  dE = -1.8658852e-11  S^2 = 0.7500000
               |grad[o]|=2.75e-05  |grad[c]|= 9.141672706611753e-06  |ddm|=4.18e-06
1-step CASSCF converged in 5 macro (70 JK 17 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99399543 1.97969461 1.99972042 1.         0.02658954]
CASSCF energy = -75.3934333319793
CASCI E = -75.3934333319793  E(CI) = -19.566484371551  S^2 = 0.7500000
Hartree-Fock    -75.36560348360862
Moller-Plesset  -75.45911283729475
CISD            -75.46783394710376
CCSD            -75.47101330732063
CCSD(T)         -75.47213174397997
CASCI           -75.36575309721279
CASSCF          -75.39343333197925
#####################################################
END: 6-31++g
#####################################################
#####################################################
START: 6-31g**
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:43 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 9
num. orbitals of irrep E1x = 4
num. orbitals of irrep E1y = 4
num. orbitals of irrep E2x = 1
num. orbitals of irrep E2y = 1
number of shells = 9
number of NR pGTOs = 34
number of NR cGTOs = 19
basis = 6-31g**
ecp = {}
CPU time:        11.04
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpwatikdnz
max_memory 4000 MB (current use 87 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpwatikdnz
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 87 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.432114552535777  LUMO (A1) = 0.17212484814461
Initial guess E= -75.3719176392149  |g|= 0.21282
macro= 0  E= -75.3819737120544  delta_E= -0.0100561  |g|= 0.21282  2 KF 5 JK
macro= 1  E= -75.3814450603511  delta_E= 0.000528652  |g|= 0.0784186  2 KF 5 JK
macro= 2  E= -75.3821382790843  delta_E= -0.000693219  |g|= 0.0761782  2 KF 5 JK
macro= 3  E= -75.3817523184214  delta_E= 0.000385961  |g|= 0.0712509  2 KF 5 JK
macro= 4  E= -75.3820559704901  delta_E= -0.000303652  |g|= 0.0672678  2 KF 5 JK
macro= 5  E= -75.3817542677184  delta_E= 0.000301703  |g|= 0.0734669  2 KF 5 JK
macro= 6  E= -75.3820365482429  delta_E= -0.000282281  |g|= 0.0670904  2 KF 5 JK
macro= 7  E= -75.3817490506732  delta_E= 0.000287498  |g|= 0.0739391  2 KF 5 JK
macro= 8  E= -75.3820343605098  delta_E= -0.00028531  |g|= 0.0672253  2 KF 5 JK
macro= 9  E= -75.3817470344663  delta_E= 0.000287326  |g|= 0.0739816  2 KF 5 JK
macro= 10  E= -75.3820340452147  delta_E= -0.000287011  |g|= 0.0672803  2 KF 5 JK
macro= 11  E= -75.3817457585144  delta_E= 0.000288287  |g|= 0.0739851  2 KF 5 JK
macro= 12  E= -75.3820338101795  delta_E= -0.000288052  |g|= 0.0673134  2 KF 5 JK
macro= 13  E= -75.3817445685912  delta_E= 0.000289242  |g|= 0.0739903  2 KF 5 JK
macro= 14  E= -75.3820335904667  delta_E= -0.000289022  |g|= 0.0673433  2 KF 5 JK
macro= 15  E= -75.3817433826077  delta_E= 0.000290208  |g|= 0.0739967  2 KF 5 JK
macro= 16  E= -75.382033385828  delta_E= -0.000290003  |g|= 0.067373  2 KF 5 JK
macro= 17  E= -75.3817421938329  delta_E= 0.000291192  |g|= 0.0740038  2 KF 5 JK
macro= 18  E= -75.3820331878205  delta_E= -0.000290994  |g|= 0.0674026  2 KF 5 JK
macro= 19  E= -75.3817410015383  delta_E= 0.000292186  |g|= 0.0740114  2 KF 5 JK
macro= 20  E= -75.3820329908215  delta_E= -0.000291989  |g|= 0.0674323  2 KF 5 JK
macro= 21  E= -75.381739805878  delta_E= 0.000293185  |g|= 0.0740194  2 KF 5 JK
macro= 22  E= -75.3820327923563  delta_E= -0.000292986  |g|= 0.0674619  2 KF 5 JK
macro= 23  E= -75.3817386074498  delta_E= 0.000294185  |g|= 0.0740276  2 KF 5 JK
macro= 24  E= -75.3820325916058  delta_E= -0.000293984  |g|= 0.0674916  2 KF 5 JK
macro= 25  E= -75.3817374069874  delta_E= 0.000295185  |g|= 0.0740362  2 KF 5 JK
macro= 26  E= -75.3820323884885  delta_E= -0.000294982  |g|= 0.0675213  2 KF 5 JK
macro= 27  E= -75.3817362051853  delta_E= 0.000296183  |g|= 0.074045  2 KF 5 JK
macro= 28  E= -75.3820321832147  delta_E= -0.000295978  |g|= 0.067551  2 KF 5 JK
macro= 29  E= -75.3817350026351  delta_E= 0.000297181  |g|= 0.0740539  2 KF 5 JK
macro= 30  E= -75.382031976081  delta_E= -0.000296973  |g|= 0.0675807  2 KF 5 JK
macro= 31  E= -75.3817337998122  delta_E= 0.000298176  |g|= 0.074063  2 KF 5 JK
macro= 32  E= -75.3820317673802  delta_E= -0.000297968  |g|= 0.0676103  2 KF 5 JK
macro= 33  E= -75.3817325970875  delta_E= 0.00029917  |g|= 0.0740721  2 KF 5 JK
macro= 34  E= -75.3820315573672  delta_E= -0.00029896  |g|= 0.0676399  2 KF 5 JK
macro= 35  E= -75.3817313947445  delta_E= 0.000300163  |g|= 0.0740813  2 KF 5 JK
macro= 36  E= -75.3820313462498  delta_E= -0.000299952  |g|= 0.0676695  2 KF 5 JK
macro= 37  E= -75.3817301929971  delta_E= 0.000301153  |g|= 0.0740906  2 KF 5 JK
macro= 38  E= -75.3820311341925  delta_E= -0.000300941  |g|= 0.0676991  2 KF 5 JK
macro= 39  E= -75.3817289920055  delta_E= 0.000302142  |g|= 0.0740999  2 KF 5 JK
macro= 40  E= -75.382030921322  delta_E= -0.000301929  |g|= 0.0677286  2 KF 5 JK
macro= 41  E= -75.3817277918896  delta_E= 0.000303129  |g|= 0.0741092  2 KF 5 JK
macro= 42  E= -75.3820307077349  delta_E= -0.000302916  |g|= 0.067758  2 KF 5 JK
macro= 43  E= -75.3817265927391  delta_E= 0.000304115  |g|= 0.0741186  2 KF 5 JK
macro= 44  E= -75.3820304935041  delta_E= -0.000303901  |g|= 0.0677875  2 KF 5 JK
macro= 45  E= -75.3817253946208  delta_E= 0.000305099  |g|= 0.074128  2 KF 5 JK
macro= 46  E= -75.3820302786845  delta_E= -0.000304884  |g|= 0.0678168  2 KF 5 JK
macro= 47  E= -75.3817241975851  delta_E= 0.000306081  |g|= 0.0741374  2 KF 5 JK
macro= 48  E= -75.3820300633176  delta_E= -0.000305866  |g|= 0.0678462  2 KF 5 JK
macro= 49  E= -75.3817230016703  delta_E= 0.000307062  |g|= 0.0741468  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3817230016703  |g|= 0.0741468  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3817230016703
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpwatikdnz
max_memory 4000 MB (current use 87 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpwatikdnz
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 87 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.254328882458095  LUMO (A1) = 0.223231220421957
Initial guess E= -75.3817230016704  |g|= 0.0678755
macro= 0  E= -75.38129292759  delta_E= 0.000430074  |g|= 0.0678755  2 KF 5 JK
macro= 1  E= -75.382548952961  delta_E= -0.00125603  |g|= 0.0905797  2 KF 5 JK
macro= 2  E= -75.3816131004372  delta_E= 0.000935853  |g|= 0.0471961  2 KF 5 JK
macro= 3  E= -75.3825189731089  delta_E= -0.000905873  |g|= 0.0833035  2 KF 5 JK
macro= 4  E= -75.3814908659438  delta_E= 0.00102811  |g|= 0.0440737  2 KF 5 JK
macro= 5  E= -75.3820760530418  delta_E= -0.000585187  |g|= 0.0857575  2 KF 5 JK
macro= 6  E= -75.3819085868292  delta_E= 0.000167466  |g|= 0.0572584  2 KF 5 JK
macro= 7  E= -75.3825504724766  delta_E= -0.000641886  |g|= 0.0766928  2 KF 5 JK
macro= 8  E= -75.3816202964927  delta_E= 0.000930176  |g|= 0.044255  2 KF 5 JK
macro= 9  E= -75.3825245770193  delta_E= -0.000904281  |g|= 0.0834543  2 KF 5 JK
macro= 10  E= -75.3815868789986  delta_E= 0.000937698  |g|= 0.0442645  2 KF 5 JK
macro= 11  E= -75.3825268605263  delta_E= -0.000939982  |g|= 0.0843262  2 KF 5 JK
macro= 12  E= -75.3816513587745  delta_E= 0.000875502  |g|= 0.0447342  2 KF 5 JK
macro= 13  E= -75.3825293161411  delta_E= -0.000877957  |g|= 0.0829757  2 KF 5 JK
macro= 14  E= -75.3816330768906  delta_E= 0.000896239  |g|= 0.0445244  2 KF 5 JK
macro= 15  E= -75.3825285620531  delta_E= -0.000895485  |g|= 0.0833605  2 KF 5 JK
macro= 16  E= -75.3816334029858  delta_E= 0.000895159  |g|= 0.0445361  2 KF 5 JK
macro= 17  E= -75.3825289630705  delta_E= -0.00089556  |g|= 0.0833677  2 KF 5 JK
macro= 18  E= -75.3816332969671  delta_E= 0.000895666  |g|= 0.044534  2 KF 5 JK
macro= 19  E= -75.3825291869745  delta_E= -0.00089589  |g|= 0.0833755  2 KF 5 JK
macro= 20  E= -75.3816317945389  delta_E= 0.000897392  |g|= 0.0445218  2 KF 5 JK
macro= 21  E= -75.382529377237  delta_E= -0.000897583  |g|= 0.0834129  2 KF 5 JK
macro= 22  E= -75.3816308394452  delta_E= 0.000898538  |g|= 0.0445156  2 KF 5 JK
macro= 23  E= -75.3825295952976  delta_E= -0.000898756  |g|= 0.0834386  2 KF 5 JK
macro= 24  E= -75.3816298012439  delta_E= 0.000899794  |g|= 0.0445086  2 KF 5 JK
macro= 25  E= -75.3825298061997  delta_E= -0.000900005  |g|= 0.0834655  2 KF 5 JK
macro= 26  E= -75.3816287494323  delta_E= 0.000901057  |g|= 0.0445017  2 KF 5 JK
macro= 27  E= -75.3825300174559  delta_E= -0.000901268  |g|= 0.0834926  2 KF 5 JK
macro= 28  E= -75.3816277116325  delta_E= 0.000902306  |g|= 0.0444951  2 KF 5 JK
macro= 29  E= -75.3825302291334  delta_E= -0.000902518  |g|= 0.0835194  2 KF 5 JK
macro= 30  E= -75.3816266719618  delta_E= 0.000903557  |g|= 0.0444884  2 KF 5 JK
macro= 31  E= -75.382530440522  delta_E= -0.000903769  |g|= 0.0835461  2 KF 5 JK
macro= 32  E= -75.3816256341189  delta_E= 0.000904806  |g|= 0.0444818  2 KF 5 JK
macro= 33  E= -75.382530651849  delta_E= -0.000905018  |g|= 0.0835727  2 KF 5 JK
macro= 34  E= -75.3816245981157  delta_E= 0.000906054  |g|= 0.0444752  2 KF 5 JK
macro= 35  E= -75.3825308630704  delta_E= -0.000906265  |g|= 0.0835992  2 KF 5 JK
macro= 36  E= -75.3816235636817  delta_E= 0.000907299  |g|= 0.0444685  2 KF 5 JK
macro= 37  E= -75.3825310741721  delta_E= -0.00090751  |g|= 0.0836257  2 KF 5 JK
macro= 38  E= -75.3816225309498  delta_E= 0.000908543  |g|= 0.0444619  2 KF 5 JK
macro= 39  E= -75.382531285155  delta_E= -0.000908754  |g|= 0.083652  2 KF 5 JK
macro= 40  E= -75.3816214999187  delta_E= 0.000909785  |g|= 0.0444553  2 KF 5 JK
macro= 41  E= -75.3825314960139  delta_E= -0.000909996  |g|= 0.0836784  2 KF 5 JK
macro= 42  E= -75.3816204706007  delta_E= 0.000911025  |g|= 0.0444486  2 KF 5 JK
macro= 43  E= -75.3825317067456  delta_E= -0.000911236  |g|= 0.0837046  2 KF 5 JK
macro= 44  E= -75.3816194430125  delta_E= 0.000912264  |g|= 0.044442  2 KF 5 JK
macro= 45  E= -75.3825319173471  delta_E= -0.000912474  |g|= 0.0837308  2 KF 5 JK
macro= 46  E= -75.3816184171667  delta_E= 0.0009135  |g|= 0.0444354  2 KF 5 JK
macro= 47  E= -75.3825321278155  delta_E= -0.000913711  |g|= 0.0837569  2 KF 5 JK
macro= 48  E= -75.3816173930765  delta_E= 0.000914735  |g|= 0.0444287  2 KF 5 JK
macro= 49  E= -75.3825323381485  delta_E= -0.000914945  |g|= 0.0837829  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3825323381485  |g|= 0.0837829  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3825323381485
**** SCF Summaries ****
Total Energy =                         -75.382532338148451
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.560927955435432
Two-electron Energy =                   32.812697270004328
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y
double occ                     3    0    1    0    0
single occ                     0    1    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6463679250511  | -20.6621880457965  | -20.6305478043057  occ= 2
MO #2   (A1  #2 ) energy= -1.30780046674247  | -1.37728656520845  | -1.23831436827649  occ= 2
MO #3   (A1  #3 ) energy= -0.656820336654482 | -0.677495198269479 | -0.636145475039484 occ= 2
MO #4   (E1y #1 ) energy= -0.538967009434228 | -0.558297950789699 | -0.519636068078757 occ= 2
MO #5   (E1x #1 ) energy= -0.24547197851869  | -0.6356219396622   | 0.144677982624823  occ= 1
MO #6   (A1  #4 ) energy= 0.225217053545045  | 0.21952227508208   | 0.23091183200801   occ= 0
MO #7   (A1  #5 ) energy= 1.01702229899168   | 1.00705931680364   | 1.02698528117972   occ= 0
MO #8   (E1y #2 ) energy= 1.13420695414652   | 1.1257614644868    | 1.14265244380625   occ= 0
MO #9   (E1x #2 ) energy= 1.14989494271705   | 1.07161764371695   | 1.22817224171715   occ= 0
MO #10  (A1  #6 ) energy= 1.17067015477543   | 1.16032820673874   | 1.18101210281213   occ= 0
MO #11  (A1  #7 ) energy= 1.47789245706542   | 1.45857074215181   | 1.49721417197904   occ= 0
MO #12  (E1x #3 ) energy= 1.82268800312084   | 1.78425056384015   | 1.86112544240154   occ= 0
MO #13  (E1y #3 ) energy= 1.82895456354174   | 1.82392327417591   | 1.83398585290756   occ= 0
MO #14  (E2x #1 ) energy= 2.07136603926382   | 2.0235211601917    | 2.11921091833594   occ= 0
MO #15  (E2y #1 ) energy= 2.07136603926382   | 2.0235211601917    | 2.11921091833594   occ= 0
MO #16  (A1  #8 ) energy= 2.66682715310694   | 2.65229480522427   | 2.68135950098962   occ= 0
MO #17  (E1x #4 ) energy= 2.92682690862191   | 2.90980795030217   | 2.94384586694165   occ= 0
MO #18  (E1y #4 ) energy= 2.94215712520203   | 2.93903364586505   | 2.94528060453902   occ= 0
MO #19  (A1  #9 ) energy= 3.76592321691079   | 3.76036762424082   | 3.77147880958076   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.81844
pop of  0 O 3s        0.00383
pop of  0 O 2px       0.99809
pop of  0 O 2py       1.99618
pop of  0 O 2pz       1.50202
pop of  0 O 3px       0.00048
pop of  0 O 3py       0.00097
pop of  0 O 3pz       0.00055
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00146
pop of  0 O 3dz^2     0.00652
pop of  0 O 3dxz      0.00073
pop of  0 O 3dx2-y2    0.00000
pop of  1 H 1s        0.64922
pop of  1 H 2s        0.01765
pop of  1 H 2px       0.00069
pop of  1 H 2py       0.00139
pop of  1 H 2pz       0.00178
 ** Mulliken atomic charges  **
charge of  0O =     -0.32927
charge of  1H =      0.32927
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.84154

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_memory 4000 MB (current use 87 MB)
Init E(MP2) = -0.144250056726601
cycle = 1  E_corr(MP2) = -0.144250056726601  dE = 0  norm(t2) = 3.16382e-16
E(UMP2) = -75.5267823948751  E_corr = -0.144250056726601

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 88 MB)
Init t2, MP2 energy = -0.144250056726601
UCISD converged
E(UCISD) = -75.53954193105176  E_corr = -0.1570095929033093

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 88 MB)
Init t2, MP2 energy = -0.144250056726601
Init E_corr(CCSD) = -0.147667063388897
cycle = 1  E_corr(CCSD) = -0.157906259368924  dE = -0.010239196  norm(t1,t2) = 0.0321941
cycle = 2  E_corr(CCSD) = -0.160524137383349  dE = -0.00261787801  norm(t1,t2) = 0.0103234
cycle = 3  E_corr(CCSD) = -0.161698483085186  dE = -0.0011743457  norm(t1,t2) = 0.00479437
cycle = 4  E_corr(CCSD) = -0.161763822905264  dE = -6.53398201e-05  norm(t1,t2) = 0.00134972
cycle = 5  E_corr(CCSD) = -0.161730920549259  dE = 3.2902356e-05  norm(t1,t2) = 0.000645222
cycle = 6  E_corr(CCSD) = -0.161742368107877  dE = -1.14475586e-05  norm(t1,t2) = 0.000214887
cycle = 7  E_corr(CCSD) = -0.161741920525547  dE = 4.4758233e-07  norm(t1,t2) = 6.6081e-05
cycle = 8  E_corr(CCSD) = -0.161741961530871  dE = -4.10053237e-08  norm(t1,t2) = 1.78928e-05
cycle = 9  E_corr(CCSD) = -0.161742024633065  dE = -6.3102194e-08  norm(t1,t2) = 3.53777e-06
cycle = 10  E_corr(CCSD) = -0.161742017922545  dE = 6.71051956e-09  norm(t1,t2) = 8.29927e-07
UCCSD converged
E(UCCSD) = -75.54427435607101  E_corr = -0.1617420179225451
UCCSD(T) correction = -0.00175285879741418
Active space CI wfn symmetry = E1x

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 13
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1x
Density matrix diagonal elements [1.99852319 1.99617918 1.99989948 1.         0.00539815]
CASCI converged
CASCI E = -75.3869617017616  E(CI) = -19.5598955143282  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 13
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpwatikdnz
max_memory 4000 MB (current use 89 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1x
CASCI E = -75.3869617017616  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.3985161964575  dE = -0.011554495  S^2 = 0.7500000
               |grad[o]|=0.0485  |grad[c]|= 0.02091408605551469  |ddm|=0.0156
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4073012922595  dE = -0.0087850958  S^2 = 0.7500000
               |grad[o]|=0.0453  |grad[c]|= 0.008557177971228222  |ddm|=0.00774
macro iter 3 (12 JK  4 micro), CASSCF E = -75.4079783413576  dE = -0.0006770491  S^2 = 0.7500000
               |grad[o]|=0.017  |grad[c]|= 0.0007957854232294873  |ddm|=0.00404
macro iter 4 (3 JK  1 micro), CASSCF E = -75.4079783557127  dE = -1.4355095e-08  S^2 = 0.7500000
               |grad[o]|=0.000123  |grad[c]|= 0.00010541195631296577  |ddm|=2.82e-05
1-step CASSCF converged in 4 macro (57 JK 13 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99443582 1.98209764 1.99964846 1.         0.02381807]
CASSCF energy = -75.4079783557127
CASCI E = -75.4079783557127  E(CI) = -19.5809121682793  S^2 = 0.7500000
Hartree-Fock    -75.38253233814845
Moller-Plesset  -75.52678239487506
CISD            -75.53954193105176
CCSD            -75.544274356071
CCSD(T)         -75.54602721486842
CASCI           -75.38696170176156
CASSCF          -75.40797835571269
#####################################################
END: 6-31g**
#####################################################
#####################################################
START: 6-31++g**
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:45 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 12
num. orbitals of irrep E1x = 5
num. orbitals of irrep E1y = 5
num. orbitals of irrep E2x = 1
num. orbitals of irrep E2y = 1
number of shells = 12
number of NR pGTOs = 39
number of NR cGTOs = 24
basis = 6-31++g**
ecp = {}
CPU time:        15.37
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp_6pdhb3e
max_memory 4000 MB (current use 89 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp_6pdhb3e
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 89 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.430215079684692  LUMO (A1) = 0.039252025448802
Initial guess E= -75.3769818288196  |g|= 0.198629
macro= 0  E= -75.3862850672147  delta_E= -0.00930324  |g|= 0.198629  2 KF 5 JK
macro= 1  E= -75.3858935621165  delta_E= 0.000391505  |g|= 0.0937919  2 KF 5 JK
macro= 2  E= -75.3862585115072  delta_E= -0.000364949  |g|= 0.0786296  2 KF 5 JK
macro= 3  E= -75.3851225132144  delta_E= 0.001136  |g|= 0.0927757  2 KF 5 JK
macro= 4  E= -75.3865744986931  delta_E= -0.00145199  |g|= 0.094634  2 KF 5 JK
macro= 5  E= -75.385189886468  delta_E= 0.00138461  |g|= 0.0867534  2 KF 5 JK
macro= 6  E= -75.3865608458895  delta_E= -0.00137096  |g|= 0.0935425  2 KF 5 JK
macro= 7  E= -75.385169561448  delta_E= 0.00139128  |g|= 0.0869221  2 KF 5 JK
macro= 8  E= -75.3865563650162  delta_E= -0.0013868  |g|= 0.0938792  2 KF 5 JK
macro= 9  E= -75.3851520514763  delta_E= 0.00140431  |g|= 0.0870181  2 KF 5 JK
macro= 10  E= -75.386550974851  delta_E= -0.00139892  |g|= 0.0941523  2 KF 5 JK
macro= 11  E= -75.3851344266053  delta_E= 0.00141655  |g|= 0.0871676  2 KF 5 JK
macro= 12  E= -75.3865450612674  delta_E= -0.00141063  |g|= 0.0944176  2 KF 5 JK
macro= 13  E= -75.3851169219429  delta_E= 0.00142814  |g|= 0.0873396  2 KF 5 JK
macro= 14  E= -75.3865388820493  delta_E= -0.00142196  |g|= 0.0946757  2 KF 5 JK
macro= 15  E= -75.3850995663218  delta_E= 0.00143932  |g|= 0.0875205  2 KF 5 JK
macro= 16  E= -75.3865326043566  delta_E= -0.00143304  |g|= 0.0949287  2 KF 5 JK
macro= 17  E= -75.3850823949607  delta_E= 0.00145021  |g|= 0.087704  2 KF 5 JK
macro= 18  E= -75.386526301575  delta_E= -0.00144391  |g|= 0.0951771  2 KF 5 JK
macro= 19  E= -75.3850654246842  delta_E= 0.00146088  |g|= 0.0878876  2 KF 5 JK
macro= 20  E= -75.3865200040409  delta_E= -0.00145458  |g|= 0.0954211  2 KF 5 JK
macro= 21  E= -75.3850486625211  delta_E= 0.00147134  |g|= 0.0880704  2 KF 5 JK
macro= 22  E= -75.3865137244639  delta_E= -0.00146506  |g|= 0.0956608  2 KF 5 JK
macro= 23  E= -75.3850321112419  delta_E= 0.00148161  |g|= 0.0882519  2 KF 5 JK
macro= 24  E= -75.386507468611  delta_E= -0.00147536  |g|= 0.0958962  2 KF 5 JK
macro= 25  E= -75.3850157718469  delta_E= 0.0014917  |g|= 0.0884319  2 KF 5 JK
macro= 26  E= -75.3865012395399  delta_E= -0.00148547  |g|= 0.0961274  2 KF 5 JK
macro= 27  E= -75.3849996445704  delta_E= 0.00150159  |g|= 0.0886106  2 KF 5 JK
macro= 28  E= -75.3864950392411  delta_E= -0.00149539  |g|= 0.0963545  2 KF 5 JK
macro= 29  E= -75.3849837292734  delta_E= 0.00151131  |g|= 0.0887876  2 KF 5 JK
macro= 30  E= -75.3864888692663  delta_E= -0.00150514  |g|= 0.0965775  2 KF 5 JK
macro= 31  E= -75.3849680255954  delta_E= 0.00152084  |g|= 0.0889632  2 KF 5 JK
macro= 32  E= -75.3864827309691  delta_E= -0.00151471  |g|= 0.0967964  2 KF 5 JK
macro= 33  E= -75.3849525330178  delta_E= 0.0015302  |g|= 0.0891371  2 KF 5 JK
macro= 34  E= -75.3864766255952  delta_E= -0.00152409  |g|= 0.0970114  2 KF 5 JK
macro= 35  E= -75.3849372508886  delta_E= 0.00153937  |g|= 0.0893095  2 KF 5 JK
macro= 36  E= -75.3864705543183  delta_E= -0.0015333  |g|= 0.0972225  2 KF 5 JK
macro= 37  E= -75.3849221784387  delta_E= 0.00154838  |g|= 0.0894803  2 KF 5 JK
macro= 38  E= -75.3864645182532  delta_E= -0.00154234  |g|= 0.0974296  2 KF 5 JK
macro= 39  E= -75.3849073147888  delta_E= 0.0015572  |g|= 0.0896495  2 KF 5 JK
macro= 40  E= -75.3864585184613  delta_E= -0.0015512  |g|= 0.097633  2 KF 5 JK
macro= 41  E= -75.3848926589573  delta_E= 0.00156586  |g|= 0.0898171  2 KF 5 JK
macro= 42  E= -75.3864525559532  delta_E= -0.0015599  |g|= 0.0978326  2 KF 5 JK
macro= 43  E= -75.3848782098657  delta_E= 0.00157435  |g|= 0.089983  2 KF 5 JK
macro= 44  E= -75.3864466316911  delta_E= -0.00156842  |g|= 0.0980285  2 KF 5 JK
macro= 45  E= -75.3848639663453  delta_E= 0.00158267  |g|= 0.0901473  2 KF 5 JK
macro= 46  E= -75.3864407465886  delta_E= -0.00157678  |g|= 0.0982207  2 KF 5 JK
macro= 47  E= -75.384849927141  delta_E= 0.00159082  |g|= 0.0903099  2 KF 5 JK
macro= 48  E= -75.3864349015127  delta_E= -0.00158497  |g|= 0.0984094  2 KF 5 JK
macro= 49  E= -75.3848360909183  delta_E= 0.00159881  |g|= 0.0904709  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3848360909183  |g|= 0.0904709  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3848360909183
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp_6pdhb3e
max_memory 4000 MB (current use 90 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp_6pdhb3e
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 90 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.284637099612348  LUMO (A1) = 0.0429286738645616
Initial guess E= -75.3848360909184  |g|= 0.0985945
macro= 0  E= -75.3858382237563  delta_E= -0.00100213  |g|= 0.0985945  2 KF 5 JK
macro= 1  E= -75.3872773000398  delta_E= -0.00143908  |g|= 0.0972142  2 KF 5 JK
macro= 2  E= -75.3861110475795  delta_E= 0.00116625  |g|= 0.0564602  2 KF 5 JK
macro= 3  E= -75.3871970671754  delta_E= -0.00108602  |g|= 0.0911083  2 KF 5 JK
macro= 4  E= -75.3860156623491  delta_E= 0.0011814  |g|= 0.0534336  2 KF 5 JK
macro= 5  E= -75.3871826803665  delta_E= -0.00116702  |g|= 0.092572  2 KF 5 JK
macro= 6  E= -75.3859509443172  delta_E= 0.00123174  |g|= 0.053141  2 KF 5 JK
macro= 7  E= -75.3871818496591  delta_E= -0.00123091  |g|= 0.0936174  2 KF 5 JK
macro= 8  E= -75.3859220894701  delta_E= 0.00125976  |g|= 0.0530902  2 KF 5 JK
macro= 9  E= -75.3871860097966  delta_E= -0.00126392  |g|= 0.0941486  2 KF 5 JK
macro= 10  E= -75.3859294630341  delta_E= 0.00125655  |g|= 0.0531294  2 KF 5 JK
macro= 11  E= -75.3871965039605  delta_E= -0.00126704  |g|= 0.0942517  2 KF 5 JK
macro= 12  E= -75.3860014467691  delta_E= 0.00119506  |g|= 0.053336  2 KF 5 JK
macro= 13  E= -75.3872138873302  delta_E= -0.00121244  |g|= 0.0934691  2 KF 5 JK
macro= 14  E= -75.3860377590482  delta_E= 0.00117613  |g|= 0.0532844  2 KF 5 JK
macro= 15  E= -75.3872216466894  delta_E= -0.00118389  |g|= 0.0930637  2 KF 5 JK
macro= 16  E= -75.3860102550931  delta_E= 0.00121139  |g|= 0.0530181  2 KF 5 JK
macro= 17  E= -75.3872242046135  delta_E= -0.00121395  |g|= 0.0935831  2 KF 5 JK
macro= 18  E= -75.3859838729536  delta_E= 0.00124033  |g|= 0.0528742  2 KF 5 JK
macro= 19  E= -75.3872277397855  delta_E= -0.00124387  |g|= 0.0940859  2 KF 5 JK
macro= 20  E= -75.3859652633748  delta_E= 0.00126248  |g|= 0.0527736  2 KF 5 JK
macro= 21  E= -75.3872319911302  delta_E= -0.00126673  |g|= 0.0944661  2 KF 5 JK
macro= 22  E= -75.385946999983  delta_E= 0.00128499  |g|= 0.0526675  2 KF 5 JK
macro= 23  E= -75.3872361352543  delta_E= -0.00128914  |g|= 0.0948312  2 KF 5 JK
macro= 24  E= -75.3859278324015  delta_E= 0.0013083  |g|= 0.0525581  2 KF 5 JK
macro= 25  E= -75.3872401688408  delta_E= -0.00131234  |g|= 0.0952028  2 KF 5 JK
macro= 26  E= -75.3859088362394  delta_E= 0.00133133  |g|= 0.05245  2 KF 5 JK
macro= 27  E= -75.3872442096455  delta_E= -0.00133537  |g|= 0.0955668  2 KF 5 JK
macro= 28  E= -75.3858902090784  delta_E= 0.001354  |g|= 0.0523419  2 KF 5 JK
macro= 29  E= -75.3872482554375  delta_E= -0.00135805  |g|= 0.0959206  2 KF 5 JK
macro= 30  E= -75.3858718172856  delta_E= 0.00137644  |g|= 0.0522325  2 KF 5 JK
macro= 31  E= -75.387252286497  delta_E= -0.00138047  |g|= 0.0962664  2 KF 5 JK
macro= 32  E= -75.3858536530724  delta_E= 0.00139863  |g|= 0.0521219  2 KF 5 JK
macro= 33  E= -75.387256300547  delta_E= -0.00140265  |g|= 0.0966045  2 KF 5 JK
macro= 34  E= -75.3858357473291  delta_E= 0.00142055  |g|= 0.0520101  2 KF 5 JK
macro= 35  E= -75.3872602972373  delta_E= -0.00142455  |g|= 0.0969347  2 KF 5 JK
macro= 36  E= -75.3858181098578  delta_E= 0.00144219  |g|= 0.0518972  2 KF 5 JK
macro= 37  E= -75.3872642737788  delta_E= -0.00144616  |g|= 0.0972571  2 KF 5 JK
macro= 38  E= -75.3858007451801  delta_E= 0.00146353  |g|= 0.0517832  2 KF 5 JK
macro= 39  E= -75.3872682273686  delta_E= -0.00146748  |g|= 0.0975717  2 KF 5 JK
macro= 40  E= -75.385783659699  delta_E= 0.00148457  |g|= 0.0516684  2 KF 5 JK
macro= 41  E= -75.3872721556269  delta_E= -0.0014885  |g|= 0.0978786  2 KF 5 JK
macro= 42  E= -75.3857668590687  delta_E= 0.0015053  |g|= 0.0515526  2 KF 5 JK
macro= 43  E= -75.3872760562368  delta_E= -0.0015092  |g|= 0.0981778  2 KF 5 JK
macro= 44  E= -75.3857503476026  delta_E= 0.00152571  |g|= 0.0514362  2 KF 5 JK
macro= 45  E= -75.3872799269281  delta_E= -0.00152958  |g|= 0.0984695  2 KF 5 JK
macro= 46  E= -75.3857341287682  delta_E= 0.0015458  |g|= 0.0513192  2 KF 5 JK
macro= 47  E= -75.3872837655342  delta_E= -0.00154964  |g|= 0.0987537  2 KF 5 JK
macro= 48  E= -75.3857182052751  delta_E= 0.00156556  |g|= 0.0512017  2 KF 5 JK
macro= 49  E= -75.3872875699948  delta_E= -0.00156936  |g|= 0.0990304  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3872875699948  |g|= 0.0990304  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3872875699948
**** SCF Summaries ****
Total Energy =                         -75.387287569994768
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.412808905677821
Two-electron Energy =                   32.659822988400393
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y
double occ                     3    0    1    0    0
single occ                     0    1    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6714080323081  | -20.6871914913581  | -20.6556245732582  occ= 2
MO #2   (A1  #2 ) energy= -1.32496130572692  | -1.39354536572485  | -1.25637724572899  occ= 2
MO #3   (A1  #3 ) energy= -0.672516183160221 | -0.692832198013506 | -0.652200168306936 occ= 2
MO #4   (E1y #1 ) energy= -0.553747875630934 | -0.572586092882521 | -0.534909658379347 occ= 2
MO #5   (E1x #1 ) energy= -0.264371393521063 | -0.647896135224732 | 0.119153348182591  occ= 1
MO #6   (A1  #4 ) energy= 0.0437638636622984 | 0.0427342882234957 | 0.0447934391011014 occ= 0
MO #7   (A1  #5 ) energy= 0.240634663696715  | 0.238795741439758  | 0.242473585953671  occ= 0
MO #8   (E1y #2 ) energy= 0.244901004050375  | 0.243269315639697  | 0.246532692461052  occ= 0
MO #9   (E1x #2 ) energy= 0.245303377728982  | 0.22958525595161   | 0.261021499506355  occ= 0
MO #10  (A1  #6 ) energy= 0.284869830316686  | 0.278786124334888  | 0.290953536298485  occ= 0
MO #11  (A1  #7 ) energy= 0.36091460766941   | 0.356324979744053  | 0.365504235594762  occ= 0
MO #12  (A1  #8 ) energy= 1.1881502218634    | 1.18024012422312   | 1.19606031950369   occ= 0
MO #13  (E1y #3 ) energy= 1.37056528730373   | 1.36270276974002   | 1.37842780486743   occ= 0
MO #14  (E1x #3 ) energy= 1.37956842246334   | 1.31004655109999   | 1.44909029382668   occ= 0
MO #15  (A1  #9 ) energy= 1.3889683208224    | 1.37976183472124   | 1.39817480692356   occ= 0
MO #16  (A1  #10) energy= 1.75263552580514   | 1.73440207713805   | 1.77086897447225   occ= 0
MO #17  (E1x #4 ) energy= 1.81062730591584   | 1.77273910050382   | 1.84851551132786   occ= 0
MO #18  (E1y #4 ) energy= 1.81706734080805   | 1.81210128148967   | 1.82203340012643   occ= 0
MO #19  (E2x #1 ) energy= 2.0555427424782    | 2.00863131073871   | 2.10245417421769   occ= 0
MO #20  (E2y #1 ) energy= 2.0555427424782    | 2.00863131073871   | 2.1024541742177    occ= 0
MO #21  (A1  #11) energy= 2.70788512453834   | 2.69431306564482   | 2.72145718343186   occ= 0
MO #22  (E1x #5 ) energy= 2.9198061167987    | 2.90320511655786   | 2.93640711703954   occ= 0
MO #23  (E1y #5 ) energy= 2.93513790008286   | 2.93206781527503   | 2.93820798489068   occ= 0
MO #24  (A1  #12) energy= 3.78632719499678   | 3.78092867871699   | 3.79172571127658   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.81769
pop of  0 O 3s        0.00746
pop of  0 O 4s        0.00217
pop of  0 O 2px       0.99717
pop of  0 O 2py       1.99437
pop of  0 O 2pz       1.51261
pop of  0 O 3px       0.00067
pop of  0 O 3py       0.00134
pop of  0 O 3pz       0.00206
pop of  0 O 4px       0.00065
pop of  0 O 4py       0.00127
pop of  0 O 4pz       0.00198
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00140
pop of  0 O 3dz^2     0.00667
pop of  0 O 3dxz      0.00070
pop of  0 O 3dx2-y2    0.00000
pop of  1 H 1s        0.62874
pop of  1 H 2s        0.01239
pop of  1 H 3s        0.00644
pop of  1 H 2px       0.00081
pop of  1 H 2py       0.00162
pop of  1 H 2pz       0.00179
 ** Mulliken atomic charges  **
charge of  0O =     -0.34820
charge of  1H =      0.34820
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.88781

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (23, 23)
frozen orbitals 1
max_memory 4000 MB (current use 90 MB)
Init E(MP2) = -0.148348630554149
cycle = 1  E_corr(MP2) = -0.148348630554149  dE = 5.55111512e-17  norm(t2) = 9.53463e-16
E(UMP2) = -75.5356362005489  E_corr = -0.148348630554149

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (23, 23)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 91 MB)
Init t2, MP2 energy = -0.148348630554149
UCISD converged
E(UCISD) = -75.54820585082359  E_corr = -0.1609182808288216

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (23, 23)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 87 MB)
Init t2, MP2 energy = -0.148348630554149
Init E_corr(CCSD) = -0.152074128041759
cycle = 1  E_corr(CCSD) = -0.161477815526461  dE = -0.00940368748  norm(t1,t2) = 0.0442737
cycle = 2  E_corr(CCSD) = -0.16467450596986  dE = -0.00319669044  norm(t1,t2) = 0.0135343
cycle = 3  E_corr(CCSD) = -0.16579840129657  dE = -0.00112389533  norm(t1,t2) = 0.00729337
cycle = 4  E_corr(CCSD) = -0.1662056691569  dE = -0.00040726786  norm(t1,t2) = 0.00258526
cycle = 5  E_corr(CCSD) = -0.166141472227762  dE = 6.41969291e-05  norm(t1,t2) = 0.00106778
cycle = 6  E_corr(CCSD) = -0.166156437885393  dE = -1.49656576e-05  norm(t1,t2) = 0.000305973
cycle = 7  E_corr(CCSD) = -0.166163736607535  dE = -7.29872214e-06  norm(t1,t2) = 0.000114823
cycle = 8  E_corr(CCSD) = -0.166164169731257  dE = -4.33123722e-07  norm(t1,t2) = 3.89349e-05
cycle = 9  E_corr(CCSD) = -0.166163599250013  dE = 5.70481244e-07  norm(t1,t2) = 1.53968e-05
cycle = 10  E_corr(CCSD) = -0.166163468123695  dE = 1.31126318e-07  norm(t1,t2) = 4.19386e-06
cycle = 11  E_corr(CCSD) = -0.166163424388128  dE = 4.37355674e-08  norm(t1,t2) = 1.98358e-06
cycle = 12  E_corr(CCSD) = -0.16616341040005  dE = 1.3988078e-08  norm(t1,t2) = 8.92757e-07
UCCSD converged
E(UCCSD) = -75.55345098039483  E_corr = -0.1661634104000495
UCCSD(T) correction = -0.00232529862896143
Active space CI wfn symmetry = E1x

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 18
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1x
Density matrix diagonal elements [1.99993309e+00 1.99993505e+00 1.99999673e+00 1.00000000e+00
 1.35120079e-04]
CASCI converged
CASCI E = -75.3874239845791  E(CI) = -19.5603700604036  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 18
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp_6pdhb3e
max_memory 4000 MB (current use 90 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1x
CASCI E = -75.3874239845791  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.3920319270745  dE = -0.0046079425  S^2 = 0.7500000
               |grad[o]|=0.0502  |grad[c]|= 0.020947561903521848  |ddm|=0.00704
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4053733714136  dE = -0.013341444  S^2 = 0.7500000
               |grad[o]|=0.0376  |grad[c]|= 0.024743561765143567  |ddm|=0.0138
macro iter 3 (19 JK  4 micro), CASSCF E = -75.4132009215772  dE = -0.0078275502  S^2 = 0.7500000
               |grad[o]|=0.0334  |grad[c]|= 0.009760773426437297  |ddm|=0.0119
macro iter 4 (9 JK  4 micro), CASSCF E = -75.4132194406947  dE = -1.8519117e-05  S^2 = 0.7500000
               |grad[o]|=0.00366  |grad[c]|= 0.00015284085711110917  |ddm|=0.0022
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4132194425107  dE = -1.816062e-09  S^2 = 0.7500000
               |grad[o]|=4.46e-05  |grad[c]|= 3.1729655998502177e-05  |ddm|=3.34e-05
1-step CASSCF converged in 5 macro (73 JK 17 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.994488   1.98196512 1.99966418 1.         0.0238827 ]
CASSCF energy = -75.4132194425107
CASCI E = -75.4132194425107  E(CI) = -19.5861655183353  S^2 = 0.7500000
Hartree-Fock    -75.38728756999477
Moller-Plesset  -75.53563620054892
CISD            -75.54820585082359
CCSD            -75.55345098039481
CCSD(T)         -75.55577627902377
CASCI           -75.38742398457907
CASSCF          -75.41321944251072
#####################################################
END: 6-31++g**
#####################################################
#####################################################
START: cc-pvdz
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:47 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 9
num. orbitals of irrep E1x = 4
num. orbitals of irrep E1y = 4
num. orbitals of irrep E2x = 1
num. orbitals of irrep E2y = 1
number of shells = 8
number of NR pGTOs = 33
number of NR cGTOs = 19
basis = cc-pvdz
ecp = {}
CPU time:        21.35
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpbvalljml
max_memory 4000 MB (current use 90 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpbvalljml
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 90 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.43157936963096  LUMO (A1) = 0.142147960201031
Initial guess E= -75.378282244309  |g|= 0.213997
macro= 0  E= -75.3885149148513  delta_E= -0.0102327  |g|= 0.213997  2 KF 5 JK
macro= 1  E= -75.3891170343138  delta_E= -0.000602119  |g|= 0.0770396  2 KF 5 JK
macro= 2  E= -75.3878910218081  delta_E= 0.00122601  |g|= 0.0428132  2 KF 5 JK
macro= 3  E= -75.3883077860816  delta_E= -0.000416764  |g|= 0.0877583  2 KF 5 JK
macro= 4  E= -75.3883243308636  delta_E= -1.65448e-05  |g|= 0.0636464  2 KF 5 JK
macro= 5  E= -75.3881472075318  delta_E= 0.000177123  |g|= 0.0788678  2 KF 5 JK
macro= 6  E= -75.3884950192929  delta_E= -0.000347812  |g|= 0.069247  2 KF 5 JK
macro= 7  E= -75.3881500680329  delta_E= 0.000344951  |g|= 0.0747674  2 KF 5 JK
macro= 8  E= -75.3885154817098  delta_E= -0.000365414  |g|= 0.0693071  2 KF 5 JK
macro= 9  E= -75.3881538616606  delta_E= 0.00036162  |g|= 0.0742022  2 KF 5 JK
macro= 10  E= -75.3885123883046  delta_E= -0.000358527  |g|= 0.0691713  2 KF 5 JK
macro= 11  E= -75.3881520860393  delta_E= 0.000360302  |g|= 0.0742558  2 KF 5 JK
macro= 12  E= -75.3885102416379  delta_E= -0.000358156  |g|= 0.0691993  2 KF 5 JK
macro= 13  E= -75.3881499064041  delta_E= 0.000360335  |g|= 0.0742957  2 KF 5 JK
macro= 14  E= -75.3885092341045  delta_E= -0.000359328  |g|= 0.0692491  2 KF 5 JK
macro= 15  E= -75.3881479343414  delta_E= 0.0003613  |g|= 0.0743136  2 KF 5 JK
macro= 16  E= -75.3885086483267  delta_E= -0.000360714  |g|= 0.0692969  2 KF 5 JK
macro= 17  E= -75.3881460729917  delta_E= 0.000362575  |g|= 0.0743254  2 KF 5 JK
macro= 18  E= -75.3885082185609  delta_E= -0.000362146  |g|= 0.0693428  2 KF 5 JK
macro= 19  E= -75.3881442527303  delta_E= 0.000363966  |g|= 0.0743363  2 KF 5 JK
macro= 20  E= -75.3885078484818  delta_E= -0.000363596  |g|= 0.0693877  2 KF 5 JK
macro= 21  E= -75.3881424453351  delta_E= 0.000365403  |g|= 0.0743476  2 KF 5 JK
macro= 22  E= -75.3885074977468  delta_E= -0.000365052  |g|= 0.0694322  2 KF 5 JK
macro= 23  E= -75.3881406398189  delta_E= 0.000366858  |g|= 0.0743598  2 KF 5 JK
macro= 24  E= -75.388507148812  delta_E= -0.000366509  |g|= 0.0694762  2 KF 5 JK
macro= 25  E= -75.3881388322035  delta_E= 0.000368317  |g|= 0.0743729  2 KF 5 JK
macro= 26  E= -75.388506794612  delta_E= -0.000367962  |g|= 0.0695201  2 KF 5 JK
macro= 27  E= -75.3881370215098  delta_E= 0.000369773  |g|= 0.0743868  2 KF 5 JK
macro= 28  E= -75.3885064329463  delta_E= -0.000369411  |g|= 0.0695638  2 KF 5 JK
macro= 29  E= -75.3881352080018  delta_E= 0.000371225  |g|= 0.0744014  2 KF 5 JK
macro= 30  E= -75.3885060637624  delta_E= -0.000370856  |g|= 0.0696074  2 KF 5 JK
macro= 31  E= -75.3881333923826  delta_E= 0.000372671  |g|= 0.0744165  2 KF 5 JK
macro= 32  E= -75.3885056878459  delta_E= -0.000372295  |g|= 0.0696508  2 KF 5 JK
macro= 33  E= -75.3881315754341  delta_E= 0.000374112  |g|= 0.074432  2 KF 5 JK
macro= 34  E= -75.3885053062086  delta_E= -0.000373731  |g|= 0.0696942  2 KF 5 JK
macro= 35  E= -75.3881297578699  delta_E= 0.000375548  |g|= 0.0744479  2 KF 5 JK
macro= 36  E= -75.3885049198229  delta_E= -0.000375162  |g|= 0.0697374  2 KF 5 JK
macro= 37  E= -75.3881279402866  delta_E= 0.00037698  |g|= 0.074464  2 KF 5 JK
macro= 38  E= -75.3885045295228  delta_E= -0.000376589  |g|= 0.0697806  2 KF 5 JK
macro= 39  E= -75.388126123161  delta_E= 0.000378406  |g|= 0.0744802  2 KF 5 JK
macro= 40  E= -75.388504135983  delta_E= -0.000378013  |g|= 0.0698236  2 KF 5 JK
macro= 41  E= -75.3881243068639  delta_E= 0.000379829  |g|= 0.0744967  2 KF 5 JK
macro= 42  E= -75.3885037397321  delta_E= -0.000379433  |g|= 0.0698666  2 KF 5 JK
macro= 43  E= -75.38812249168  delta_E= 0.000381248  |g|= 0.0745132  2 KF 5 JK
macro= 44  E= -75.3885033411742  delta_E= -0.000380849  |g|= 0.0699095  2 KF 5 JK
macro= 45  E= -75.3881206778255  delta_E= 0.000382663  |g|= 0.0745298  2 KF 5 JK
macro= 46  E= -75.3885029406159  delta_E= -0.000382263  |g|= 0.0699523  2 KF 5 JK
macro= 47  E= -75.3881188654647  delta_E= 0.000384075  |g|= 0.0745465  2 KF 5 JK
macro= 48  E= -75.3885025382859  delta_E= -0.000383673  |g|= 0.069995  2 KF 5 JK
macro= 49  E= -75.3881170547228  delta_E= 0.000385484  |g|= 0.0745632  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3881170547228  |g|= 0.0745632  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3881170547228
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpbvalljml
max_memory 4000 MB (current use 90 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpbvalljml
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 90 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.250214475376365  LUMO (A1) = 0.187896423149174
Initial guess E= -75.3881170547227  |g|= 0.0700377
macro= 0  E= -75.3878125783554  delta_E= 0.000304476  |g|= 0.0700377  2 KF 5 JK
macro= 1  E= -75.3890309953505  delta_E= -0.00121842  |g|= 0.0896135  2 KF 5 JK
macro= 2  E= -75.388096002894  delta_E= 0.000934992  |g|= 0.0472447  2 KF 5 JK
macro= 3  E= -75.3884945304382  delta_E= -0.000398528  |g|= 0.0830017  2 KF 5 JK
macro= 4  E= -75.3884288894072  delta_E= 6.5641e-05  |g|= 0.0593576  2 KF 5 JK
macro= 5  E= -75.3890240011897  delta_E= -0.000595112  |g|= 0.0751418  2 KF 5 JK
macro= 6  E= -75.3880402519679  delta_E= 0.000983749  |g|= 0.0438641  2 KF 5 JK
macro= 7  E= -75.3885120039914  delta_E= -0.000471752  |g|= 0.0842084  2 KF 5 JK
macro= 8  E= -75.388369338197  delta_E= 0.000142666  |g|= 0.0584077  2 KF 5 JK
macro= 9  E= -75.3890305479929  delta_E= -0.00066121  |g|= 0.0768919  2 KF 5 JK
macro= 10  E= -75.3880434479521  delta_E= 0.0009871  |g|= 0.0438496  2 KF 5 JK
macro= 11  E= -75.3890025150368  delta_E= -0.000959067  |g|= 0.0844588  2 KF 5 JK
macro= 12  E= -75.3880781193637  delta_E= 0.000924396  |g|= 0.0441725  2 KF 5 JK
macro= 13  E= -75.3890127274451  delta_E= -0.000934608  |g|= 0.084139  2 KF 5 JK
macro= 14  E= -75.3881390434195  delta_E= 0.000873684  |g|= 0.0446592  2 KF 5 JK
macro= 15  E= -75.3890134679942  delta_E= -0.000874425  |g|= 0.0827997  2 KF 5 JK
macro= 16  E= -75.3881137714463  delta_E= 0.000899697  |g|= 0.0443238  2 KF 5 JK
macro= 17  E= -75.3890126682893  delta_E= -0.000898897  |g|= 0.0833482  2 KF 5 JK
macro= 18  E= -75.388119112703  delta_E= 0.000893556  |g|= 0.0443778  2 KF 5 JK
macro= 19  E= -75.3890132894564  delta_E= -0.000894177  |g|= 0.0832535  2 KF 5 JK
macro= 20  E= -75.3881173415517  delta_E= 0.000895948  |g|= 0.044355  2 KF 5 JK
macro= 21  E= -75.389013429797  delta_E= -0.000896088  |g|= 0.0832955  2 KF 5 JK
macro= 22  E= -75.3881161058628  delta_E= 0.000897324  |g|= 0.0443439  2 KF 5 JK
macro= 23  E= -75.3890136547302  delta_E= -0.000897549  |g|= 0.0833284  2 KF 5 JK
macro= 24  E= -75.3881151849044  delta_E= 0.00089847  |g|= 0.0443369  2 KF 5 JK
macro= 25  E= -75.3890138816479  delta_E= -0.000898697  |g|= 0.0833533  2 KF 5 JK
macro= 26  E= -75.3881140964119  delta_E= 0.000899785  |g|= 0.0443287  2 KF 5 JK
macro= 27  E= -75.3890141016665  delta_E= -0.000900005  |g|= 0.0833815  2 KF 5 JK
macro= 28  E= -75.3881130544567  delta_E= 0.000901047  |g|= 0.0443213  2 KF 5 JK
macro= 29  E= -75.3890143244022  delta_E= -0.00090127  |g|= 0.0834086  2 KF 5 JK
macro= 30  E= -75.3881120079077  delta_E= 0.000902316  |g|= 0.044314  2 KF 5 JK
macro= 31  E= -75.389014546491  delta_E= -0.000902539  |g|= 0.0834357  2 KF 5 JK
macro= 32  E= -75.3881109619361  delta_E= 0.000903585  |g|= 0.0443068  2 KF 5 JK
macro= 33  E= -75.3890147685443  delta_E= -0.000903807  |g|= 0.0834626  2 KF 5 JK
macro= 34  E= -75.3881099183265  delta_E= 0.00090485  |g|= 0.0442996  2 KF 5 JK
macro= 35  E= -75.3890149905367  delta_E= -0.000905072  |g|= 0.0834895  2 KF 5 JK
macro= 36  E= -75.3881088760097  delta_E= 0.000906115  |g|= 0.0442923  2 KF 5 JK
macro= 37  E= -75.3890152124192  delta_E= -0.000906336  |g|= 0.0835164  2 KF 5 JK
macro= 38  E= -75.3881078353295  delta_E= 0.000907377  |g|= 0.0442851  2 KF 5 JK
macro= 39  E= -75.3890154342054  delta_E= -0.000907599  |g|= 0.0835431  2 KF 5 JK
macro= 40  E= -75.3881067962486  delta_E= 0.000908638  |g|= 0.0442779  2 KF 5 JK
macro= 41  E= -75.3890156558874  delta_E= -0.00090886  |g|= 0.0835698  2 KF 5 JK
macro= 42  E= -75.3881057587779  delta_E= 0.000909897  |g|= 0.0442707  2 KF 5 JK
macro= 43  E= -75.3890158774626  delta_E= -0.000910119  |g|= 0.0835964  2 KF 5 JK
macro= 44  E= -75.3881047229347  delta_E= 0.000911155  |g|= 0.0442634  2 KF 5 JK
macro= 45  E= -75.3890160989287  delta_E= -0.000911376  |g|= 0.0836229  2 KF 5 JK
macro= 46  E= -75.388103688729  delta_E= 0.00091241  |g|= 0.0442562  2 KF 5 JK
macro= 47  E= -75.3890163202828  delta_E= -0.000912632  |g|= 0.0836494  2 KF 5 JK
macro= 48  E= -75.3881026561726  delta_E= 0.000913664  |g|= 0.0442489  2 KF 5 JK
macro= 49  E= -75.3890165415227  delta_E= -0.000913885  |g|= 0.0836758  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3890165415227  |g|= 0.0836758  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3890165415227
**** SCF Summaries ****
Total Energy =                         -75.389016541522707
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.619027795733274
Two-electron Energy =                   32.864312906927907
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y
double occ                     3    0    1    0    0
single occ                     0    1    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6368904578329  | -20.652839915379   | -20.6209410002868  occ= 2
MO #2   (A1  #2 ) energy= -1.30476088989577  | -1.37417073405727  | -1.23535104573427  occ= 2
MO #3   (A1  #3 ) energy= -0.653747152963482 | -0.674618094659532 | -0.632876211267432 occ= 2
MO #4   (E1y #1 ) energy= -0.534389828410983 | -0.553676448533968 | -0.515103208287997 occ= 2
MO #5   (E1x #1 ) energy= -0.240711394628282 | -0.630825323671212 | 0.149402534414647  occ= 1
MO #6   (A1  #4 ) energy= 0.189483164371769  | 0.18446120398465   | 0.194505124758886  occ= 0
MO #7   (A1  #5 ) energy= 0.796108887731468  | 0.787163420869124  | 0.805054354593811  occ= 0
MO #8   (A1  #6 ) energy= 1.15209421238787   | 1.14312794713704   | 1.1610604776387    occ= 0
MO #9   (E1y #2 ) energy= 1.16529223201265   | 1.1567737729799    | 1.17381069104539   occ= 0
MO #10  (E1x #2 ) energy= 1.18141452903599   | 1.10226658732674   | 1.26056247074525   occ= 0
MO #11  (E1x #3 ) energy= 1.52837950294854   | 1.50980753147403   | 1.54695147442305   occ= 0
MO #12  (E1y #3 ) energy= 1.53361157384709   | 1.53126411272682   | 1.53595903496737   occ= 0
MO #13  (A1  #7 ) energy= 1.65529422070817   | 1.63439083200392   | 1.67619760941241   occ= 0
MO #14  (A1  #8 ) energy= 2.38886504705289   | 2.37776686745017   | 2.39996322665562   occ= 0
MO #15  (E2x #1 ) energy= 2.92575217478056   | 2.86882381905379   | 2.98268053050732   occ= 0
MO #16  (E2y #1 ) energy= 2.92575217478056   | 2.86882381905379   | 2.98268053050732   occ= 0
MO #17  (E1x #4 ) energy= 3.25045087322114   | 3.20337474973429   | 3.297526996708     occ= 0
MO #18  (E1y #4 ) energy= 3.26839278868233   | 3.26113193465929   | 3.27565364270538   occ= 0
MO #19  (A1  #9 ) energy= 3.9846273844393    | 3.96914676194431   | 4.0001080069343    occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        2.00000
pop of  0 O 2s        1.81624
pop of  0 O 3s        0.00366
pop of  0 O 2px       0.99796
pop of  0 O 2py       1.99594
pop of  0 O 2pz       1.49438
pop of  0 O 3px       0.00041
pop of  0 O 3py       0.00082
pop of  0 O 3pz       0.00176
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00086
pop of  0 O 3dz^2     0.00542
pop of  0 O 3dxz      0.00043
pop of  0 O 3dx2-y2    0.00000
pop of  1 H 1s        0.65700
pop of  1 H 2s        0.01905
pop of  1 H 2px       0.00120
pop of  1 H 2py       0.00239
pop of  1 H 2pz       0.00250
 ** Mulliken atomic charges  **
charge of  0O =     -0.31788
charge of  1H =      0.31788
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.76133

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_memory 4000 MB (current use 90 MB)
Init E(MP2) = -0.150682263376352
cycle = 1  E_corr(MP2) = -0.150682263376352  dE = 5.55111512e-17  norm(t2) = 2.62009e-16
E(UMP2) = -75.539698804899  E_corr = -0.150682263376352

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 91 MB)
Init t2, MP2 energy = -0.150682263376352
UCISD converged
E(UCISD) = -75.55266931084734  E_corr = -0.1636527693246226

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (18, 18)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 91 MB)
Init t2, MP2 energy = -0.150682263376352
Init E_corr(CCSD) = -0.154092460481966
cycle = 1  E_corr(CCSD) = -0.164732288797363  dE = -0.0106398283  norm(t1,t2) = 0.0293638
cycle = 2  E_corr(CCSD) = -0.167224886345061  dE = -0.00249259755  norm(t1,t2) = 0.0100463
cycle = 3  E_corr(CCSD) = -0.168384355063472  dE = -0.00115946872  norm(t1,t2) = 0.00465123
cycle = 4  E_corr(CCSD) = -0.168417407161564  dE = -3.30520981e-05  norm(t1,t2) = 0.00124708
cycle = 5  E_corr(CCSD) = -0.168387371722679  dE = 3.00354389e-05  norm(t1,t2) = 0.000598726
cycle = 6  E_corr(CCSD) = -0.168400832683339  dE = -1.34609607e-05  norm(t1,t2) = 0.000201463
cycle = 7  E_corr(CCSD) = -0.168399472224349  dE = 1.36045899e-06  norm(t1,t2) = 6.31226e-05
cycle = 8  E_corr(CCSD) = -0.168399599017149  dE = -1.267928e-07  norm(t1,t2) = 1.63129e-05
cycle = 9  E_corr(CCSD) = -0.168399711083191  dE = -1.12066042e-07  norm(t1,t2) = 3.31197e-06
cycle = 10  E_corr(CCSD) = -0.168399715871023  dE = -4.78783199e-09  norm(t1,t2) = 7.45763e-07
UCCSD converged
E(UCCSD) = -75.55741625739371  E_corr = -0.1683997158710228
UCCSD(T) correction = -0.00181310199799339
Active space CI wfn symmetry = E1x

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 13
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1x
Density matrix diagonal elements [1.99899022 1.99811525 1.9999117  1.         0.00298283]
CASCI converged
CASCI E = -75.3916077425109  E(CI) = -19.560568700121  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 13
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpbvalljml
max_memory 4000 MB (current use 91 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1x
CASCI E = -75.3916077425109  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.4012788728049  dE = -0.0096711303  S^2 = 0.7500000
               |grad[o]|=0.0459  |grad[c]|= 0.022031031693600527  |ddm|=0.0129
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4119617884541  dE = -0.010682916  S^2 = 0.7500000
               |grad[o]|=0.0442  |grad[c]|= 0.01240307457665924  |ddm|=0.0119
macro iter 3 (17 JK  4 micro), CASSCF E = -75.414624563623  dE = -0.0026627752  S^2 = 0.7500000
               |grad[o]|=0.0267  |grad[c]|= 0.004280495762231989  |ddm|=0.00508
macro iter 4 (6 JK  2 micro), CASSCF E = -75.4146249072438  dE = -3.4362084e-07  S^2 = 0.7500000
               |grad[o]|=0.000711  |grad[c]|= 7.918907212037277e-05  |ddm|=0.000421
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4146249093673  dE = -2.1234143e-09  S^2 = 0.7500000
               |grad[o]|=5.33e-05  |grad[c]|= 2.809842072443091e-05  |ddm|=3.09e-05
1-step CASSCF converged in 5 macro (68 JK 15 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99428563 1.98171059 1.99964072 1.         0.02436306]
CASSCF energy = -75.4146249093673
CASCI E = -75.4146249093673  E(CI) = -19.5835858669773  S^2 = 0.7500000
Hartree-Fock    -75.38901654152271
Moller-Plesset  -75.53969880489906
CISD            -75.55266931084734
CCSD            -75.55741625739373
CCSD(T)         -75.55922935939172
CASCI           -75.39160774251094
CASSCF          -75.41462490936726
#####################################################
END: cc-pvdz
#####################################################
#####################################################
START: cc-pvtz
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:49 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 16
num. orbitals of irrep E1x = 9
num. orbitals of irrep E1y = 9
num. orbitals of irrep E2x = 4
num. orbitals of irrep E2y = 4
num. orbitals of irrep E3x = 1
num. orbitals of irrep E3y = 1
number of shells = 15
number of NR pGTOs = 58
number of NR cGTOs = 44
basis = cc-pvtz
ecp = {}
CPU time:        25.81
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpeiy3i5hl
max_memory 4000 MB (current use 91 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpeiy3i5hl
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 91 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.432654589657937  LUMO (A1) = 0.114648171205188
Initial guess E= -75.4022007256536  |g|= 0.212797
macro= 0  E= -75.4120151143127  delta_E= -0.00981439  |g|= 0.212797  2 KF 5 JK
macro= 1  E= -75.4126139720568  delta_E= -0.000598858  |g|= 0.087992  2 KF 5 JK
macro= 2  E= -75.4110742008396  delta_E= 0.00153977  |g|= 0.0588007  2 KF 5 JK
macro= 3  E= -75.4117583427813  delta_E= -0.000684142  |g|= 0.103018  2 KF 5 JK
macro= 4  E= -75.4115004427914  delta_E= 0.0002579  |g|= 0.0710003  2 KF 5 JK
macro= 5  E= -75.4115477474061  delta_E= -4.73046e-05  |g|= 0.095241  2 KF 5 JK
macro= 6  E= -75.4116642604558  delta_E= -0.000116513  |g|= 0.0782409  2 KF 5 JK
macro= 7  E= -75.4114858907207  delta_E= 0.00017837  |g|= 0.0919404  2 KF 5 JK
macro= 8  E= -75.4117315933528  delta_E= -0.000245703  |g|= 0.0804701  2 KF 5 JK
macro= 9  E= -75.4114714626477  delta_E= 0.000260131  |g|= 0.0908713  2 KF 5 JK
macro= 10  E= -75.411763612661  delta_E= -0.00029215  |g|= 0.0809173  2 KF 5 JK
macro= 11  E= -75.4114606304291  delta_E= 0.000302982  |g|= 0.0905572  2 KF 5 JK
macro= 12  E= -75.41176931071  delta_E= -0.00030868  |g|= 0.0810935  2 KF 5 JK
macro= 13  E= -75.4114475753095  delta_E= 0.000321735  |g|= 0.0906508  2 KF 5 JK
macro= 14  E= -75.4117682419594  delta_E= -0.000320667  |g|= 0.0813053  2 KF 5 JK
macro= 15  E= -75.4114339298889  delta_E= 0.000334312  |g|= 0.0907816  2 KF 5 JK
macro= 16  E= -75.4117658048141  delta_E= -0.000331875  |g|= 0.0815471  2 KF 5 JK
macro= 17  E= -75.4114201034367  delta_E= 0.000345701  |g|= 0.0908946  2 KF 5 JK
macro= 18  E= -75.4117631202078  delta_E= -0.000343017  |g|= 0.0818053  2 KF 5 JK
macro= 19  E= -75.4114061629368  delta_E= 0.000356957  |g|= 0.0909952  2 KF 5 JK
macro= 20  E= -75.4117603895259  delta_E= -0.000354227  |g|= 0.0820717  2 KF 5 JK
macro= 21  E= -75.4113921364282  delta_E= 0.000368253  |g|= 0.0910903  2 KF 5 JK
macro= 22  E= -75.4117576207505  delta_E= -0.000365484  |g|= 0.0823414  2 KF 5 JK
macro= 23  E= -75.4113780385417  delta_E= 0.000379582  |g|= 0.0911838  2 KF 5 JK
macro= 24  E= -75.4117548068707  delta_E= -0.000376768  |g|= 0.0826122  2 KF 5 JK
macro= 25  E= -75.4113638769336  delta_E= 0.00039093  |g|= 0.0912775  2 KF 5 JK
macro= 26  E= -75.4117519479  delta_E= -0.000388071  |g|= 0.0828833  2 KF 5 JK
macro= 27  E= -75.4113496560467  delta_E= 0.000402292  |g|= 0.0913719  2 KF 5 JK
macro= 28  E= -75.4117490465253  delta_E= -0.00039939  |g|= 0.0831541  2 KF 5 JK
macro= 29  E= -75.4113353791169  delta_E= 0.000413667  |g|= 0.0914674  2 KF 5 JK
macro= 30  E= -75.4117461050431  delta_E= -0.000410726  |g|= 0.0834247  2 KF 5 JK
macro= 31  E= -75.4113210490149  delta_E= 0.000425056  |g|= 0.0915641  2 KF 5 JK
macro= 32  E= -75.4117431248403  delta_E= -0.000422076  |g|= 0.0836948  2 KF 5 JK
macro= 33  E= -75.4113066685402  delta_E= 0.000436456  |g|= 0.0916618  2 KF 5 JK
macro= 34  E= -75.4117401067007  delta_E= -0.000433438  |g|= 0.0839645  2 KF 5 JK
macro= 35  E= -75.4112922405138  delta_E= 0.000447866  |g|= 0.0917607  2 KF 5 JK
macro= 36  E= -75.4117370511194  delta_E= -0.000444811  |g|= 0.0842335  2 KF 5 JK
macro= 37  E= -75.4112777678109  delta_E= 0.000459283  |g|= 0.0918607  2 KF 5 JK
macro= 38  E= -75.4117339584848  delta_E= -0.000456191  |g|= 0.084502  2 KF 5 JK
macro= 39  E= -75.4112632533751  delta_E= 0.000470705  |g|= 0.091962  2 KF 5 JK
macro= 40  E= -75.4117308291583  delta_E= -0.000467576  |g|= 0.0847698  2 KF 5 JK
macro= 41  E= -75.4112487002263  delta_E= 0.000482129  |g|= 0.0920643  2 KF 5 JK
macro= 42  E= -75.4117276635122  delta_E= -0.000478963  |g|= 0.085037  2 KF 5 JK
macro= 43  E= -75.4112341114684  delta_E= 0.000493552  |g|= 0.0921679  2 KF 5 JK
macro= 44  E= -75.4117244619449  delta_E= -0.00049035  |g|= 0.0853034  2 KF 5 JK
macro= 45  E= -75.4112194902938  delta_E= 0.000504972  |g|= 0.0922726  2 KF 5 JK
macro= 46  E= -75.4117212248896  delta_E= -0.000501735  |g|= 0.0855689  2 KF 5 JK
macro= 47  E= -75.41120483999  delta_E= 0.000516385  |g|= 0.0923785  2 KF 5 JK
macro= 48  E= -75.4117179528203  delta_E= -0.000513113  |g|= 0.0858337  2 KF 5 JK
macro= 49  E= -75.4111901639448  delta_E= 0.000527789  |g|= 0.0924856  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4111901639448  |g|= 0.0924856  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4111901639448
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpeiy3i5hl
max_memory 4000 MB (current use 97 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpeiy3i5hl
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 97 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.268446742047305  LUMO (A1) = 0.144580564386426
Initial guess E= -75.4111901639448  |g|= 0.0860975
macro= 0  E= -75.4112372037607  delta_E= -4.70398e-05  |g|= 0.0860975  2 KF 5 JK
macro= 1  E= -75.4123655510652  delta_E= -0.00112835  |g|= 0.103405  2 KF 5 JK
macro= 2  E= -75.4109342661743  delta_E= 0.00143128  |g|= 0.0689245  2 KF 5 JK
macro= 3  E= -75.4122905006429  delta_E= -0.00135623  |g|= 0.110796  2 KF 5 JK
macro= 4  E= -75.4112562817431  delta_E= 0.00103422  |g|= 0.0651182  2 KF 5 JK
macro= 5  E= -75.4123265721946  delta_E= -0.00107029  |g|= 0.105646  2 KF 5 JK
macro= 6  E= -75.4109486859328  delta_E= 0.00137789  |g|= 0.0635062  2 KF 5 JK
macro= 7  E= -75.412331543884  delta_E= -0.00138286  |g|= 0.111682  2 KF 5 JK
macro= 8  E= -75.4110687146267  delta_E= 0.00126283  |g|= 0.0642714  2 KF 5 JK
macro= 9  E= -75.4123213893419  delta_E= -0.00125267  |g|= 0.109567  2 KF 5 JK
macro= 10  E= -75.411109628474  delta_E= 0.00121176  |g|= 0.0633409  2 KF 5 JK
macro= 11  E= -75.4123254474109  delta_E= -0.00121582  |g|= 0.109024  2 KF 5 JK
macro= 12  E= -75.4110589955639  delta_E= 0.00126645  |g|= 0.0630871  2 KF 5 JK
macro= 13  E= -75.4123271927928  delta_E= -0.0012682  |g|= 0.110029  2 KF 5 JK
macro= 14  E= -75.4110645978968  delta_E= 0.00126259  |g|= 0.0632005  2 KF 5 JK
macro= 15  E= -75.412326709597  delta_E= -0.00126211  |g|= 0.10991  2 KF 5 JK
macro= 16  E= -75.4110673147315  delta_E= 0.00125939  |g|= 0.0631292  2 KF 5 JK
macro= 17  E= -75.4123278350889  delta_E= -0.00126052  |g|= 0.109873  2 KF 5 JK
macro= 18  E= -75.4110586063987  delta_E= 0.00126923  |g|= 0.0630868  2 KF 5 JK
macro= 19  E= -75.412328837557  delta_E= -0.00127023  |g|= 0.110028  2 KF 5 JK
macro= 20  E= -75.4110553319085  delta_E= 0.00127351  |g|= 0.0630862  2 KF 5 JK
macro= 21  E= -75.4123295361789  delta_E= -0.0012742  |g|= 0.110075  2 KF 5 JK
macro= 22  E= -75.4110524390679  delta_E= 0.0012771  |g|= 0.0630664  2 KF 5 JK
macro= 23  E= -75.4123303909704  delta_E= -0.00127795  |g|= 0.110118  2 KF 5 JK
macro= 24  E= -75.4110481961139  delta_E= 0.00128219  |g|= 0.0630466  2 KF 5 JK
macro= 25  E= -75.4123312501641  delta_E= -0.00128305  |g|= 0.110185  2 KF 5 JK
macro= 26  E= -75.4110444250312  delta_E= 0.00128683  |g|= 0.0630316  2 KF 5 JK
macro= 27  E= -75.4123320699994  delta_E= -0.00128764  |g|= 0.110241  2 KF 5 JK
macro= 28  E= -75.4110407719796  delta_E= 0.0012913  |g|= 0.0630149  2 KF 5 JK
macro= 29  E= -75.4123329028356  delta_E= -0.00129213  |g|= 0.110296  2 KF 5 JK
macro= 30  E= -75.4110369696542  delta_E= 0.00129593  |g|= 0.0629978  2 KF 5 JK
macro= 31  E= -75.4123337370491  delta_E= -0.00129677  |g|= 0.110353  2 KF 5 JK
macro= 32  E= -75.4110332061593  delta_E= 0.00130053  |g|= 0.0629813  2 KF 5 JK
macro= 33  E= -75.4123345652553  delta_E= -0.00130136  |g|= 0.110409  2 KF 5 JK
macro= 34  E= -75.4110294663038  delta_E= 0.0013051  |g|= 0.0629646  2 KF 5 JK
macro= 35  E= -75.4123353931196  delta_E= -0.00130593  |g|= 0.110464  2 KF 5 JK
macro= 36  E= -75.4110257141911  delta_E= 0.00130968  |g|= 0.0629479  2 KF 5 JK
macro= 37  E= -75.4123362199779  delta_E= -0.00131051  |g|= 0.110519  2 KF 5 JK
macro= 38  E= -75.4110219685344  delta_E= 0.00131425  |g|= 0.0629311  2 KF 5 JK
macro= 39  E= -75.4123370447375  delta_E= -0.00131508  |g|= 0.110574  2 KF 5 JK
macro= 40  E= -75.4110182306762  delta_E= 0.00131881  |g|= 0.0629144  2 KF 5 JK
macro= 41  E= -75.4123378679592  delta_E= -0.00131964  |g|= 0.110628  2 KF 5 JK
macro= 42  E= -75.4110144964931  delta_E= 0.00132337  |g|= 0.0628976  2 KF 5 JK
macro= 43  E= -75.4123386896251  delta_E= -0.00132419  |g|= 0.110682  2 KF 5 JK
macro= 44  E= -75.4110107680554  delta_E= 0.00132792  |g|= 0.0628808  2 KF 5 JK
macro= 45  E= -75.4123395095674  delta_E= -0.00132874  |g|= 0.110736  2 KF 5 JK
macro= 46  E= -75.4110070461701  delta_E= 0.00133246  |g|= 0.0628639  2 KF 5 JK
macro= 47  E= -75.4123403278168  delta_E= -0.00133328  |g|= 0.110789  2 KF 5 JK
macro= 48  E= -75.4110033307094  delta_E= 0.001337  |g|= 0.0628471  2 KF 5 JK
macro= 49  E= -75.4123411443582  delta_E= -0.00133781  |g|= 0.110841  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4123411443582  |g|= 0.110841  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4123411443582
**** SCF Summaries ****
Total Energy =                         -75.412341144358166
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.557011280882449
Two-electron Energy =                   32.778971789241623
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y
double occ                     3    1    0    0    0    0    0
single occ                     0    0    1    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.648191757257   | -20.664256015815   | -20.6321274986989  occ= 2
MO #2   (A1  #2 ) energy= -1.31623359644958  | -1.38523696304917  | -1.24723022985     occ= 2
MO #3   (A1  #3 ) energy= -0.666197849580323 | -0.686755413795793 | -0.645640285364853 occ= 2
MO #4   (E1x #1 ) energy= -0.54790175551405  | -0.566777339395925 | -0.529026171632175 occ= 2
MO #5   (E1y #1 ) energy= -0.256628362018254 | -0.642017784797461 | 0.128761060760959  occ= 1
MO #6   (A1  #4 ) energy= 0.145520344453452  | 0.141610313992096  | 0.149430374914808  occ= 0
MO #7   (A1  #5 ) energy= 0.553505397298597  | 0.545967378136151  | 0.561043416461045  occ= 0
MO #8   (A1  #6 ) energy= 0.689430715928874  | 0.684569815727193  | 0.694291616130544  occ= 0
MO #9   (E1x #2 ) energy= 0.763477932747493  | 0.757358594727565  | 0.769597270767421  occ= 0
MO #10  (E1y #2 ) energy= 0.772762584818919  | 0.716852659635948  | 0.828672510001891  occ= 0
MO #11  (E1y #3 ) energy= 0.874516600834784  | 0.86080057279238   | 0.888232628877189  occ= 0
MO #12  (E1x #3 ) energy= 0.881625927555628  | 0.879763453192736  | 0.883488401918517  occ= 0
MO #13  (A1  #7 ) energy= 1.08889468018337   | 1.07264205999511   | 1.10514730037162   occ= 0
MO #14  (A1  #8 ) energy= 1.49714668921217   | 1.48857703835687   | 1.50571634006746   occ= 0
MO #15  (E2x #1 ) energy= 1.70710891091813   | 1.66694698790917   | 1.74727083392708   occ= 0
MO #16  (E2y #1 ) energy= 1.70710891091813   | 1.66694698790917   | 1.74727083392708   occ= 0
MO #17  (E1y #4 ) energy= 2.02374860614794   | 1.98924575730034   | 2.05825145499555   occ= 0
MO #18  (E1x #4 ) energy= 2.03826346207484   | 2.03301146480251   | 2.04351545934716   occ= 0
MO #19  (A1  #9 ) energy= 2.13588497093455   | 2.12606628076112   | 2.14570366110796   occ= 0
MO #20  (A1  #10) energy= 2.7769928507714    | 2.77038848521485   | 2.78359721632795   occ= 0
MO #21  (E2x #2 ) energy= 3.47911493667625   | 3.47389213184415   | 3.48433774150835   occ= 0
MO #22  (E2y #2 ) energy= 3.47911493667625   | 3.47389213184415   | 3.48433774150834   occ= 0
MO #23  (E1y #5 ) energy= 3.73566462377386   | 3.71115843142549   | 3.76017081612224   occ= 0
MO #24  (E1x #5 ) energy= 3.74378101451306   | 3.74055699181478   | 3.74700503721135   occ= 0
MO #25  (E1y #6 ) energy= 3.98297396616252   | 3.95384156818113   | 4.01210636414391   occ= 0
MO #26  (E1x #6 ) energy= 3.99155842126315   | 3.98757727358094   | 3.99553956894536   occ= 0
MO #27  (A1  #11) energy= 4.03884460490196   | 4.03561974845607   | 4.04206946134783   occ= 0
MO #28  (E1y #7 ) energy= 4.41447767018701   | 4.38486681724042   | 4.44408852313361   occ= 0
MO #29  (E1x #7 ) energy= 4.43741519348642   | 4.43212108020565   | 4.4427093067672    occ= 0
MO #30  (A1  #12) energy= 4.75174426456804   | 4.74170497358842   | 4.76178355554767   occ= 0
MO #31  (A1  #13) energy= 5.0675634152318    | 5.05465619293618   | 5.08047063752739   occ= 0
MO #32  (E3x #1 ) energy= 5.52852994763719   | 5.50080704366144   | 5.55625285161293   occ= 0
MO #33  (E3y #1 ) energy= 5.52852994763718   | 5.50080704366143   | 5.55625285161293   occ= 0
MO #34  (E2x #3 ) energy= 5.79259377929388   | 5.77370075959564   | 5.81148679899212   occ= 0
MO #35  (E2y #3 ) energy= 5.79259377929386   | 5.77370075959563   | 5.81148679899211   occ= 0
MO #36  (E2x #4 ) energy= 6.68522688790666   | 6.6428630055631    | 6.72759077025022   occ= 0
MO #37  (E2y #4 ) energy= 6.68522688790666   | 6.6428630055631    | 6.72759077025021   occ= 0
MO #38  (E1y #8 ) energy= 6.80408739819253   | 6.76495424349415   | 6.84322055289091   occ= 0
MO #39  (E1x #8 ) energy= 6.83354283221985   | 6.82692182507162   | 6.84016383936808   occ= 0
MO #40  (A1  #14) energy= 6.85455727872691   | 6.84433425181515   | 6.86478030563866   occ= 0
MO #41  (E1y #9 ) energy= 7.0232246687924    | 7.00326955758013   | 7.04317978000468   occ= 0
MO #42  (E1x #9 ) energy= 7.05788154827148   | 7.05366740336666   | 7.0620956931763    occ= 0
MO #43  (A1  #15) energy= 7.49566056585574   | 7.48379805984183   | 7.50752307186964   occ= 0
MO #44  (A1  #16) energy= 10.8082437393606   | 10.7949741155712   | 10.8215133631502   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.81621
pop of  0 O 3s        0.00390
pop of  0 O 4s        0.00033
pop of  0 O 2px       1.99411
pop of  0 O 2py       0.99696
pop of  0 O 2pz       1.51499
pop of  0 O 3px       0.00085
pop of  0 O 3py       0.00042
pop of  0 O 3pz       0.00115
pop of  0 O 4px       0.00039
pop of  0 O 4py       0.00022
pop of  0 O 4pz       0.00053
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00068
pop of  0 O 3dz^2     0.00706
pop of  0 O 3dxz      0.00139
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00004
pop of  0 O 4dz^2     0.00034
pop of  0 O 4dxz      0.00008
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00007
pop of  0 O 4f 0      0.00041
pop of  0 O 4f 1      0.00009
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  1 H 1s        0.63457
pop of  1 H 2s        0.01311
pop of  1 H 3s        0.00610
pop of  1 H 2px       0.00299
pop of  1 H 2py       0.00152
pop of  1 H 2pz       0.00054
pop of  1 H 3px       0.00006
pop of  1 H 3py       0.00004
pop of  1 H 3pz       0.00066
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00004
pop of  1 H 3dz^2     0.00011
pop of  1 H 3dxz      0.00005
pop of  1 H 3dx2-y2    0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34022
charge of  1H =      0.34022
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.76209

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (43, 43)
frozen orbitals 1
max_memory 4000 MB (current use 97 MB)
Init E(MP2) = -0.201818755901341
cycle = 1  E_corr(MP2) = -0.201818755901341  dE = -1.11022302e-16  norm(t2) = 2.32901e-15
E(UMP2) = -75.6141599002595  E_corr = -0.201818755901341

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (43, 43)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 122 MB)
Init t2, MP2 energy = -0.201818755901342
UCISD converged
E(UCISD) = -75.62564623802005  E_corr = -0.213305093661891

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (43, 43)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 127 MB)
Init t2, MP2 energy = -0.201818755901341
Init E_corr(CCSD) = -0.206672684912471
cycle = 1  E_corr(CCSD) = -0.215766416819937  dE = -0.00909373191  norm(t1,t2) = 0.0327022
cycle = 2  E_corr(CCSD) = -0.21897814434228  dE = -0.00321172752  norm(t1,t2) = 0.0104992
cycle = 3  E_corr(CCSD) = -0.219974069124851  dE = -0.000995924783  norm(t1,t2) = 0.00484086
cycle = 4  E_corr(CCSD) = -0.220154290723805  dE = -0.000180221599  norm(t1,t2) = 0.00153518
cycle = 5  E_corr(CCSD) = -0.220111127941521  dE = 4.31627823e-05  norm(t1,t2) = 0.000676582
cycle = 6  E_corr(CCSD) = -0.220116790265714  dE = -5.66232419e-06  norm(t1,t2) = 0.000184837
cycle = 7  E_corr(CCSD) = -0.220121878181638  dE = -5.08791592e-06  norm(t1,t2) = 6.67641e-05
cycle = 8  E_corr(CCSD) = -0.220120487821104  dE = 1.39036053e-06  norm(t1,t2) = 2.56356e-05
cycle = 9  E_corr(CCSD) = -0.220120539945352  dE = -5.21242484e-08  norm(t1,t2) = 8.03777e-06
cycle = 10  E_corr(CCSD) = -0.220120466141334  dE = 7.38040183e-08  norm(t1,t2) = 1.89052e-06
cycle = 11  E_corr(CCSD) = -0.220120449320525  dE = 1.68208086e-08  norm(t1,t2) = 5.14139e-07
UCCSD converged
E(UCCSD) = -75.63246159367873  E_corr = -0.2201204493205254
UCCSD(T) correction = -0.00519002189116118
Active space CI wfn symmetry = E1y

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 38
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1y
Density matrix diagonal elements [1.99944239e+00 1.99912920e+00 1.99994719e+00 1.00000000e+00
 1.48121230e-03]
CASCI converged
CASCI E = -75.4137278772934  E(CI) = -19.5822908611209  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 38
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpeiy3i5hl
max_memory 4000 MB (current use 124 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1y
CASCI E = -75.4137278772934  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.424735632612  dE = -0.011007755  S^2 = 0.7500000
               |grad[o]|=0.0618  |grad[c]|= 0.02722964444647351  |ddm|=0.012
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4364969055571  dE = -0.011761273  S^2 = 0.7500000
               |grad[o]|=0.0538  |grad[c]|= 0.013647517840449918  |ddm|=0.012
macro iter 3 (15 JK  4 micro), CASSCF E = -75.4386164294492  dE = -0.0021195239  S^2 = 0.7500000
               |grad[o]|=0.0306  |grad[c]|= 0.0029470223573168403  |ddm|=0.00971
macro iter 4 (6 JK  2 micro), CASSCF E = -75.4386168825227  dE = -4.5307355e-07  S^2 = 0.7500000
               |grad[o]|=0.000929  |grad[c]|= 0.00012062216769418571  |ddm|=0.000575
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4386168878382  dE = -5.3154849e-09  S^2 = 0.7500000
               |grad[o]|=7.97e-05  |grad[c]|= 4.847314353037621e-05  |ddm|=4.41e-05
1-step CASSCF converged in 5 macro (66 JK 15 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99426291 1.98185716 1.99966798 1.         0.02421195]
CASSCF energy = -75.4386168878382
CASCI E = -75.4386168878382  E(CI) = -19.6071798716657  S^2 = 0.7500000
Hartree-Fock    -75.41234114435817
Moller-Plesset  -75.61415990025951
CISD            -75.62564623802005
CCSD            -75.6324615936787
CCSD(T)         -75.63765161556987
CASCI           -75.41372787729344
CASSCF          -75.43861688783821
#####################################################
END: cc-pvtz
#####################################################
#####################################################
START: cc-pvqz
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:46:54 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 25
num. orbitals of irrep E1x = 16
num. orbitals of irrep E1y = 16
num. orbitals of irrep E2x = 9
num. orbitals of irrep E2y = 9
num. orbitals of irrep E3x = 4
num. orbitals of irrep E3y = 4
num. orbitals of irrep E4x = 1
num. orbitals of irrep E4y = 1
number of shells = 24
number of NR pGTOs = 100
number of NR cGTOs = 85
basis = cc-pvqz
ecp = {}
CPU time:        59.17
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpewire1g5
max_memory 4000 MB (current use 124 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpewire1g5
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 124 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.433611953912709  LUMO (A1) = 0.096601064794371
Initial guess E= -75.4083682895148  |g|= 0.216422
macro= 0  E= -75.4183343168298  delta_E= -0.00996603  |g|= 0.216422  2 KF 5 JK
macro= 1  E= -75.4187871217359  delta_E= -0.000452805  |g|= 0.0922866  2 KF 5 JK
macro= 2  E= -75.4172787086654  delta_E= 0.00150841  |g|= 0.0630833  2 KF 5 JK
macro= 3  E= -75.4186133421355  delta_E= -0.00133463  |g|= 0.110185  2 KF 5 JK
macro= 4  E= -75.4172224168921  delta_E= 0.00139093  |g|= 0.0605143  2 KF 5 JK
macro= 5  E= -75.4186442298924  delta_E= -0.00142181  |g|= 0.110837  2 KF 5 JK
macro= 6  E= -75.4174908874465  delta_E= 0.00115334  |g|= 0.0631825  2 KF 5 JK
macro= 7  E= -75.4186626467338  delta_E= -0.00117176  |g|= 0.106604  2 KF 5 JK
macro= 8  E= -75.417363246631  delta_E= 0.0012994  |g|= 0.0619777  2 KF 5 JK
macro= 9  E= -75.4186617645024  delta_E= -0.00129852  |g|= 0.10897  2 KF 5 JK
macro= 10  E= -75.4174066867808  delta_E= 0.00125508  |g|= 0.0623818  2 KF 5 JK
macro= 11  E= -75.4186663970032  delta_E= -0.00125971  |g|= 0.108257  2 KF 5 JK
macro= 12  E= -75.4173689017852  delta_E= 0.0012975  |g|= 0.0621131  2 KF 5 JK
macro= 13  E= -75.4186688004503  delta_E= -0.0012999  |g|= 0.108943  2 KF 5 JK
macro= 14  E= -75.4173656048964  delta_E= 0.0013032  |g|= 0.0621632  2 KF 5 JK
macro= 15  E= -75.4186720543551  delta_E= -0.00130645  |g|= 0.109018  2 KF 5 JK
macro= 16  E= -75.4173475128135  delta_E= 0.00132454  |g|= 0.0620672  2 KF 5 JK
macro= 17  E= -75.4186750012713  delta_E= -0.00132749  |g|= 0.109342  2 KF 5 JK
macro= 18  E= -75.4173356324147  delta_E= 0.00133937  |g|= 0.0620319  2 KF 5 JK
macro= 19  E= -75.4186780834956  delta_E= -0.00134245  |g|= 0.109555  2 KF 5 JK
macro= 20  E= -75.4173212086494  delta_E= 0.00135687  |g|= 0.061968  2 KF 5 JK
macro= 21  E= -75.4186811364408  delta_E= -0.00135993  |g|= 0.109809  2 KF 5 JK
macro= 22  E= -75.4173078687805  delta_E= 0.00137327  |g|= 0.0619138  2 KF 5 JK
macro= 23  E= -75.4186842171661  delta_E= -0.00137635  |g|= 0.110042  2 KF 5 JK
macro= 24  E= -75.4172941477577  delta_E= 0.00139007  |g|= 0.0618533  2 KF 5 JK
macro= 25  E= -75.4186873050969  delta_E= -0.00139316  |g|= 0.110278  2 KF 5 JK
macro= 26  E= -75.417280644705  delta_E= 0.00140666  |g|= 0.0617931  2 KF 5 JK
macro= 27  E= -75.4186904049868  delta_E= -0.00140976  |g|= 0.110509  2 KF 5 JK
macro= 28  E= -75.4172671335499  delta_E= 0.00142327  |g|= 0.0617306  2 KF 5 JK
macro= 29  E= -75.4186935141767  delta_E= -0.00142638  |g|= 0.110737  2 KF 5 JK
macro= 30  E= -75.4172537124835  delta_E= 0.0014398  |g|= 0.0616667  2 KF 5 JK
macro= 31  E= -75.418696631658  delta_E= -0.00144292  |g|= 0.110962  2 KF 5 JK
macro= 32  E= -75.4172403539748  delta_E= 0.00145628  |g|= 0.0616011  2 KF 5 JK
macro= 33  E= -75.4186997562809  delta_E= -0.0014594  |g|= 0.111183  2 KF 5 JK
macro= 34  E= -75.4172270778073  delta_E= 0.00147268  |g|= 0.061534  2 KF 5 JK
macro= 35  E= -75.4187028866727  delta_E= -0.00147581  |g|= 0.111401  2 KF 5 JK
macro= 36  E= -75.4172138858143  delta_E= 0.001489  |g|= 0.0614653  2 KF 5 JK
macro= 37  E= -75.4187060216054  delta_E= -0.00149214  |g|= 0.111615  2 KF 5 JK
macro= 38  E= -75.4172007859413  delta_E= 0.00150524  |g|= 0.0613951  2 KF 5 JK
macro= 39  E= -75.4187091597228  delta_E= -0.00150837  |g|= 0.111826  2 KF 5 JK
macro= 40  E= -75.4171877835867  delta_E= 0.00152138  |g|= 0.0613234  2 KF 5 JK
macro= 41  E= -75.4187122997006  delta_E= -0.00152452  |g|= 0.112033  2 KF 5 JK
macro= 42  E= -75.4171748846188  delta_E= 0.00153742  |g|= 0.0612502  2 KF 5 JK
macro= 43  E= -75.4187154401713  delta_E= -0.00154056  |g|= 0.112237  2 KF 5 JK
macro= 44  E= -75.4171620943555  delta_E= 0.00155335  |g|= 0.0611756  2 KF 5 JK
macro= 45  E= -75.418718579763  delta_E= -0.00155649  |g|= 0.112437  2 KF 5 JK
macro= 46  E= -75.4171494178919  delta_E= 0.00156916  |g|= 0.0610996  2 KF 5 JK
macro= 47  E= -75.4187217170883  delta_E= -0.0015723  |g|= 0.112633  2 KF 5 JK
macro= 48  E= -75.4171368600005  delta_E= 0.00158486  |g|= 0.0610223  2 KF 5 JK
macro= 49  E= -75.4187248507544  delta_E= -0.00158799  |g|= 0.112826  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4187248507544  |g|= 0.112826  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4187248507544
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpewire1g5
max_memory 4000 MB (current use 200 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpewire1g5
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 200 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.262038091910818  LUMO (A1) = 0.119825305237236
Initial guess E= -75.4187248507543  |g|= 0.0609436
macro= 0  E= -75.4172913562288  delta_E= 0.00143349  |g|= 0.0609436  2 KF 5 JK
macro= 1  E= -75.4185955308204  delta_E= -0.00130417  |g|= 0.105309  2 KF 5 JK
macro= 2  E= -75.4176760899068  delta_E= 0.000919441  |g|= 0.067427  2 KF 5 JK
macro= 3  E= -75.4186377364628  delta_E= -0.000961647  |g|= 0.103286  2 KF 5 JK
macro= 4  E= -75.4175742994635  delta_E= 0.00106344  |g|= 0.0642632  2 KF 5 JK
macro= 5  E= -75.4186368236809  delta_E= -0.00106252  |g|= 0.106696  2 KF 5 JK
macro= 6  E= -75.4176504806622  delta_E= 0.000986343  |g|= 0.06398  2 KF 5 JK
macro= 7  E= -75.4186397214281  delta_E= -0.000989241  |g|= 0.105296  2 KF 5 JK
macro= 8  E= -75.4176051193566  delta_E= 0.0010346  |g|= 0.0634473  2 KF 5 JK
macro= 9  E= -75.4186425312157  delta_E= -0.00103741  |g|= 0.106318  2 KF 5 JK
macro= 10  E= -75.4176053402356  delta_E= 0.00103719  |g|= 0.0634995  2 KF 5 JK
macro= 11  E= -75.4186448278116  delta_E= -0.00103949  |g|= 0.106331  2 KF 5 JK
macro= 12  E= -75.4175904236812  delta_E= 0.0010544  |g|= 0.0634057  2 KF 5 JK
macro= 13  E= -75.418647503287  delta_E= -0.00105708  |g|= 0.106645  2 KF 5 JK
macro= 14  E= -75.4175791625773  delta_E= 0.00106834  |g|= 0.0633845  2 KF 5 JK
macro= 15  E= -75.4186500479877  delta_E= -0.00107089  |g|= 0.106876  2 KF 5 JK
macro= 16  E= -75.417567172957  delta_E= 0.00108288  |g|= 0.0633487  2 KF 5 JK
macro= 17  E= -75.4186526615026  delta_E= -0.00108549  |g|= 0.107118  2 KF 5 JK
macro= 18  E= -75.4175550058948  delta_E= 0.00109766  |g|= 0.0633159  2 KF 5 JK
macro= 19  E= -75.4186552759786  delta_E= -0.00110027  |g|= 0.10736  2 KF 5 JK
macro= 20  E= -75.4175428339185  delta_E= 0.00111244  |g|= 0.0632822  2 KF 5 JK
macro= 21  E= -75.4186579073773  delta_E= -0.00111507  |g|= 0.107598  2 KF 5 JK
macro= 22  E= -75.4175305071191  delta_E= 0.0011274  |g|= 0.0632468  2 KF 5 JK
macro= 23  E= -75.4186605526407  delta_E= -0.00113005  |g|= 0.107837  2 KF 5 JK
macro= 24  E= -75.4175181111292  delta_E= 0.00114244  |g|= 0.0632103  2 KF 5 JK
macro= 25  E= -75.4186632107177  delta_E= -0.0011451  |g|= 0.108074  2 KF 5 JK
macro= 26  E= -75.4175056281805  delta_E= 0.00115758  |g|= 0.0631722  2 KF 5 JK
macro= 27  E= -75.4186658816688  delta_E= -0.00116025  |g|= 0.10831  2 KF 5 JK
macro= 28  E= -75.4174930755509  delta_E= 0.00117281  |g|= 0.0631327  2 KF 5 JK
macro= 29  E= -75.4186685646123  delta_E= -0.00117549  |g|= 0.108544  2 KF 5 JK
macro= 30  E= -75.4174804614643  delta_E= 0.0011881  |g|= 0.0630918  2 KF 5 JK
macro= 31  E= -75.4186712590754  delta_E= -0.0011908  |g|= 0.108776  2 KF 5 JK
macro= 32  E= -75.417467795463  delta_E= 0.00120346  |g|= 0.0630493  2 KF 5 JK
macro= 33  E= -75.4186739644002  delta_E= -0.00120617  |g|= 0.109007  2 KF 5 JK
macro= 34  E= -75.4174550872443  delta_E= 0.00121888  |g|= 0.0630054  2 KF 5 JK
macro= 35  E= -75.4186766799431  delta_E= -0.00122159  |g|= 0.109235  2 KF 5 JK
macro= 36  E= -75.4174423461139  delta_E= 0.00123433  |g|= 0.0629599  2 KF 5 JK
macro= 37  E= -75.4186794050237  delta_E= -0.00123706  |g|= 0.109461  2 KF 5 JK
macro= 38  E= -75.4174295814039  delta_E= 0.00124982  |g|= 0.0629129  2 KF 5 JK
macro= 39  E= -75.4186821389317  delta_E= -0.00125256  |g|= 0.109685  2 KF 5 JK
macro= 40  E= -75.4174168022563  delta_E= 0.00126534  |g|= 0.0628644  2 KF 5 JK
macro= 41  E= -75.4186848809284  delta_E= -0.00126808  |g|= 0.109907  2 KF 5 JK
macro= 42  E= -75.4174040176638  delta_E= 0.00128086  |g|= 0.0628144  2 KF 5 JK
macro= 43  E= -75.4186876302475  delta_E= -0.00128361  |g|= 0.110126  2 KF 5 JK
macro= 44  E= -75.4173912364409  delta_E= 0.00129639  |g|= 0.0627629  2 KF 5 JK
macro= 45  E= -75.4186903860929  delta_E= -0.00129915  |g|= 0.110343  2 KF 5 JK
macro= 46  E= -75.4173784672058  delta_E= 0.00131192  |g|= 0.0627099  2 KF 5 JK
macro= 47  E= -75.4186931476442  delta_E= -0.00131468  |g|= 0.110557  2 KF 5 JK
macro= 48  E= -75.4173657183647  delta_E= 0.00132743  |g|= 0.0626554  2 KF 5 JK
macro= 49  E= -75.4186959140528  delta_E= -0.0013302  |g|= 0.110768  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4186959140528  |g|= 0.110768  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4186959140528
**** SCF Summaries ****
Total Energy =                         -75.418695914052833
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.537202258820400
Two-electron Energy =                   32.752807997484908
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    1    0    0    0    0    0    0    0
single occ                     0    0    1    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6522284224645  | -20.6684249846932  | -20.6360318602358  occ= 2
MO #2   (A1  #2 ) energy= -1.31935587083228  | -1.38812588087025  | -1.25058586079431  occ= 2
MO #3   (A1  #3 ) energy= -0.670015601848805 | -0.690396119940178 | -0.649635083757432 occ= 2
MO #4   (E1x #1 ) energy= -0.551420987209179 | -0.570227584344636 | -0.532614390073722 occ= 2
MO #5   (E1y #1 ) energy= -0.26099864285386  | -0.645544499141208 | 0.123547213433482  occ= 1
MO #6   (A1  #4 ) energy= 0.119706489018857  | 0.116523475377586  | 0.122889502660133  occ= 0
MO #7   (A1  #5 ) energy= 0.45933742999717   | 0.453789396053339  | 0.464885463941004  occ= 0
MO #8   (A1  #6 ) energy= 0.487990185960489  | 0.484123139558787  | 0.491857232362225  occ= 0
MO #9   (E1x #2 ) energy= 0.567780898652785  | 0.563331264875548  | 0.572230532430023  occ= 0
MO #10  (E1y #2 ) energy= 0.574335931808659  | 0.532392129314233  | 0.616279734303084  occ= 0
MO #11  (E1y #3 ) energy= 0.662075040287534  | 0.652506119640621  | 0.671643960934447  occ= 0
MO #12  (E1x #3 ) energy= 0.668782592322772  | 0.667485738373304  | 0.670079446272237  occ= 0
MO #13  (A1  #7 ) energy= 0.784607253938844  | 0.772133367616806  | 0.797081140260923  occ= 0
MO #14  (A1  #8 ) energy= 1.10822294567766   | 1.10270014687616   | 1.1137457444792    occ= 0
MO #15  (E2x #1 ) energy= 1.21558682468354   | 1.1880064817028    | 1.24316716766429   occ= 0
MO #16  (E2y #1 ) energy= 1.21558682468355   | 1.1880064817028    | 1.24316716766429   occ= 0
MO #17  (A1  #9 ) energy= 1.36521072007281   | 1.35884821987965   | 1.37157322026591   occ= 0
MO #18  (E1y #4 ) energy= 1.46907857606766   | 1.44545357332773   | 1.49270357880761   occ= 0
MO #19  (E1x #4 ) energy= 1.48166300045871   | 1.47808265163374   | 1.48524334928367   occ= 0
MO #20  (A1  #10) energy= 1.80249524530744   | 1.79628037059554   | 1.80871012001937   occ= 0
MO #21  (E2x #2 ) energy= 2.20302898838471   | 2.1983797061358    | 2.20767827063362   occ= 0
MO #22  (E2y #2 ) energy= 2.20302898838472   | 2.19837970613581   | 2.20767827063363   occ= 0
MO #23  (E1y #5 ) energy= 2.34911457301389   | 2.3392763748297    | 2.35895277119807   occ= 0
MO #24  (E1x #5 ) energy= 2.35721036455825   | 2.35581733753313   | 2.35860339158338   occ= 0
MO #25  (E1y #6 ) energy= 2.57275386601846   | 2.52784255900518   | 2.61766517303173   occ= 0
MO #26  (E1x #6 ) energy= 2.58106210886358   | 2.57505563285588   | 2.58706858487127   occ= 0
MO #27  (A1  #11) energy= 2.60133525449237   | 2.59798741150913   | 2.60468309747557   occ= 0
MO #28  (E1y #7 ) energy= 2.88519799416947   | 2.86178930778712   | 2.90860668055184   occ= 0
MO #29  (E1x #7 ) energy= 2.90592693713224   | 2.90172070385556   | 2.91013317040893   occ= 0
MO #30  (A1  #12) energy= 3.15327169449967   | 3.1424625065558    | 3.16408088244359   occ= 0
MO #31  (A1  #13) energy= 3.3194172294163    | 3.31092633720732   | 3.32790812162516   occ= 0
MO #32  (E3x #1 ) energy= 3.39662889907651   | 3.37754326099334   | 3.41571453715969   occ= 0
MO #33  (E3y #1 ) energy= 3.39662889907652   | 3.37754326099334   | 3.41571453715969   occ= 0
MO #34  (E2x #3 ) energy= 3.74056378889757   | 3.72657677859653   | 3.75455079919861   occ= 0
MO #35  (E2y #3 ) energy= 3.74056378889757   | 3.72657677859653   | 3.75455079919861   occ= 0
MO #36  (A1  #14) energy= 3.78085935438771   | 3.76656243870251   | 3.79515627007291   occ= 0
MO #37  (E2x #4 ) energy= 4.08849482432371   | 4.04965480666115   | 4.12733484198627   occ= 0
MO #38  (E2y #4 ) energy= 4.08849482432372   | 4.04965480666115   | 4.12733484198628   occ= 0
MO #39  (E1y #8 ) energy= 4.09570584454529   | 4.0667186229008    | 4.12469306618981   occ= 0
MO #40  (E1x #8 ) energy= 4.12182626997947   | 4.11692038617029   | 4.12673215378866   occ= 0
MO #41  (A1  #15) energy= 4.50535692538746   | 4.49739838063498   | 4.51331547013997   occ= 0
MO #42  (E1y #9 ) energy= 4.77016647642823   | 4.75077367231637   | 4.78955928054009   occ= 0
MO #43  (E1x #9 ) energy= 4.79613133174451   | 4.79230236953857   | 4.79996029395047   occ= 0
MO #44  (A1  #16) energy= 5.23712170558187   | 5.22691637187835   | 5.24732703928532   occ= 0
MO #45  (E3x #2 ) energy= 6.06464529151763   | 6.06225098483271   | 6.06703959820255   occ= 0
MO #46  (E3y #2 ) energy= 6.06464529151762   | 6.06225098483271   | 6.06703959820254   occ= 0
MO #47  (E2x #5 ) energy= 6.79231001730429   | 6.7875597178939    | 6.79706031671467   occ= 0
MO #48  (E2y #5 ) energy= 6.79231001730431   | 6.78755971789392   | 6.79706031671469   occ= 0
MO #49  (E1y #10) energy= 7.3366860666641    | 7.33166377312442   | 7.34170836020377   occ= 0
MO #50  (E1x #10) energy= 7.34803773589979   | 7.347089465768     | 7.34898600603157   occ= 0
MO #51  (A1  #17) energy= 7.39498501067499   | 7.39116212705253   | 7.39880789429746   occ= 0
MO #52  (E1y #11) energy= 8.00959833551723   | 8.00551853059704   | 8.01367814043745   occ= 0
MO #53  (E1x #11) energy= 8.02310090429448   | 8.02213243415873   | 8.02406937443022   occ= 0
MO #54  (E2x #6 ) energy= 8.0916951156533    | 8.09054240017128   | 8.09284783113532   occ= 0
MO #55  (E2y #6 ) energy= 8.09169511565332   | 8.0905424001713    | 8.09284783113533   occ= 0
MO #56  (A1  #18) energy= 8.15950030466219   | 8.15523312871439   | 8.16376748060999   occ= 0
MO #57  (E1y #12) energy= 8.76459827151107   | 8.75578635704495   | 8.77341018597721   occ= 0
MO #58  (E1x #12) energy= 8.78179015828342   | 8.77999321620885   | 8.78358710035799   occ= 0
MO #59  (A1  #19) energy= 8.82867393732347   | 8.82444671142587   | 8.83290116322105   occ= 0
MO #60  (E4x #1 ) energy= 9.30007285990486   | 9.2826812492018    | 9.31746447060792   occ= 0
MO #61  (E4y #1 ) energy= 9.30007285990483   | 9.28268124920177   | 9.31746447060789   occ= 0
MO #62  (E3x #3 ) energy= 9.47047496671433   | 9.45717727082712   | 9.48377266260153   occ= 0
MO #63  (E3y #3 ) energy= 9.47047496671435   | 9.45717727082713   | 9.48377266260154   occ= 0
MO #64  (A1  #20) energy= 9.82778307569026   | 9.82277608121414   | 9.83279007016636   occ= 0
MO #65  (E1y #13) energy= 10.3820521651398   | 10.3400342808094   | 10.4240700494703   occ= 0
MO #66  (E1x #13) energy= 10.4196713350481   | 10.4123073036337   | 10.4270353664626   occ= 0
MO #67  (E2x #7 ) energy= 10.54478393989     | 10.5350105976309   | 10.554557282149    occ= 0
MO #68  (E2y #7 ) energy= 10.54478393989     | 10.5350105976309   | 10.554557282149    occ= 0
MO #69  (A1  #21) energy= 11.2064836075388   | 11.1978373922097   | 11.2151298228679   occ= 0
MO #70  (E1y #14) energy= 11.2332171038556   | 11.2161234476253   | 11.2503107600859   occ= 0
MO #71  (E1x #14) energy= 11.2729980898288   | 11.2695148467125   | 11.2764813329451   occ= 0
MO #72  (E3x #4 ) energy= 11.4423982315192   | 11.4166314815009   | 11.4681649815374   occ= 0
MO #73  (E3y #4 ) energy= 11.4423982315192   | 11.4166314815009   | 11.4681649815374   occ= 0
MO #74  (E2x #8 ) energy= 11.6031657402021   | 11.5853202514863   | 11.6210112289178   occ= 0
MO #75  (E2y #8 ) energy= 11.6031657402021   | 11.5853202514864   | 11.6210112289178   occ= 0
MO #76  (A1  #22) energy= 11.6273423139629   | 11.6173463182787   | 11.637338309647    occ= 0
MO #77  (E1y #15) energy= 12.2119370544304   | 12.1903375475318   | 12.233536561329    occ= 0
MO #78  (E1x #15) energy= 12.2525497640907   | 12.2478975162727   | 12.2572020119087   occ= 0
MO #79  (E2x #9 ) energy= 12.5285356422978   | 12.4986639030675   | 12.5584073815281   occ= 0
MO #80  (E2y #9 ) energy= 12.5285356422978   | 12.4986639030675   | 12.5584073815281   occ= 0
MO #81  (A1  #23) energy= 13.9754239613426   | 13.9691449406529   | 13.9817029820323   occ= 0
MO #82  (E1y #16) energy= 14.2929208902495   | 14.2732603696617   | 14.3125814108374   occ= 0
MO #83  (E1x #16) energy= 14.3290419811231   | 14.3250169656878   | 14.3330669965585   occ= 0
MO #84  (A1  #24) energy= 16.4475804349012   | 16.4419976728199   | 16.4531631969825   occ= 0
MO #85  (A1  #25) energy= 42.2624444547846   | 42.2529576195395   | 42.2719312900312   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.81540
pop of  0 O 3s        0.00380
pop of  0 O 4s        0.00069
pop of  0 O 5s        0.00006
pop of  0 O 2px       1.99338
pop of  0 O 2py       0.99687
pop of  0 O 2pz       1.51747
pop of  0 O 3px       0.00083
pop of  0 O 3py       0.00043
pop of  0 O 3pz       0.00109
pop of  0 O 4px       0.00053
pop of  0 O 4py       0.00026
pop of  0 O 4pz       0.00115
pop of  0 O 5px       0.00002
pop of  0 O 5py       0.00001
pop of  0 O 5pz       0.00019
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00081
pop of  0 O 3dz^2     0.00768
pop of  0 O 3dxz      0.00170
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00010
pop of  0 O 4dz^2     0.00056
pop of  0 O 4dxz      0.00023
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00000
pop of  0 O 5dz^2     0.00004
pop of  0 O 5dxz      0.00000
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00008
pop of  0 O 4f 0      0.00079
pop of  0 O 4f 1      0.00018
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00001
pop of  0 O 5f 0      0.00007
pop of  0 O 5f 1      0.00001
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00001
pop of  0 O 5g 0      0.00009
pop of  0 O 5g 1      0.00001
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  1 H 1s        0.63064
pop of  1 H 2s        0.01329
pop of  1 H 3s        0.00561
pop of  1 H 4s        0.00006
pop of  1 H 2px       0.00301
pop of  1 H 2py       0.00137
pop of  1 H 2pz       0.00049
pop of  1 H 3px       0.00002
pop of  1 H 3py       0.00001
pop of  1 H 3pz       0.00048
pop of  1 H 4px       0.00002
pop of  1 H 4py       0.00001
pop of  1 H 4pz       0.00018
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00003
pop of  1 H 3dz^2     0.00013
pop of  1 H 3dxz      0.00004
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00001
pop of  1 H 4dz^2     0.00001
pop of  1 H 4dxz      0.00001
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00000
pop of  1 H 4f 0      0.00004
pop of  1 H 4f 1      0.00000
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34455
charge of  1H =      0.34455
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.75231

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (84, 84)
frozen orbitals 1
max_memory 4000 MB (current use 200 MB)
Init E(MP2) = -0.219958670442825
cycle = 1  E_corr(MP2) = -0.219958670442825  dE = 1.94289029e-16  norm(t2) = 2.11232e-14
E(UMP2) = -75.6386545844956  E_corr = -0.219958670442825

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (84, 84)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 532 MB)
Init t2, MP2 energy = -0.219958670442822
UCISD converged
E(UCISD) = -75.647798019055  E_corr = -0.2291021050021755

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (84, 84)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 298 MB)
Init t2, MP2 energy = -0.219958670442822
Init E_corr(CCSD) = -0.224928651724391
cycle = 1  E_corr(CCSD) = -0.232006226880549  dE = -0.00707757516  norm(t1,t2) = 0.0347463
cycle = 2  E_corr(CCSD) = -0.235457433238926  dE = -0.00345120636  norm(t1,t2) = 0.0110832
cycle = 3  E_corr(CCSD) = -0.236309144242745  dE = -0.000851711004  norm(t1,t2) = 0.00522747
cycle = 4  E_corr(CCSD) = -0.236611647502531  dE = -0.00030250326  norm(t1,t2) = 0.00189349
cycle = 5  E_corr(CCSD) = -0.236573245392466  dE = 3.84021101e-05  norm(t1,t2) = 0.00073679
cycle = 6  E_corr(CCSD) = -0.236569504208593  dE = 3.74118387e-06  norm(t1,t2) = 0.000201419
cycle = 7  E_corr(CCSD) = -0.236578450171743  dE = -8.94596315e-06  norm(t1,t2) = 7.76817e-05
cycle = 8  E_corr(CCSD) = -0.236577968832939  dE = 4.81338804e-07  norm(t1,t2) = 2.69521e-05
cycle = 9  E_corr(CCSD) = -0.236577441108729  dE = 5.2772421e-07  norm(t1,t2) = 1.12372e-05
cycle = 10  E_corr(CCSD) = -0.236577351049171  dE = 9.00595585e-08  norm(t1,t2) = 3.04075e-06
cycle = 11  E_corr(CCSD) = -0.23657731858616  dE = 3.24630109e-08  norm(t1,t2) = 9.91807e-07
UCCSD converged
E(UCCSD) = -75.65527323263898  E_corr = -0.2365773185861599
UCCSD(T) correction = -0.00628122198583694
Active space CI wfn symmetry = E1y

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 79
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1y
Density matrix diagonal elements [1.99964001e+00 1.99951293e+00 1.99996514e+00 1.00000000e+00
 8.81917567e-04]
CASCI converged
CASCI E = -75.4195540407464  E(CI) = -19.5869195408488  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 79
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpewire1g5
max_memory 4000 MB (current use 287 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1y
CASCI E = -75.4195540407464  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.4341698928196  dE = -0.014615852  S^2 = 0.7500000
               |grad[o]|=0.0608  |grad[c]|= 0.03651923068753545  |ddm|=0.0153
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4449317118171  dE = -0.010761819  S^2 = 0.7500000
               |grad[o]|=0.0505  |grad[c]|= 0.011851714342579653  |ddm|=0.0112
macro iter 3 (9 JK  4 micro), CASSCF E = -75.4450815963621  dE = -0.00014988454  S^2 = 0.7500000
               |grad[o]|=0.0138  |grad[c]|= 0.0013522896180590315  |ddm|=0.00692
macro iter 4 (3 JK  1 micro), CASSCF E = -75.445081721366  dE = -1.2500392e-07  S^2 = 0.7500000
               |grad[o]|=0.000396  |grad[c]|= 0.0002391561909048136  |ddm|=0.000166
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4450817376597  dE = -1.6293754e-08  S^2 = 0.7500000
               |grad[o]|=0.000115  |grad[c]|= 9.218370008341539e-05  |ddm|=6.55e-05
1-step CASSCF converged in 5 macro (57 JK 14 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99419351 1.98191696 1.99967712 1.         0.02421241]
CASSCF energy = -75.4450817376597
CASCI E = -75.4450817376597  E(CI) = -19.6124472377621  S^2 = 0.7500000
Hartree-Fock    -75.41869591405283
Moller-Plesset  -75.63865458449565
CISD            -75.647798019055
CCSD            -75.65527323263899
CCSD(T)         -75.66155445462482
CASCI           -75.41955404074638
CASSCF          -75.44508173765973
#####################################################
END: cc-pvqz
#####################################################
#####################################################
START: aug-cc-pvdz
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:47:53 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 14
num. orbitals of irrep E1x = 7
num. orbitals of irrep E1y = 7
num. orbitals of irrep E2x = 2
num. orbitals of irrep E2y = 2
number of shells = 13
number of NR pGTOs = 46
number of NR cGTOs = 32
basis = aug-cc-pvdz
ecp = {}
CPU time:       448.86
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpp_qz2vts
max_memory 4000 MB (current use 287 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpp_qz2vts
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 287 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.430550357826207  LUMO (A1) = 0.0319646230464298
Initial guess E= -75.3874760433985  |g|= 0.199106
macro= 0  E= -75.3968995316247  delta_E= -0.00942349  |g|= 0.199106  2 KF 5 JK
macro= 1  E= -75.3977189895179  delta_E= -0.000819458  |g|= 0.0895259  2 KF 5 JK
macro= 2  E= -75.3961522507547  delta_E= 0.00156674  |g|= 0.0523535  2 KF 5 JK
macro= 3  E= -75.3977653299157  delta_E= -0.00161308  |g|= 0.0998225  2 KF 5 JK
macro= 4  E= -75.3962548920688  delta_E= 0.00151044  |g|= 0.051183  2 KF 5 JK
macro= 5  E= -75.3977763892161  delta_E= -0.0015215  |g|= 0.0981358  2 KF 5 JK
macro= 6  E= -75.3961755827217  delta_E= 0.00160081  |g|= 0.0508835  2 KF 5 JK
macro= 7  E= -75.3977760769605  delta_E= -0.00160049  |g|= 0.0991488  2 KF 5 JK
macro= 8  E= -75.3961669329374  delta_E= 0.00160914  |g|= 0.0509432  2 KF 5 JK
macro= 9  E= -75.3977821662456  delta_E= -0.00161523  |g|= 0.0993564  2 KF 5 JK
macro= 10  E= -75.3961546662743  delta_E= 0.0016275  |g|= 0.0508326  2 KF 5 JK
macro= 11  E= -75.3977867310567  delta_E= -0.00163206  |g|= 0.0995766  2 KF 5 JK
macro= 12  E= -75.396136647297  delta_E= 0.00165008  |g|= 0.0506876  2 KF 5 JK
macro= 13  E= -75.3977907640153  delta_E= -0.00165412  |g|= 0.0998624  2 KF 5 JK
macro= 14  E= -75.3961210992971  delta_E= 0.00166966  |g|= 0.0505544  2 KF 5 JK
macro= 15  E= -75.3977949980776  delta_E= -0.0016739  |g|= 0.100119  2 KF 5 JK
macro= 16  E= -75.3961059889351  delta_E= 0.00168901  |g|= 0.0504147  2 KF 5 JK
macro= 17  E= -75.3977991557459  delta_E= -0.00169317  |g|= 0.100366  2 KF 5 JK
macro= 18  E= -75.3960909999368  delta_E= 0.00170816  |g|= 0.0502734  2 KF 5 JK
macro= 19  E= -75.3978032334579  delta_E= -0.00171223  |g|= 0.100607  2 KF 5 JK
macro= 20  E= -75.3960764077084  delta_E= 0.00172683  |g|= 0.050133  2 KF 5 JK
macro= 21  E= -75.3978072572947  delta_E= -0.00173085  |g|= 0.100841  2 KF 5 JK
macro= 22  E= -75.3960621650765  delta_E= 0.00174509  |g|= 0.049993  2 KF 5 JK
macro= 23  E= -75.3957184137615  delta_E= 0.000343751  |g|= 0.101068  2 KF 5 JK
macro= 24  E= -75.397104227028  delta_E= -0.00138581  |g|= 0.0929527  2 KF 5 JK
macro= 25  E= -75.397887982683  delta_E= -0.000783756  |g|= 0.0854833  2 KF 5 JK
macro= 26  E= -75.396004948038  delta_E= 0.00188303  |g|= 0.0479593  2 KF 5 JK
macro= 27  E= -75.3955471757478  delta_E= 0.000457772  |g|= 0.101876  2 KF 5 JK
macro= 28  E= -75.3970186617648  delta_E= -0.00147149  |g|= 0.0949496  2 KF 5 JK
macro= 29  E= -75.3956228858111  delta_E= 0.00139578  |g|= 0.0875541  2 KF 5 JK
macro= 30  E= -75.3970416810237  delta_E= -0.0014188  |g|= 0.0946563  2 KF 5 JK
macro= 31  E= -75.3956225778638  delta_E= 0.0014191  |g|= 0.0871849  2 KF 5 JK
macro= 32  E= -75.3970371492153  delta_E= -0.00141457  |g|= 0.0946582  2 KF 5 JK
macro= 33  E= -75.39560451991  delta_E= 0.00143263  |g|= 0.0873029  2 KF 5 JK
macro= 34  E= -75.397031243027  delta_E= -0.00142672  |g|= 0.0949361  2 KF 5 JK
macro= 35  E= -75.3955846923357  delta_E= 0.00144655  |g|= 0.0874679  2 KF 5 JK
macro= 36  E= -75.3970246924476  delta_E= -0.00144  |g|= 0.0952357  2 KF 5 JK
macro= 37  E= -75.395564835179  delta_E= 0.00145986  |g|= 0.0876603  2 KF 5 JK
macro= 38  E= -75.3970178197103  delta_E= -0.00145298  |g|= 0.0955295  2 KF 5 JK
macro= 39  E= -75.3955451318263  delta_E= 0.00147269  |g|= 0.0878643  2 KF 5 JK
macro= 40  E= -75.397010804395  delta_E= -0.00146567  |g|= 0.0958169  2 KF 5 JK
macro= 41  E= -75.395525624878  delta_E= 0.00148518  |g|= 0.0880725  2 KF 5 JK
macro= 42  E= -75.3970037414497  delta_E= -0.00147812  |g|= 0.096099  2 KF 5 JK
macro= 43  E= -75.3955063390586  delta_E= 0.0014974  |g|= 0.0882814  2 KF 5 JK
macro= 44  E= -75.3969966718148  delta_E= -0.00149033  |g|= 0.0963758  2 KF 5 JK
macro= 45  E= -75.3954872853032  delta_E= 0.00150939  |g|= 0.0884896  2 KF 5 JK
macro= 46  E= -75.3969896134101  delta_E= -0.00150233  |g|= 0.0966475  2 KF 5 JK
macro= 47  E= -75.395468468609  delta_E= 0.00152114  |g|= 0.0886965  2 KF 5 JK
macro= 48  E= -75.3969825745728  delta_E= -0.00151411  |g|= 0.0969143  2 KF 5 JK
macro= 49  E= -75.3954498913442  delta_E= 0.00153268  |g|= 0.088902  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3954498913442  |g|= 0.088902  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3954498913442
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpp_qz2vts
max_memory 4000 MB (current use 287 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpp_qz2vts
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 287 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.283885541694726  LUMO (A1) = 0.0358576068024831
Initial guess E= -75.3954498913442  |g|= 0.0971761
macro= 0  E= -75.3947529408941  delta_E= 0.00069695  |g|= 0.0971761  2 KF 5 JK
macro= 1  E= -75.3971582507814  delta_E= -0.00240531  |g|= 0.11757  2 KF 5 JK
macro= 2  E= -75.3940718644039  delta_E= 0.00308639  |g|= 0.0541764  2 KF 5 JK
macro= 3  E= -75.3968091770946  delta_E= -0.00273731  |g|= 0.123264  2 KF 5 JK
macro= 4  E= -75.3956255546603  delta_E= 0.00118362  |g|= 0.069087  2 KF 5 JK
macro= 5  E= -75.3969893819665  delta_E= -0.00136383  |g|= 0.105916  2 KF 5 JK
macro= 6  E= -75.3947399049071  delta_E= 0.00224948  |g|= 0.0581725  2 KF 5 JK
macro= 7  E= -75.396970500817  delta_E= -0.0022306  |g|= 0.114603  2 KF 5 JK
macro= 8  E= -75.3951519674034  delta_E= 0.00181853  |g|= 0.057897  2 KF 5 JK
macro= 9  E= -75.3969821423265  delta_E= -0.00183017  |g|= 0.1072  2 KF 5 JK
macro= 10  E= -75.3950245585374  delta_E= 0.00195758  |g|= 0.0566434  2 KF 5 JK
macro= 11  E= -75.3969814794039  delta_E= -0.00195692  |g|= 0.108432  2 KF 5 JK
macro= 12  E= -75.3950558476297  delta_E= 0.00192563  |g|= 0.0565226  2 KF 5 JK
macro= 13  E= -75.3969818676162  delta_E= -0.00192602  |g|= 0.107762  2 KF 5 JK
macro= 14  E= -75.3950448612819  delta_E= 0.00193701  |g|= 0.0564285  2 KF 5 JK
macro= 15  E= -75.3969820559436  delta_E= -0.00193719  |g|= 0.107844  2 KF 5 JK
macro= 16  E= -75.3950433928482  delta_E= 0.00193866  |g|= 0.0563898  2 KF 5 JK
macro= 17  E= -75.3969821821693  delta_E= -0.00193879  |g|= 0.107833  2 KF 5 JK
macro= 18  E= -75.395040230845  delta_E= 0.00194195  |g|= 0.0563587  2 KF 5 JK
macro= 19  E= -75.3969822990569  delta_E= -0.00194207  |g|= 0.107865  2 KF 5 JK
macro= 20  E= -75.3950374188327  delta_E= 0.00194488  |g|= 0.0563325  2 KF 5 JK
macro= 21  E= -75.3969823914618  delta_E= -0.00194497  |g|= 0.107898  2 KF 5 JK
macro= 22  E= -75.395034620183  delta_E= 0.00194777  |g|= 0.056309  2 KF 5 JK
macro= 23  E= -75.3969824680968  delta_E= -0.00194785  |g|= 0.107935  2 KF 5 JK
macro= 24  E= -75.3950318732853  delta_E= 0.00195059  |g|= 0.0562875  2 KF 5 JK
macro= 25  E= -75.39698252903  delta_E= -0.00195066  |g|= 0.107972  2 KF 5 JK
macro= 26  E= -75.3950291865149  delta_E= 0.00195334  |g|= 0.0562677  2 KF 5 JK
macro= 27  E= -75.3969825758571  delta_E= -0.00195339  |g|= 0.108008  2 KF 5 JK
macro= 28  E= -75.395026565498  delta_E= 0.00195601  |g|= 0.0562493  2 KF 5 JK
macro= 29  E= -75.3969826098799  delta_E= -0.00195604  |g|= 0.108044  2 KF 5 JK
macro= 30  E= -75.3950240168354  delta_E= 0.00195859  |g|= 0.0562322  2 KF 5 JK
macro= 31  E= -75.396982632283  delta_E= -0.00195862  |g|= 0.108078  2 KF 5 JK
macro= 32  E= -75.3950215454805  delta_E= 0.00196109  |g|= 0.0562163  2 KF 5 JK
macro= 33  E= -75.3969826441657  delta_E= -0.0019611  |g|= 0.108111  2 KF 5 JK
macro= 34  E= -75.3950191551074  delta_E= 0.00196349  |g|= 0.0562015  2 KF 5 JK
macro= 35  E= -75.3969826465224  delta_E= -0.00196349  |g|= 0.108142  2 KF 5 JK
macro= 36  E= -75.3950168482283  delta_E= 0.0019658  |g|= 0.0561877  2 KF 5 JK
macro= 37  E= -75.396982640252  delta_E= -0.00196579  |g|= 0.108173  2 KF 5 JK
macro= 38  E= -75.3950146263118  delta_E= 0.00196801  |g|= 0.0561749  2 KF 5 JK
macro= 39  E= -75.3969826261638  delta_E= -0.001968  |g|= 0.108202  2 KF 5 JK
macro= 40  E= -75.3950124899427  delta_E= 0.00197014  |g|= 0.056163  2 KF 5 JK
macro= 41  E= -75.396982604987  delta_E= -0.00197012  |g|= 0.10823  2 KF 5 JK
macro= 42  E= -75.3950104389651  delta_E= 0.00197217  |g|= 0.0561519  2 KF 5 JK
macro= 43  E= -75.3969825773765  delta_E= -0.00197214  |g|= 0.108256  2 KF 5 JK
macro= 44  E= -75.3950084726105  delta_E= 0.0019741  |g|= 0.0561416  2 KF 5 JK
macro= 45  E= -75.3969825439221  delta_E= -0.00197407  |g|= 0.108281  2 KF 5 JK
macro= 46  E= -75.3950065896125  delta_E= 0.00197595  |g|= 0.0561321  2 KF 5 JK
macro= 47  E= -75.3969825051543  delta_E= -0.00197592  |g|= 0.108305  2 KF 5 JK
macro= 48  E= -75.3950047883035  delta_E= 0.00197772  |g|= 0.0561232  2 KF 5 JK
macro= 49  E= -75.3969824615517  delta_E= -0.00197767  |g|= 0.108328  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3969824615517  |g|= 0.108328  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3969824615517
**** SCF Summaries ****
Total Energy =                         -75.396982461551744
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.462663191807707
Two-electron Energy =                   32.699982382973310
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y
double occ                     3    1    0    0    0
single occ                     0    0    1    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6644251814613  | -20.6797475531908  | -20.6491028097318  occ= 2
MO #2   (A1  #2 ) energy= -1.32398972577295  | -1.3921646015405   | -1.2558148500054   occ= 2
MO #3   (A1  #3 ) energy= -0.673710314079086 | -0.693939931338767 | -0.653480696819405 occ= 2
MO #4   (E1x #1 ) energy= -0.549768549551679 | -0.568365466590723 | -0.531171632512635 occ= 2
MO #5   (E1y #1 ) energy= -0.261421340104851 | -0.638910884131051 | 0.116068203921357  occ= 1
MO #6   (A1  #4 ) energy= 0.0362059067067537 | 0.0353699844938041 | 0.0370418289197031 occ= 0
MO #7   (A1  #5 ) energy= 0.178782212813112  | 0.177578772521976  | 0.179985653104245  occ= 0
MO #8   (E1y #2 ) energy= 0.198248403791667  | 0.186965788639714  | 0.20953101894362   occ= 0
MO #9   (E1x #2 ) energy= 0.198393625591185  | 0.197224042765724  | 0.199563208416647  occ= 0
MO #10  (A1  #6 ) energy= 0.227813753952803  | 0.22408049215157   | 0.231547015754035  occ= 0
MO #11  (A1  #7 ) energy= 0.317850585024744  | 0.314292089151137  | 0.321409080898349  occ= 0
MO #12  (E1y #3 ) energy= 0.392736327967298  | 0.385036921599051  | 0.400435734335543  occ= 0
MO #13  (E1x #3 ) energy= 0.395852776358704  | 0.394956106729893  | 0.396749445987516  occ= 0
MO #14  (A1  #8 ) energy= 0.630792930813107  | 0.62479629137273   | 0.636789570253449  occ= 0
MO #15  (A1  #9 ) energy= 0.844360450093427  | 0.836047424259431  | 0.852673475927416  occ= 0
MO #16  (E2x #1 ) energy= 0.972674713405815  | 0.950746865544888  | 0.994602561266742  occ= 0
MO #17  (E2y #1 ) energy= 0.972674713405816  | 0.950746865544889  | 0.994602561266743  occ= 0
MO #18  (E1y #4 ) energy= 1.10611918519996   | 1.08228131771582   | 1.12995705268409   occ= 0
MO #19  (E1x #4 ) energy= 1.11460185157306   | 1.1112813462891    | 1.11792235685702   occ= 0
MO #20  (A1  #10) energy= 1.31735304155461   | 1.31141489485796   | 1.32329118825127   occ= 0
MO #21  (E1x #5 ) energy= 1.38908179372092   | 1.38126840529036   | 1.39689518215147   occ= 0
MO #22  (E1y #5 ) energy= 1.39924905891777   | 1.32994934748264   | 1.46854877035289   occ= 0
MO #23  (A1  #11) energy= 1.66796358080484   | 1.65624352820418   | 1.6796836334055    occ= 0
MO #24  (E1y #6 ) energy= 2.01575502670105   | 2.0087968328736    | 2.0227132205285    occ= 0
MO #25  (E1x #6 ) energy= 2.02751277938908   | 2.02620473678276   | 2.02882082199539   occ= 0
MO #26  (A1  #12) energy= 2.50273491664133   | 2.49000744792503   | 2.51546238535764   occ= 0
MO #27  (A1  #13) energy= 2.76278582181151   | 2.75403474182911   | 2.77153690179388   occ= 0
MO #28  (E2x #2 ) energy= 3.52337235267559   | 3.47953550363237   | 3.56720920171882   occ= 0
MO #29  (E2y #2 ) energy= 3.5233723526756    | 3.47953550363237   | 3.56720920171883   occ= 0
MO #30  (E1y #7 ) energy= 3.63008196959161   | 3.5880829998348    | 3.67208093934842   occ= 0
MO #31  (E1x #7 ) energy= 3.65094262227183   | 3.64433834972177   | 3.65754689482188   occ= 0
MO #32  (A1  #14) energy= 4.10375672738402   | 4.0888459836614    | 4.11866747110663   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        2.00000
pop of  0 O 2s        1.81899
pop of  0 O 3s        0.00548
pop of  0 O 4s        0.00147
pop of  0 O 2px       1.99183
pop of  0 O 2py       0.99524
pop of  0 O 2pz       1.51890
pop of  0 O 3px       0.00123
pop of  0 O 3py       0.00098
pop of  0 O 3pz       0.00316
pop of  0 O 4px       0.00127
pop of  0 O 4py       0.00117
pop of  0 O 4pz       0.00069
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00077
pop of  0 O 3dz^2     0.00639
pop of  0 O 3dxz      0.00204
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00014
pop of  0 O 4dz^2     0.00011
pop of  0 O 4dxz      0.00033
pop of  0 O 4dx2-y2    0.00000
pop of  1 H 1s        0.61994
pop of  1 H 2s        0.01626
pop of  1 H 3s        0.00594
pop of  1 H 2px       0.00327
pop of  1 H 2py       0.00169
pop of  1 H 2pz       0.00162
pop of  1 H 3px       0.00004
pop of  1 H 3py       0.00001
pop of  1 H 3pz       0.00106
 ** Mulliken atomic charges  **
charge of  0O =     -0.35016
charge of  1H =      0.35016
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.75852

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (31, 31)
frozen orbitals 1
max_memory 4000 MB (current use 287 MB)
Init E(MP2) = -0.16423516159194
cycle = 1  E_corr(MP2) = -0.16423516159194  dE = 1.11022302e-16  norm(t2) = 2.7556e-15
E(UMP2) = -75.5612176231437  E_corr = -0.16423516159194

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (31, 31)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 258 MB)
Init t2, MP2 energy = -0.164235161591941
UCISD converged
E(UCISD) = -75.57440457212093  E_corr = -0.1774221105691761

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (31, 31)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 204 MB)
Init t2, MP2 energy = -0.164235161591941
Init E_corr(CCSD) = -0.168572417857574
cycle = 1  E_corr(CCSD) = -0.178426402482974  dE = -0.00985398463  norm(t1,t2) = 0.0462821
cycle = 2  E_corr(CCSD) = -0.181884661577817  dE = -0.00345825909  norm(t1,t2) = 0.0141743
cycle = 3  E_corr(CCSD) = -0.18291079197581  dE = -0.0010261304  norm(t1,t2) = 0.00779756
cycle = 4  E_corr(CCSD) = -0.183470378325355  dE = -0.00055958635  norm(t1,t2) = 0.00301768
cycle = 5  E_corr(CCSD) = -0.183399678041404  dE = 7.0700284e-05  norm(t1,t2) = 0.0011053
cycle = 6  E_corr(CCSD) = -0.183413490227445  dE = -1.3812186e-05  norm(t1,t2) = 0.000324451
cycle = 7  E_corr(CCSD) = -0.183423676482538  dE = -1.01862551e-05  norm(t1,t2) = 0.000137423
cycle = 8  E_corr(CCSD) = -0.183423769352683  dE = -9.28701449e-08  norm(t1,t2) = 4.32203e-05
cycle = 9  E_corr(CCSD) = -0.183422962680172  dE = 8.06672511e-07  norm(t1,t2) = 1.64939e-05
cycle = 10  E_corr(CCSD) = -0.183422840285842  dE = 1.2239433e-07  norm(t1,t2) = 4.62306e-06
cycle = 11  E_corr(CCSD) = -0.183422804999847  dE = 3.52859951e-08  norm(t1,t2) = 1.9916e-06
cycle = 12  E_corr(CCSD) = -0.183422796381618  dE = 8.61822916e-09  norm(t1,t2) = 9.04641e-07
UCCSD converged
E(UCCSD) = -75.58040525793339  E_corr = -0.183422796381618
UCCSD(T) correction = -0.0035399447515285
Active space CI wfn symmetry = E1y

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 26
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1y
Density matrix diagonal elements [1.99995996e+00 1.99997926e+00 1.99999764e+00 1.00000000e+00
 6.31468761e-05]
CASCI converged
CASCI E = -75.3970509515706  E(CI) = -19.5659740062288  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 26
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmpp_qz2vts
max_memory 4000 MB (current use 213 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1y
CASCI E = -75.3970509515706  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.4050861666086  dE = -0.008035215  S^2 = 0.7500000
               |grad[o]|=0.0557  |grad[c]|= 0.02981037457689536  |ddm|=0.00587
macro iter 2 (21 JK  4 micro), CASSCF E = -75.4224434325751  dE = -0.017357266  S^2 = 0.7500000
               |grad[o]|=0.0347  |grad[c]|= 0.027849811331001926  |ddm|= 0.02
macro iter 3 (12 JK  4 micro), CASSCF E = -75.4236997968295  dE = -0.0012563643  S^2 = 0.7500000
               |grad[o]|=0.0233  |grad[c]|= 0.0016904967236479693  |ddm|=0.0138
macro iter 4 (3 JK  1 micro), CASSCF E = -75.4236999437768  dE = -1.4694733e-07  S^2 = 0.7500000
               |grad[o]|=0.000325  |grad[c]|= 0.00023925096673295865  |ddm|=0.000162
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4236999577532  dE = -1.3976347e-08  S^2 = 0.7500000
               |grad[o]|=0.000102  |grad[c]|= 8.334111024558496e-05  |ddm|=5.77e-05
1-step CASSCF converged in 5 macro (60 JK 14 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99436361 1.98171807 1.99966226 1.         0.02425607]
CASSCF energy = -75.4236999577532
CASCI E = -75.4236999577532  E(CI) = -19.5926230124113  S^2 = 0.7500000
Hartree-Fock    -75.39698246155174
Moller-Plesset  -75.56121762314369
CISD            -75.57440457212093
CCSD            -75.58040525793336
CCSD(T)         -75.58394520268489
CASCI           -75.39705095157065
CASSCF          -75.42369995775316
#####################################################
END: aug-cc-pvdz
#####################################################
#####################################################
START: aug-cc-pvtz
#####################################################
#INFO: **** input file is /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/radical.py ****
import numpy     as np
from pyscf       import gto,scf,lo,tools  # librerie di PySCF
from pyscf.tools import cubegen           # gto: Gaussian Type Orbital
                                          # scf: Self-Consistent Field
from pyscf       import mp,ci,cc,mcscf

R_rad = 0.9697
R_an  = 0.9640
R     = R_rad
geo   = []
geo.append(['O',(0,0,0)]) # geometria: lista di elementi della forma [A,(x,y,z)] xyz in Angstrom
geo.append(['H',(0,0,R)])

res = {}
res['basis'] = ['sto-6g','6-31g','6-31++g','6-31g**','6-31++g**','cc-pvdz','cc-pvtz','cc-pvqz','aug-cc-pvdz','aug-cc-pvtz']
res['E_HF_radical'] = []
res['E_MP_radical'] = []
res['E_CISD_radical'] = []
res['E_CCSD_radical'] = []
res['E_CCSD(T)_radical'] = []
res['E_CASCI_radical'] = []
res['E_CASSCF_radical'] = []

for i in res['basis']:
    
    print("#"*53)
    print("START:", i)
    print("#"*53)

    mol = gto.M(atom     = geo,
                basis    = i ,        # Slater Type Orbital - 6g = 6 Gaussiane per orbitale
                charge   = 0,         # carica totale (nucleare + elettronica)
                spin     = 1,         # STRANO MA VERO: N(up)-N(down)
                verbose  = 4,         # quanto e cosa stampare
                symmetry = True)      # simmetrie molecolari (rotazione attorno all'asse OH)

    mf  = scf.ROHF(mol)
    mf  = scf.newton(mf)         # solutore al secondo ordine E(C+dC) = E(C) + dC*g(C) + dC H(C) dC
    E   = mf.kernel()            # kernel = esegui ROHF
    a   = mf.stability()[0]      # calcolo g(C) ed H(C), proposta di nuovi orbitali possibilmente migliori (a)
    EHF = mf.kernel(a,mf.mo_occ) # kernel = esegui ROHF partendo dagli orbitali a
    mf.analyze()

    #
    # categoria 1: espansioni intorno all'Hartree-Fock
    #

    # ----- Moller-Plesset second order perturbation theory
    #
    # O----H               O[1s,2s,2px,2py,2pz] H[1s] # se la base e' cc-pCVnZ allora si possono studiare gli elettroni nell'1s
    nf     = 1                                        # altrimenti, l'orbitale 1s va congelato (rimane doppiamente occupato)
    mymp   = mp.MP2(mf,frozen=nf)                     # H = F + (H-F); F ha autofunzioni note, (H-F) e' perturbazione
    EMP    = EHF + mymp.kernel()[0]                   # Rayleigh-Schrodinger perturbation theory E = E(HF) - \sum_m |<m|H-F|0>|^2/(Em-E0)
    mcisd  = ci.CISD(mf,frozen=nf)                    # CISD: CI = configuration interaction; S = singole eccitazioni sull'Hartree-Fock
    ECISD  = EHF   + mcisd.kernel()[0]                # D = doppie eccitazioni sull'Hartree-Fock
    # CISD: H | Psi(HF) >      = T |Psi(HF) > + \sum_{ai} V(ai) c*(a)c(i) |Psi(HF)> + \sum_{abij} W(abij) c*(a)c*(b)c(j)c(i) |Psi(HF)>
    # CCSD: exp(T) | Psi(HF) >
    # Cluster operator: T = \sum_{ai} t(ai) c*(a)c(i) + \sum_{abij} t(abij) c*(a)c*(b)c(j)c(i) + ...
    mc     = cc.CCSD(mf,frozen=nf)
    ECCSD  = EHF   + mc.kernel()[0]
    ECCSDT = ECCSD + mc.ccsd_t()
    # CCSD(T): si calcola il CCSD e poi si stima il contributo all'energia di correlazione dalle triple eccitazioni perturbativamente
    # CCSD(T) + cc-pVTZ e' chiamato il "gold standard"

    # 
    # categoria 2: diagonalizzazione piu' o meno esatta
    #

    # CAS = complete active space
    # CI  = configuration interaction
    # SCF = self-consistent field
    # CASCI: si sceglie un insieme di orbitali e di elettroni, si costruiscono tutti i possibili determinanti di Slater 
    # che coinvolgono eccitazioni di questi orbitali ed elettroni
    # e si risolve l'eq di Schrodinger in questo sottospazio
    # 150 -------- INATTIVI
    # ............ INATTIVI
    #  7  -------- INATTIVI
    #  6  -------- ATTIVI
    #  5  ---ud--- ATTIVI
    #  4  ---ud--- INATTIVI
    #  3  ---ud--- INATTIVI
    #  2  ---ud--- INATTIVI
    #  1  ---ud--- CONGELATI (FROZEN)

    #  6  ---- --d- --u- -ud- complete active space
    #  5  -ud- -u-- -d-- ----

    nel_frozen  = (nf,nf)  # congelare  l'1s
    orb_frozen  = nf       # coongelare l'1s
    na,nb       = (mol.nelectron+mol.spin)//2-nf,(mol.nelectron-mol.spin)//2-nf # tutti elettroni attivi tranne 1s
    nao_minimal = 6                                                             # prendere 6 orbitali di Hartree-Fock
    nact        = nao_minimal-nf                                                # tutti questi 6 orbitali attivi tranne l'1s
    mc          = mcscf.CASCI(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASCI      = mc.kernel()[0]

    # CASSCF: come il CASCI, ma gli orbitali non sono orbitali di campo medio, sono orbitali ottimizzati variazionalmente

    mc          = mcscf.CASSCF(mf,nact,(na,nb))
    mc.frozen   = orb_frozen
    ECASSCF     = mc.kernel()[0]

    print("Hartree-Fock   ",EHF)
    print("Moller-Plesset ",EMP)
    print("CISD           ",ECISD)
    print("CCSD           ",ECCSD)
    print("CCSD(T)        ",ECCSDT)
    print("CASCI          ",ECASCI)
    print("CASSCF         ",ECASSCF)
    
    res['E_HF_radical'].append(EHF)
    res['E_MP_radical'].append(EMP)
    res['E_CISD_radical'].append(ECISD)
    res['E_CCSD_radical'].append(ECCSD)
    res['E_CCSD(T)_radical'].append(ECCSDT)
    res['E_CASCI_radical'].append(ECASCI)
    res['E_CASSCF_radical'].append(ECASSCF)
    
    print("#"*53)
    print("END:", i)
    print("#"*53)
    
    
try :
    data = np.load('../oh_data.npy',allow_pickle=True).item()
    for i in res:
        data[i] = res[i]
    np.save('../oh_data',data,allow_pickle=True)
except:
    np.save('../oh_data',res,allow_pickle=True)

# Sistema S1, Sistema S2
# E(S1,metodo) = E(S1,esatta) + BIAS(S1,metodo)
# E(S2,metodo) = E(S2,esatta) + BIAS(S2,metodo)
# E(S1,metodo)-E(S2,metodo) = E(S1,esatta)-E(S2,esatta) + BIAS(S1,metodo)-BIAS(S2,metodo)
# quando   BIAS(S1,metodo),BIAS(S2,metodo) "grande"  (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# tuttavia BIAS(S1,metodo)-BIAS(S2,metodo) "piccola" (rispetto E(S1,esatta)-E(S2,esatta) o a certe soglie come la chemical accuracy)
# allora "cancellation of errors"

#---------------------------------------------------------------------#
# metodo  | size-extensive E(A+B)=E(A)+E(B) | variational | cost      #
#---------------------------------------------------------------------#
# HF      | SI                              | SI          | M**4      #
# MP2     | NO                              | NO          | M**5      #
# CISD    | NO                              | SI          | M**7      #
# CCSD    | SI                              | NO          | M**6      #
# CCSD(T) | SI                              | NO          | M**9      #
# CASCI   | NO                              | SI          | exp(Nact) #
# CASSCF  | NO                              | SI          | exp(Nact) #
# FCI     | SI                              | SI          | exp(M)    #
#---------------------------------------------------------------------#

#------------------------------------------#
# ORBITALI      CORRELAZIONE   COMPUTER    #
# VIRTUALI      DINAMICA       CLASSICO    #
# VALENZA       STATICA        QUANTISTICO #
#------------------------------------------#

# E(R,basis,method) "potential energy surface = energia versus bondlength"
# R_{eq}(basis,method) = argmin_R E(R,basis,method)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='Precision-3520', release='4.4.0-210-generic', version='#242-Ubuntu SMP Fri Apr 16 09:57:56 UTC 2021', machine='x86_64')  Threads 8
Python 3.9.5 (default, Jun  4 2021, 12:28:51) 
[GCC 7.5.0]
numpy 1.21.1  scipy 1.7.0
Date: Wed Sep  8 21:47:56 2021
PySCF version 1.7.6
PySCF path  /home/alessandro/miniconda3/envs/IBM/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.969700000000 AA    0.000000000000   0.000000000000   1.832467422991 Bohr

nuclear repulsion = 4.36569834728266
point group symmetry = Coov
num. orbitals of irrep A1 = 23
num. orbitals of irrep E1x = 14
num. orbitals of irrep E1y = 14
num. orbitals of irrep E2x = 7
num. orbitals of irrep E2y = 7
num. orbitals of irrep E3x = 2
num. orbitals of irrep E3y = 2
number of shells = 22
number of NR pGTOs = 83
number of NR cGTOs = 69
basis = aug-cc-pvtz
ecp = {}
CPU time:       468.65
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp9pc9t5er
max_memory 4000 MB (current use 213 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp9pc9t5er
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 213 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.433224305236267  LUMO (A1) = 0.0269188040394653
Initial guess E= -75.4040318834428  |g|= 0.210869
macro= 0  E= -75.4137793223647  delta_E= -0.00974744  |g|= 0.210869  2 KF 5 JK
macro= 1  E= -75.4144585999607  delta_E= -0.000679278  |g|= 0.0931125  2 KF 5 JK
macro= 2  E= -75.4127699260895  delta_E= 0.00168867  |g|= 0.0615583  2 KF 5 JK
macro= 3  E= -75.4142768674687  delta_E= -0.00150694  |g|= 0.107274  2 KF 5 JK
macro= 4  E= -75.4126435492144  delta_E= 0.00163332  |g|= 0.0585238  2 KF 5 JK
macro= 5  E= -75.4142768674207  delta_E= -0.00163332  |g|= 0.109035  2 KF 5 JK
macro= 6  E= -75.4132114141645  delta_E= 0.00106545  |g|= 0.0617807  2 KF 5 JK
macro= 7  E= -75.4143140319696  delta_E= -0.00110262  |g|= 0.101083  2 KF 5 JK
macro= 8  E= -75.4130016442573  delta_E= 0.00131239  |g|= 0.0599178  2 KF 5 JK
macro= 9  E= -75.4143126250644  delta_E= -0.00131098  |g|= 0.104495  2 KF 5 JK
macro= 10  E= -75.4130514320749  delta_E= 0.00126119  |g|= 0.0601603  2 KF 5 JK
macro= 11  E= -75.4143184035204  delta_E= -0.00126697  |g|= 0.103806  2 KF 5 JK
macro= 12  E= -75.4130052984759  delta_E= 0.00131311  |g|= 0.0598578  2 KF 5 JK
macro= 13  E= -75.4143222766169  delta_E= -0.00131698  |g|= 0.104595  2 KF 5 JK
macro= 14  E= -75.4129952613783  delta_E= 0.00132702  |g|= 0.0598226  2 KF 5 JK
macro= 15  E= -75.4143267388091  delta_E= -0.00133148  |g|= 0.104812  2 KF 5 JK
macro= 16  E= -75.4129713143636  delta_E= 0.00135542  |g|= 0.0596922  2 KF 5 JK
macro= 17  E= -75.4143310576424  delta_E= -0.00135974  |g|= 0.105235  2 KF 5 JK
macro= 18  E= -75.4129530220373  delta_E= 0.00137804  |g|= 0.0596041  2 KF 5 JK
macro= 19  E= -75.4143354315638  delta_E= -0.00138241  |g|= 0.105565  2 KF 5 JK
macro= 20  E= -75.4129326745261  delta_E= 0.00140276  |g|= 0.0594985  2 KF 5 JK
macro= 21  E= -75.4143398094185  delta_E= -0.00140713  |g|= 0.105921  2 KF 5 JK
macro= 22  E= -75.4129133891865  delta_E= 0.00142642  |g|= 0.0593988  2 KF 5 JK
macro= 23  E= -75.4143441912872  delta_E= -0.0014308  |g|= 0.106257  2 KF 5 JK
macro= 24  E= -75.4128939251927  delta_E= 0.00145027  |g|= 0.0592946  2 KF 5 JK
macro= 25  E= -75.4143485789005  delta_E= -0.00145465  |g|= 0.106591  2 KF 5 JK
macro= 26  E= -75.4128748144385  delta_E= 0.00147376  |g|= 0.0591901  2 KF 5 JK
macro= 27  E= -75.4143529635527  delta_E= -0.00147815  |g|= 0.106916  2 KF 5 JK
macro= 28  E= -75.412855856392  delta_E= 0.00149711  |g|= 0.0590836  2 KF 5 JK
macro= 29  E= -75.414357345397  delta_E= -0.00150149  |g|= 0.107234  2 KF 5 JK
macro= 30  E= -75.412837154408  delta_E= 0.00152019  |g|= 0.0589758  2 KF 5 JK
macro= 31  E= -75.4143617188246  delta_E= -0.00152456  |g|= 0.107545  2 KF 5 JK
macro= 32  E= -75.4128186819665  delta_E= 0.00154304  |g|= 0.0588666  2 KF 5 JK
macro= 33  E= -75.4143660816455  delta_E= -0.0015474  |g|= 0.107848  2 KF 5 JK
macro= 34  E= -75.4128004664791  delta_E= 0.00156562  |g|= 0.0587561  2 KF 5 JK
macro= 35  E= -75.4143704297929  delta_E= -0.00156996  |g|= 0.108145  2 KF 5 JK
macro= 36  E= -75.4127825105094  delta_E= 0.00158792  |g|= 0.0586444  2 KF 5 JK
macro= 37  E= -75.4143747602799  delta_E= -0.00159225  |g|= 0.108434  2 KF 5 JK
macro= 38  E= -75.4127648259947  delta_E= 0.00160993  |g|= 0.0585315  2 KF 5 JK
macro= 39  E= -75.414379069622  delta_E= -0.00161424  |g|= 0.108716  2 KF 5 JK
macro= 40  E= -75.4127474192526  delta_E= 0.00163165  |g|= 0.0584177  2 KF 5 JK
macro= 41  E= -75.4143833547009  delta_E= -0.00163594  |g|= 0.108991  2 KF 5 JK
macro= 42  E= -75.4127302976916  delta_E= 0.00165306  |g|= 0.0583029  2 KF 5 JK
macro= 43  E= -75.4143876123279  delta_E= -0.00165731  |g|= 0.109258  2 KF 5 JK
macro= 44  E= -75.4127134668386  delta_E= 0.00167415  |g|= 0.0581873  2 KF 5 JK
macro= 45  E= -75.4143918394931  delta_E= -0.00167837  |g|= 0.109519  2 KF 5 JK
macro= 46  E= -75.4126969317463  delta_E= 0.00169491  |g|= 0.058071  2 KF 5 JK
macro= 47  E= -75.4143960332525  delta_E= -0.0016991  |g|= 0.109773  2 KF 5 JK
macro= 48  E= -75.4126806963983  delta_E= 0.00171534  |g|= 0.0579541  2 KF 5 JK
macro= 49  E= -75.4144001908033  delta_E= -0.00171949  |g|= 0.110019  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4144001908033  |g|= 0.110019  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4144001908033
ROHF wavefunction is stable in the internal stability analysis
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp9pc9t5er
max_memory 4000 MB (current use 213 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp9pc9t5er
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 213 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.265345200221014  LUMO (A1) = 0.0303958427691115
Initial guess E= -75.4144001908033  |g|= 0.0578367
macro= 0  E= -75.4130291397671  delta_E= 0.00137105  |g|= 0.0578367  2 KF 5 JK
macro= 1  E= -75.4142228132963  delta_E= -0.00119367  |g|= 0.0941785  2 KF 5 JK
macro= 2  E= -75.413307360029  delta_E= 0.000915453  |g|= 0.0645589  2 KF 5 JK
macro= 3  E= -75.4142630512213  delta_E= -0.000955691  |g|= 0.0921216  2 KF 5 JK
macro= 4  E= -75.4133061953295  delta_E= 0.000956856  |g|= 0.06324  2 KF 5 JK
macro= 5  E= -75.4142671194827  delta_E= -0.000960924  |g|= 0.0921006  2 KF 5 JK
macro= 6  E= -75.413453518212  delta_E= 0.000813601  |g|= 0.0623931  2 KF 5 JK
macro= 7  E= -75.4142681618825  delta_E= -0.000814644  |g|= 0.0895674  2 KF 5 JK
macro= 8  E= -75.4133822589379  delta_E= 0.000885903  |g|= 0.0615025  2 KF 5 JK
macro= 9  E= -75.414269516694  delta_E= -0.000887258  |g|= 0.0912492  2 KF 5 JK
macro= 10  E= -75.4133280181664  delta_E= 0.000941499  |g|= 0.0617576  2 KF 5 JK
macro= 11  E= -75.4142703085873  delta_E= -0.00094229  |g|= 0.0923277  2 KF 5 JK
macro= 12  E= -75.4133214364406  delta_E= 0.000948872  |g|= 0.0619067  2 KF 5 JK
macro= 13  E= -75.4142714657326  delta_E= -0.000950029  |g|= 0.0924512  2 KF 5 JK
macro= 14  E= -75.4133148006077  delta_E= 0.000956665  |g|= 0.0618508  2 KF 5 JK
macro= 15  E= -75.4142730795896  delta_E= -0.000958279  |g|= 0.0925455  2 KF 5 JK
macro= 16  E= -75.4133008182273  delta_E= 0.000972261  |g|= 0.0618071  2 KF 5 JK
macro= 17  E= -75.4142747234484  delta_E= -0.000973905  |g|= 0.092749  2 KF 5 JK
macro= 18  E= -75.4132870580911  delta_E= 0.000987665  |g|= 0.0617959  2 KF 5 JK
macro= 19  E= -75.4142763190748  delta_E= -0.000989261  |g|= 0.0929405  2 KF 5 JK
macro= 20  E= -75.4132743260857  delta_E= 0.00100199  |g|= 0.0617807  2 KF 5 JK
macro= 21  E= -75.4142779279856  delta_E= -0.0010036  |g|= 0.0931101  2 KF 5 JK
macro= 22  E= -75.4132613414697  delta_E= 0.00101659  |g|= 0.0617591  2 KF 5 JK
macro= 23  E= -75.4142795605008  delta_E= -0.00101822  |g|= 0.0932794  2 KF 5 JK
macro= 24  E= -75.4132480384579  delta_E= 0.00103152  |g|= 0.0617367  2 KF 5 JK
macro= 25  E= -75.4142812054364  delta_E= -0.00103317  |g|= 0.0934493  2 KF 5 JK
macro= 26  E= -75.413234646312  delta_E= 0.00104656  |g|= 0.0617136  2 KF 5 JK
macro= 27  E= -75.41428286187  delta_E= -0.00104822  |g|= 0.0936164  2 KF 5 JK
macro= 28  E= -75.4132211906406  delta_E= 0.00106167  |g|= 0.0616889  2 KF 5 JK
macro= 29  E= -75.4142845324871  delta_E= -0.00106334  |g|= 0.0937804  2 KF 5 JK
macro= 30  E= -75.4132076596736  delta_E= 0.00107687  |g|= 0.0616625  2 KF 5 JK
macro= 31  E= -75.4142862180121  delta_E= -0.00107856  |g|= 0.0939416  2 KF 5 JK
macro= 32  E= -75.4131940743676  delta_E= 0.00109214  |g|= 0.0616346  2 KF 5 JK
macro= 33  E= -75.4137318674545  delta_E= -0.000537793  |g|= 0.0940999  2 KF 5 JK
macro= 34  E= -75.4135430036012  delta_E= 0.000188864  |g|= 0.0683611  2 KF 5 JK
macro= 35  E= -75.4136415120236  delta_E= -9.85084e-05  |g|= 0.0889176  2 KF 5 JK
macro= 36  E= -75.4132363820557  delta_E= 0.00040513  |g|= 0.0692304  2 KF 5 JK
macro= 37  E= -75.4136037126508  delta_E= -0.000367331  |g|= 0.0937441  2 KF 5 JK
macro= 38  E= -75.4134055605476  delta_E= 0.000198152  |g|= 0.070448  2 KF 5 JK
macro= 39  E= -75.4136255410784  delta_E= -0.000219981  |g|= 0.0911685  2 KF 5 JK
macro= 40  E= -75.4133167983904  delta_E= 0.000308743  |g|= 0.0697471  2 KF 5 JK
macro= 41  E= -75.4135981219173  delta_E= -0.000281324  |g|= 0.0925074  2 KF 5 JK
macro= 42  E= -75.4133462791116  delta_E= 0.000251843  |g|= 0.0703275  2 KF 5 JK
macro= 43  E= -75.4135909096543  delta_E= -0.000244631  |g|= 0.0920198  2 KF 5 JK
macro= 44  E= -75.4133179478859  delta_E= 0.000272962  |g|= 0.0703525  2 KF 5 JK
macro= 45  E= -75.4135737798213  delta_E= -0.000255832  |g|= 0.0924137  2 KF 5 JK
macro= 46  E= -75.4133179343515  delta_E= 0.000255845  |g|= 0.0706432  2 KF 5 JK
macro= 47  E= -75.4135614678041  delta_E= -0.000243533  |g|= 0.0923771  2 KF 5 JK
macro= 48  E= -75.4133039878075  delta_E= 0.00025748  |g|= 0.0708037  2 KF 5 JK
macro= 49  E= -75.4135468032722  delta_E= -0.000242815  |g|= 0.0925491  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4135468032722  |g|= 0.0925491  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4135468032722
**** SCF Summaries ****
Total Energy =                         -75.413546803272240
Nuclear Repulsion Energy =               4.365698347282665
One-electron Energy =                 -112.439150662166526
Two-electron Energy =                   32.659905511611626
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y
double occ                     3    0    1    0    0    0    0
single occ                     0    1    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6709348410126  | -20.6867684043005  | -20.6551012777247  occ= 2
MO #2   (A1  #2 ) energy= -1.3285063836895   | -1.39684399302767  | -1.26016877435134  occ= 2
MO #3   (A1  #3 ) energy= -0.67805184205856  | -0.698262932893734 | -0.657840751223384 occ= 2
MO #4   (E1y #1 ) energy= -0.55751073132135  | -0.576029101937293 | -0.538992360705406 occ= 2
MO #5   (E1x #1 ) energy= -0.269668062543777 | -0.649332042779235 | 0.109995917691682  occ= 1
MO #6   (A1  #4 ) energy= 0.0300621292117335 | 0.0293442284282312 | 0.0307800299952331 occ= 0
MO #7   (A1  #5 ) energy= 0.136545240210003  | 0.135517388212444  | 0.137573092207567  occ= 0
MO #8   (E1x #2 ) energy= 0.161348464382527  | 0.153016280832694  | 0.16968064793236   occ= 0
MO #9   (E1y #2 ) energy= 0.161797468346583  | 0.160972614315942  | 0.162622322377223  occ= 0
MO #10  (A1  #6 ) energy= 0.184417063582799  | 0.181934474450293  | 0.186899652715301  occ= 0
MO #11  (A1  #7 ) energy= 0.262803178523189  | 0.260432378881556  | 0.265173978164822  occ= 0
MO #12  (E1x #3 ) energy= 0.272008424865978  | 0.267610140006134  | 0.276406709725821  occ= 0
MO #13  (E1y #3 ) energy= 0.274438618390417  | 0.27396436652466   | 0.274912870256173  occ= 0
MO #14  (A1  #8 ) energy= 0.427659008229044  | 0.423428410982699  | 0.431889605475299  occ= 0
MO #15  (A1  #9 ) energy= 0.639636408367836  | 0.633452920598041  | 0.645819896137617  occ= 0
MO #16  (E2x #1 ) energy= 0.643406481126769  | 0.63274075978324   | 0.654072202470299  occ= 0
MO #17  (E2y #1 ) energy= 0.643406481126769  | 0.63274075978324   | 0.654072202470299  occ= 0
MO #18  (E1x #4 ) energy= 0.719730517019806  | 0.709519758812778  | 0.729941275226834  occ= 0
MO #19  (E1y #4 ) energy= 0.725504908538951  | 0.724135079029586  | 0.726874738048318  occ= 0
MO #20  (A1  #10) energy= 0.876215730736049  | 0.87302301352474   | 0.879408447947397  occ= 0
MO #21  (E1y #5 ) energy= 0.879231129255506  | 0.876223586158908  | 0.882238672352106  occ= 0
MO #22  (E1x #5 ) energy= 0.880598220492524  | 0.855553472522591  | 0.905642968462458  occ= 0
MO #23  (A1  #11) energy= 0.926320066350541  | 0.921321452338648  | 0.931318680362459  occ= 0
MO #24  (E2x #2 ) energy= 0.937969736670487  | 0.936061878826883  | 0.939877594514089  occ= 0
MO #25  (E2y #2 ) energy= 0.937969736670493  | 0.93606187882689   | 0.939877594514096  occ= 0
MO #26  (A1  #12) energy= 1.00048874130257   | 0.996282892413564  | 1.00469459019152   occ= 0
MO #27  (E1x #6 ) energy= 1.00174184136942   | 0.974764490102569  | 1.02871919263628   occ= 0
MO #28  (E1y #6 ) energy= 1.00633497572652   | 1.00306932003298   | 1.00960063142006   occ= 0
MO #29  (E1x #7 ) energy= 1.50366478610345   | 1.49102070435725   | 1.51630886784965   occ= 0
MO #30  (E1y #7 ) energy= 1.51118635482299   | 1.50945701138863   | 1.51291569825735   occ= 0
MO #31  (A1  #13) energy= 1.69815268240205   | 1.6885100413446    | 1.7077953234595    occ= 0
MO #32  (A1  #14) energy= 2.03213494684738   | 2.0221515115842    | 2.04211838211056   occ= 0
MO #33  (E3x #1 ) energy= 2.04597002355713   | 2.03528037969663   | 2.05665966741763   occ= 0
MO #34  (E3y #1 ) energy= 2.04597002355713   | 2.03528037969662   | 2.05665966741763   occ= 0
MO #35  (E2x #3 ) energy= 2.12188166841635   | 2.0881080091268    | 2.1556553277059    occ= 0
MO #36  (E2y #3 ) energy= 2.12188166841635   | 2.0881080091268    | 2.15565532770591   occ= 0
MO #37  (E1x #8 ) energy= 2.26524140979255   | 2.24309797673869   | 2.28738484284641   occ= 0
MO #38  (E1y #8 ) energy= 2.28182118733513   | 2.27826620028017   | 2.28537617439009   occ= 0
MO #39  (E2x #4 ) energy= 2.32242395221368   | 2.31339225594984   | 2.33145564847753   occ= 0
MO #40  (E2y #4 ) energy= 2.32242395221369   | 2.31339225594985   | 2.33145564847754   occ= 0
MO #41  (A1  #15) energy= 2.44265887927832   | 2.43428649295922   | 2.4510312655978    occ= 0
MO #42  (A1  #16) energy= 2.48347969798026   | 2.47581031443854   | 2.49114908152202   occ= 0
MO #43  (E1x #9 ) energy= 2.73962943233538   | 2.72023781118585   | 2.75902105348491   occ= 0
MO #44  (E1y #9 ) energy= 2.76103329127178   | 2.75739547530412   | 2.76467110723945   occ= 0
MO #45  (A1  #17) energy= 3.57602859658144   | 3.5715788207795    | 3.58047837238338   occ= 0
MO #46  (E2x #5 ) energy= 4.02755173157376   | 4.024670776802     | 4.03043268634552   occ= 0
MO #47  (E2y #5 ) energy= 4.02755173157376   | 4.024670776802     | 4.03043268634551   occ= 0
MO #48  (E1x #10) energy= 4.0562312675789    | 4.00605649804486   | 4.10640603711295   occ= 0
MO #49  (E1y #10) energy= 4.06624896909262   | 4.05947412741945   | 4.07302381076579   occ= 0
MO #50  (E1x #11) energy= 4.29648493530787   | 4.29229422326702   | 4.30067564734872   occ= 0
MO #51  (E1y #11) energy= 4.30549612551565   | 4.30479591113142   | 4.30619633989989   occ= 0
MO #52  (A1  #18) energy= 4.62700658707087   | 4.62240063958965   | 4.63161253455208   occ= 0
MO #53  (A1  #19) energy= 5.11124782955693   | 5.10172598319211   | 5.12076967592185   occ= 0
MO #54  (E1x #12) energy= 5.26294674533351   | 5.24431571233376   | 5.28157777833328   occ= 0
MO #55  (E1y #12) energy= 5.28605217904164   | 5.28243727400402   | 5.28966708407928   occ= 0
MO #56  (A1  #20) energy= 6.12824183882472   | 6.11852354817908   | 6.13796012947062   occ= 0
MO #57  (E3x #2 ) energy= 6.43766240080341   | 6.41388919730208   | 6.46143560430473   occ= 0
MO #58  (E3y #2 ) energy= 6.4376624008034    | 6.41388919730208   | 6.46143560430473   occ= 0
MO #59  (E2x #6 ) energy= 6.59357467590097   | 6.57600543710379   | 6.61114391469815   occ= 0
MO #60  (E2y #6 ) energy= 6.59357467590096   | 6.57600543710379   | 6.61114391469814   occ= 0
MO #61  (E2x #7 ) energy= 6.98323229664893   | 6.94443892701696   | 7.0220256662809    occ= 0
MO #62  (E2y #7 ) energy= 6.98323229664893   | 6.94443892701696   | 7.0220256662809    occ= 0
MO #63  (E1x #13) energy= 7.13252778806252   | 7.1133122934152    | 7.15174328270985   occ= 0
MO #64  (E1y #13) energy= 7.16803081041513   | 7.16379135030384   | 7.17227027052643   occ= 0
MO #65  (E1x #14) energy= 7.18038804151026   | 7.14362967367053   | 7.21714640935      occ= 0
MO #66  (E1y #14) energy= 7.21215349143491   | 7.20591384260608   | 7.21839314026372   occ= 0
MO #67  (A1  #21) energy= 7.35948764442002   | 7.35123100792947   | 7.36774428091062   occ= 0
MO #68  (A1  #22) energy= 7.67754524771461   | 7.66630191853119   | 7.68878857689801   occ= 0
MO #69  (A1  #23) energy= 12.8937130209739   | 12.8805212650161   | 12.9069047769314   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.81599
pop of  0 O 3s        0.00493
pop of  0 O 4s        0.00129
pop of  0 O 5s        0.00020
pop of  0 O 2px       0.99566
pop of  0 O 2py       1.99140
pop of  0 O 2pz       1.51901
pop of  0 O 3px       0.00087
pop of  0 O 3py       0.00163
pop of  0 O 3pz       0.00152
pop of  0 O 4px       0.00030
pop of  0 O 4py       0.00050
pop of  0 O 4pz       0.00168
pop of  0 O 5px       0.00012
pop of  0 O 5py       0.00024
pop of  0 O 5pz       0.00009
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00182
pop of  0 O 3dz^2     0.00825
pop of  0 O 3dxz      0.00088
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00034
pop of  0 O 4dz^2     0.00058
pop of  0 O 4dxz      0.00016
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00003
pop of  0 O 5dz^2     0.00016
pop of  0 O 5dxz      0.00001
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00025
pop of  0 O 4f 0      0.00093
pop of  0 O 4f 1      0.00012
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00007
pop of  0 O 5f 0      0.00011
pop of  0 O 5f 1      0.00003
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  1 H 1s        0.62581
pop of  1 H 2s        0.01268
pop of  1 H 3s        0.00505
pop of  1 H 4s        0.00014
pop of  1 H 2px       0.00182
pop of  1 H 2py       0.00368
pop of  1 H 2pz       0.00079
pop of  1 H 3px       0.00000
pop of  1 H 3py       0.00000
pop of  1 H 3pz       0.00035
pop of  1 H 4px       0.00000
pop of  1 H 4py       0.00001
pop of  1 H 4pz       0.00013
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00002
pop of  1 H 3dz^2     0.00023
pop of  1 H 3dxz      0.00003
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00001
pop of  1 H 4dz^2     0.00009
pop of  1 H 4dxz      0.00000
pop of  1 H 4dx2-y2    0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34915
charge of  1H =      0.34915
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.72866

WARN: RMP2 method does not support ROHF method. ROHF object is converted to UHF object and UMP2 method is called.


******** <class 'pyscf.mp.ump2.UMP2'> ********
nocc = (4, 3), nmo = (68, 68)
frozen orbitals 1
max_memory 4000 MB (current use 213 MB)
Init E(MP2) = -0.207597317089931
cycle = 1  E_corr(MP2) = -0.207597317089931  dE = -5.55111512e-17  norm(t2) = 2.77706e-14
E(UMP2) = -75.6211441203622  E_corr = -0.207597317089931

WARN: RCISD method does not support ROHF method. ROHF object is converted to UHF object and UCISD method is called.


******** <class 'pyscf.ci.ucisd.UCISD'> ********
CISD nocc = (4, 3), nmo = (68, 68)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-09
max_cycle = 50
max_space = 12
lindep = 0
nroots = 1
max_memory 4000 MB (current use 347 MB)
Init t2, MP2 energy = -0.207597317089928
UCISD converged
E(UCISD) = -75.63198638835811  E_corr = -0.2184395850858811

WARN: RCCSD method does not support ROHF method. ROHF object is converted to UHF object and UCCSD method is called.


******** <class 'pyscf.cc.uccsd.UCCSD'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (68, 68)
frozen orbitals 1
max_cycle = 50
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-06
diis_space = 6
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 4000 MB (current use 249 MB)
Init t2, MP2 energy = -0.207597317089934
Init E_corr(CCSD) = -0.213223081633098
cycle = 1  E_corr(CCSD) = -0.220941806996275  dE = -0.00771872536  norm(t1,t2) = 0.0416858
cycle = 2  E_corr(CCSD) = -0.224672159962844  dE = -0.00373035297  norm(t1,t2) = 0.0128463
cycle = 3  E_corr(CCSD) = -0.225304877895315  dE = -0.000632717932  norm(t1,t2) = 0.00666252
cycle = 4  E_corr(CCSD) = -0.225918188371966  dE = -0.000613310477  norm(t1,t2) = 0.00306305
cycle = 5  E_corr(CCSD) = -0.22586541346727  dE = 5.27749047e-05  norm(t1,t2) = 0.000945285
cycle = 6  E_corr(CCSD) = -0.225858470763368  dE = 6.9427039e-06  norm(t1,t2) = 0.000291976
cycle = 7  E_corr(CCSD) = -0.225868329822654  dE = -9.85905929e-06  norm(t1,t2) = 0.000125068
cycle = 8  E_corr(CCSD) = -0.225869977980436  dE = -1.64815778e-06  norm(t1,t2) = 3.92116e-05
cycle = 9  E_corr(CCSD) = -0.225868990453866  dE = 9.8752657e-07  norm(t1,t2) = 1.47535e-05
cycle = 10  E_corr(CCSD) = -0.225868994549248  dE = -4.09538212e-09  norm(t1,t2) = 4.69009e-06
cycle = 11  E_corr(CCSD) = -0.22586898472724  dE = 9.82200818e-09  norm(t1,t2) = 1.66833e-06
cycle = 12  E_corr(CCSD) = -0.225868961005775  dE = 2.3721465e-08  norm(t1,t2) = 7.72667e-07
UCCSD converged
E(UCCSD) = -75.63941576427801  E_corr = -0.2258689610057747
UCCSD(T) correction = -0.00607949060269567
Active space CI wfn symmetry = E1x

******** CASCI flags ********
CAS (4e+3e, 5o), ncore = 1, nvir = 63
natorb = False
canonicalization = True
sorting_mo_energy = False
max_memory 4000 (MB)
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 200
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
Input CI wfn symmetry = E1x
Density matrix diagonal elements [1.99996981e+00 1.99997846e+00 1.99999839e+00 1.00000000e+00
 5.33406569e-05]
CASCI converged
CASCI E = -75.4136037102852  E(CI) = -19.5821618340563  S^2 = 0.7500000

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+3e, 5o), ncore = 1, nvir = 63
frozen orbitals 1
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/alessandro/Scrivania/Università/Master Thesis/git/test/Esercizio/OH_radical/tmp9pc9t5er
max_memory 4000 MB (current use 284 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 0
spin = None
CI wfn symmetry = None
Active space CI wfn symmetry = E1x
CASCI E = -75.4136037102852  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -75.4234177147908  dE = -0.0098140045  S^2 = 0.7500000
               |grad[o]|=0.0702  |grad[c]|= 0.03458713071567386  |ddm|=0.00542
macro iter 2 (21 JK  4 micro), CASSCF E = -75.43886263021  dE = -0.015444915  S^2 = 0.7500000
               |grad[o]|=0.034  |grad[c]|= 0.027769380724300536  |ddm|=0.0178
macro iter 3 (14 JK  4 micro), CASSCF E = -75.4406623401604  dE = -0.00179971  S^2 = 0.7500000
               |grad[o]|=0.0268  |grad[c]|= 0.0023394501918535767  |ddm|=0.014
macro iter 4 (5 JK  2 micro), CASSCF E = -75.4406624937643  dE = -1.5360393e-07  S^2 = 0.7500000
               |grad[o]|=0.000579  |grad[c]|= 3.5544733248979896e-05  |ddm|=0.000265
macro iter 5 (3 JK  1 micro), CASSCF E = -75.4406624954598  dE = -1.6954829e-09  S^2 = 0.7500000
               |grad[o]|=6.06e-05  |grad[c]|= 2.076265795689524e-05  |ddm|=2.7e-05
1-step CASSCF converged in 5 macro (64 JK 15 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.99429432 1.98191826 1.99967501 1.         0.02411242]
CASSCF energy = -75.4406624954598
CASCI E = -75.4406624954598  E(CI) = -19.6092206192309  S^2 = 0.7500000
Hartree-Fock    -75.41354680327224
Moller-Plesset  -75.62114412036217
CISD            -75.63198638835811
CCSD            -75.63941576427801
CCSD(T)         -75.64549525488071
CASCI           -75.41360371028519
CASSCF          -75.44066249545979
#####################################################
END: aug-cc-pvtz
#####################################################
