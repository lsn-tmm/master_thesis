#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.82)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab21.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 20:44:44 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.820000000000 AA    0.000000000000   0.000000000000   1.549575422143 Bohr

nuclear repulsion = 5.16270449678049
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         4.40
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmp_o1m3wcn
max_memory 4000 MB (current use 272 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmp_o1m3wcn
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 272 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.459630792287873  LUMO (A1) = 0.0272860300651329
Initial guess E= -75.3867246687434  |g|= 0.210263
macro= 0  E= -75.3947198855162  delta_E= -0.00799522  |g|= 0.210263  2 KF 5 JK
macro= 1  E= -75.395527929867  delta_E= -0.000808044  |g|= 0.101043  2 KF 5 JK
macro= 2  E= -75.3940080552553  delta_E= 0.00151987  |g|= 0.064451  2 KF 5 JK
macro= 3  E= -75.3954265752927  delta_E= -0.00141852  |g|= 0.113095  2 KF 5 JK
macro= 4  E= -75.3941908228507  delta_E= 0.00123575  |g|= 0.0619786  2 KF 5 JK
macro= 5  E= -75.3954691428203  delta_E= -0.00127832  |g|= 0.111203  2 KF 5 JK
macro= 6  E= -75.3943004462205  delta_E= 0.0011687  |g|= 0.0632754  2 KF 5 JK
macro= 7  E= -75.3954643612587  delta_E= -0.00116392  |g|= 0.108629  2 KF 5 JK
macro= 8  E= -75.3942580734946  delta_E= 0.00120629  |g|= 0.0626545  2 KF 5 JK
macro= 9  E= -75.3954686953124  delta_E= -0.00121062  |g|= 0.10932  2 KF 5 JK
macro= 10  E= -75.3942507710438  delta_E= 0.00121792  |g|= 0.0627735  2 KF 5 JK
macro= 11  E= -75.3954715433872  delta_E= -0.00122077  |g|= 0.109465  2 KF 5 JK
macro= 12  E= -75.39423226773  delta_E= 0.00123928  |g|= 0.062694  2 KF 5 JK
macro= 13  E= -75.3954746614792  delta_E= -0.00124239  |g|= 0.109813  2 KF 5 JK
macro= 14  E= -75.3942178626828  delta_E= 0.0012568  |g|= 0.0626634  2 KF 5 JK
macro= 15  E= -75.3954777548088  delta_E= -0.00125989  |g|= 0.110086  2 KF 5 JK
macro= 16  E= -75.3942021249523  delta_E= 0.00127563  |g|= 0.0626141  2 KF 5 JK
macro= 17  E= -75.395480866799  delta_E= -0.00127874  |g|= 0.110378  2 KF 5 JK
macro= 18  E= -75.3941869953874  delta_E= 0.00129387  |g|= 0.0625697  2 KF 5 JK
macro= 19  E= -75.3954839767007  delta_E= -0.00129698  |g|= 0.110655  2 KF 5 JK
macro= 20  E= -75.3941717714342  delta_E= 0.00131221  |g|= 0.0625219  2 KF 5 JK
macro= 21  E= -75.3954870895251  delta_E= -0.00131532  |g|= 0.11093  2 KF 5 JK
macro= 22  E= -75.394156721122  delta_E= 0.00133037  |g|= 0.0624736  2 KF 5 JK
macro= 23  E= -75.3954901997609  delta_E= -0.00133348  |g|= 0.111198  2 KF 5 JK
macro= 24  E= -75.3941417598504  delta_E= 0.00134844  |g|= 0.0624238  2 KF 5 JK
macro= 25  E= -75.3954933075616  delta_E= -0.00135155  |g|= 0.111461  2 KF 5 JK
macro= 26  E= -75.3941269313508  delta_E= 0.00136638  |g|= 0.0623727  2 KF 5 JK
macro= 27  E= -75.395496410567  delta_E= -0.00136948  |g|= 0.111718  2 KF 5 JK
macro= 28  E= -75.3941122321856  delta_E= 0.00138418  |g|= 0.0623204  2 KF 5 JK
macro= 29  E= -75.3954995076526  delta_E= -0.00138728  |g|= 0.111971  2 KF 5 JK
macro= 30  E= -75.3940976751996  delta_E= 0.00140183  |g|= 0.0622667  2 KF 5 JK
macro= 31  E= -75.3955025971692  delta_E= -0.00140492  |g|= 0.112217  2 KF 5 JK
macro= 32  E= -75.3940832665829  delta_E= 0.00141933  |g|= 0.0622117  2 KF 5 JK
macro= 33  E= -75.3955056777158  delta_E= -0.00142241  |g|= 0.112459  2 KF 5 JK
macro= 34  E= -75.3940690140938  delta_E= 0.00143666  |g|= 0.0621556  2 KF 5 JK
macro= 35  E= -75.3955087478019  delta_E= -0.00143973  |g|= 0.112695  2 KF 5 JK
macro= 36  E= -75.3940549241312  delta_E= 0.00145382  |g|= 0.0620982  2 KF 5 JK
macro= 37  E= -75.3955118059964  delta_E= -0.00145688  |g|= 0.112926  2 KF 5 JK
macro= 38  E= -75.3940410027844  delta_E= 0.0014708  |g|= 0.0620397  2 KF 5 JK
macro= 39  E= -75.3955148508698  delta_E= -0.00147385  |g|= 0.113151  2 KF 5 JK
macro= 40  E= -75.3940272554816  delta_E= 0.0014876  |g|= 0.06198  2 KF 5 JK
macro= 41  E= -75.3955178810228  delta_E= -0.00149063  |g|= 0.113371  2 KF 5 JK
macro= 42  E= -75.3940136871309  delta_E= 0.00150419  |g|= 0.0619193  2 KF 5 JK
macro= 43  E= -75.3955208950815  delta_E= -0.00150721  |g|= 0.113586  2 KF 5 JK
macro= 44  E= -75.3940003020934  delta_E= 0.00152059  |g|= 0.0618576  2 KF 5 JK
macro= 45  E= -75.3955238917037  delta_E= -0.00152359  |g|= 0.113796  2 KF 5 JK
macro= 46  E= -75.393987104217  delta_E= 0.00153679  |g|= 0.061795  2 KF 5 JK
macro= 47  E= -75.3955268695824  delta_E= -0.00153977  |g|= 0.114  2 KF 5 JK
macro= 48  E= -75.3939740968506  delta_E= 0.00155277  |g|= 0.0617314  2 KF 5 JK
macro= 49  E= -75.3955298274492  delta_E= -0.00155573  |g|= 0.1142  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3955298274492  |g|= 0.1142  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3955298274492

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmp_o1m3wcn
max_memory 4000 MB (current use 546 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmp_o1m3wcn
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 546 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.272880054117417  LUMO (A1) = 0.029053993138491
Initial guess E= -75.3969428439314  |g|= 0.0380608
macro= 0  E= -75.3970416800394  delta_E= -9.88361e-05  |g|= 0.0380608  2 KF 5 JK
macro= 1  E= -75.3970395148986  delta_E= 2.16514e-06  |g|= 0.0239663  2 KF 5 JK
macro= 2  E= -75.396998395031  delta_E= 4.11199e-05  |g|= 0.0316593  2 KF 5 JK
macro= 3  E= -75.3970514909778  delta_E= -5.30959e-05  |g|= 0.0275543  2 KF 5 JK
macro= 4  E= -75.3970061029722  delta_E= 4.5388e-05  |g|= 0.0305752  2 KF 5 JK
macro= 5  E= -75.3970537753064  delta_E= -4.76723e-05  |g|= 0.0272474  2 KF 5 JK
macro= 6  E= -75.3970062223613  delta_E= 4.75529e-05  |g|= 0.0303194  2 KF 5 JK
macro= 7  E= -75.3970528302471  delta_E= -4.66079e-05  |g|= 0.0272338  2 KF 5 JK
macro= 8  E= -75.3970062536572  delta_E= 4.65766e-05  |g|= 0.0303842  2 KF 5 JK
macro= 9  E= -75.3970529356141  delta_E= -4.6682e-05  |g|= 0.0272362  2 KF 5 JK
macro= 10  E= -75.3970062640556  delta_E= 4.66716e-05  |g|= 0.0303735  2 KF 5 JK
macro= 11  E= -75.3970529166699  delta_E= -4.66526e-05  |g|= 0.0272365  2 KF 5 JK
macro= 12  E= -75.3970062662521  delta_E= 4.66504e-05  |g|= 0.0303742  2 KF 5 JK
macro= 13  E= -75.3970529206051  delta_E= -4.66544e-05  |g|= 0.0272369  2 KF 5 JK
macro= 14  E= -75.3970062687029  delta_E= 4.66519e-05  |g|= 0.0303736  2 KF 5 JK
macro= 15  E= -75.397052921754  delta_E= -4.66531e-05  |g|= 0.027237  2 KF 5 JK
macro= 16  E= -75.3970062708994  delta_E= 4.66509e-05  |g|= 0.0303733  2 KF 5 JK
macro= 17  E= -75.3970529232205  delta_E= -4.66523e-05  |g|= 0.027237  2 KF 5 JK
macro= 18  E= -75.3970062730609  delta_E= 4.66502e-05  |g|= 0.0303731  2 KF 5 JK
macro= 19  E= -75.3970529244785  delta_E= -4.66514e-05  |g|= 0.0272369  2 KF 5 JK
macro= 20  E= -75.3970062751781  delta_E= 4.66493e-05  |g|= 0.0303729  2 KF 5 JK
macro= 21  E= -75.3970529256135  delta_E= -4.66504e-05  |g|= 0.0272368  2 KF 5 JK
macro= 22  E= -75.3970062772638  delta_E= 4.66483e-05  |g|= 0.0303728  2 KF 5 JK
macro= 23  E= -75.3970529266395  delta_E= -4.66494e-05  |g|= 0.0272367  2 KF 5 JK
macro= 24  E= -75.397006279324  delta_E= 4.66473e-05  |g|= 0.0303727  2 KF 5 JK
macro= 25  E= -75.3970529275803  delta_E= -4.66483e-05  |g|= 0.0272366  2 KF 5 JK
macro= 26  E= -75.3970062813627  delta_E= 4.66462e-05  |g|= 0.0303725  2 KF 5 JK
macro= 27  E= -75.3970529284544  delta_E= -4.66471e-05  |g|= 0.0272365  2 KF 5 JK
macro= 28  E= -75.3970062833842  delta_E= 4.66451e-05  |g|= 0.0303724  2 KF 5 JK
macro= 29  E= -75.3970529292764  delta_E= -4.66459e-05  |g|= 0.0272364  2 KF 5 JK
macro= 30  E= -75.3970062853908  delta_E= 4.66439e-05  |g|= 0.0303723  2 KF 5 JK
macro= 31  E= -75.3970529300579  delta_E= -4.66447e-05  |g|= 0.0272363  2 KF 5 JK
macro= 32  E= -75.3970062873852  delta_E= 4.66427e-05  |g|= 0.0303722  2 KF 5 JK
macro= 33  E= -75.3970529308073  delta_E= -4.66434e-05  |g|= 0.0272362  2 KF 5 JK
macro= 34  E= -75.3970062893685  delta_E= 4.66414e-05  |g|= 0.0303722  2 KF 5 JK
macro= 35  E= -75.3970529315315  delta_E= -4.66422e-05  |g|= 0.0272361  2 KF 5 JK
macro= 36  E= -75.3970062913421  delta_E= 4.66402e-05  |g|= 0.0303721  2 KF 5 JK
macro= 37  E= -75.3970529322356  delta_E= -4.66409e-05  |g|= 0.027236  2 KF 5 JK
macro= 38  E= -75.3970062933072  delta_E= 4.66389e-05  |g|= 0.030372  2 KF 5 JK
macro= 39  E= -75.3970529329237  delta_E= -4.66396e-05  |g|= 0.0272358  2 KF 5 JK
macro= 40  E= -75.3970062952642  delta_E= 4.66377e-05  |g|= 0.0303719  2 KF 5 JK
macro= 41  E= -75.3970529335982  delta_E= -4.66383e-05  |g|= 0.0272357  2 KF 5 JK
macro= 42  E= -75.3970062972137  delta_E= 4.66364e-05  |g|= 0.0303718  2 KF 5 JK
macro= 43  E= -75.3970529342619  delta_E= -4.6637e-05  |g|= 0.0272356  2 KF 5 JK
macro= 44  E= -75.3970062991565  delta_E= 4.66351e-05  |g|= 0.0303717  2 KF 5 JK
macro= 45  E= -75.3970529349165  delta_E= -4.66358e-05  |g|= 0.0272355  2 KF 5 JK
macro= 46  E= -75.3970063010927  delta_E= 4.66338e-05  |g|= 0.0303717  2 KF 5 JK
macro= 47  E= -75.3970529355631  delta_E= -4.66345e-05  |g|= 0.0272354  2 KF 5 JK
macro= 48  E= -75.3970063030222  delta_E= 4.66325e-05  |g|= 0.0303716  2 KF 5 JK
macro= 49  E= -75.3970529362029  delta_E= -4.66332e-05  |g|= 0.0272352  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3970529362029  |g|= 0.0272352  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3970529362029
**** SCF Summaries ****
Total Energy =                         -75.397052936202925
Nuclear Repulsion Energy =               5.162704496780488
One-electron Energy =                 -114.086587126050546
Two-electron Energy =                   33.526829693067121
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    1    0    0    0    0    0    0    0
single occ                     0    0    1    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.5897490317719  | -20.6067374577481  | -20.5727606057956  occ= 2
MO #2   (A1  #2 ) energy= -1.36313084627604  | -1.43078733642167  | -1.29547435613042  occ= 2
MO #3   (A1  #3 ) energy= -0.697505336066447 | -0.72160791690853  | -0.673402755224365 occ= 2
MO #4   (E1x #1 ) energy= -0.5416692642022   | -0.560967239600429 | -0.522371288803971 occ= 2
MO #5   (E1y #1 ) energy= -0.249164942405819 | -0.648818783283013 | 0.15048889847137   occ= 1
MO #6   (A1  #4 ) energy= 0.0291045498502017 | 0.0286730677638466 | 0.0295360319365309 occ= 0
MO #7   (A1  #5 ) energy= 0.114991968060361  | 0.114545486254891  | 0.11543844986572   occ= 0
MO #8   (E1y #2 ) energy= 0.130981041273348  | 0.127228281582037  | 0.13473380096466   occ= 0
MO #9   (E1x #2 ) energy= 0.134100467437316  | 0.133614966263134  | 0.134585968611499  occ= 0
MO #10  (A1  #6 ) energy= 0.165632785391298  | 0.164159429338966  | 0.16710614144352   occ= 0
MO #11  (E1y #3 ) energy= 0.22217574904592   | 0.219758544582159  | 0.224592953509676  occ= 0
MO #12  (A1  #7 ) energy= 0.223397448364123  | 0.222094343265502  | 0.224700553462655  occ= 0
MO #13  (E1x #3 ) energy= 0.224880165145779  | 0.224574287686544  | 0.225186042605012  occ= 0
MO #14  (A1  #8 ) energy= 0.376685416746985  | 0.374078720748573  | 0.379292112744854  occ= 0
MO #15  (E2x #1 ) energy= 0.474869969525916  | 0.470128978077385  | 0.479610960974448  occ= 0
MO #16  (E2y #1 ) energy= 0.474869969525916  | 0.470128978077385  | 0.479610960974448  occ= 0
MO #17  (A1  #9 ) energy= 0.523375517571011  | 0.519741400433513  | 0.52700963470843   occ= 0
MO #18  (E1y #4 ) energy= 0.556977292930476  | 0.551385644094827  | 0.562568941766123  occ= 0
MO #19  (E1x #4 ) energy= 0.56266983582413   | 0.561908412309341  | 0.563431259338914  occ= 0
MO #20  (E1y #5 ) energy= 0.626790618621354  | 0.614619007151749  | 0.638962230090945  occ= 0
MO #21  (E1x #5 ) energy= 0.628877837328787  | 0.627430555974025  | 0.630325118683542  occ= 0
MO #22  (A1  #10) energy= 0.649469306890735  | 0.648800803240464  | 0.650137810540962  occ= 0
MO #23  (E2x #2 ) energy= 0.672369267892967  | 0.671546040308806  | 0.673192495477126  occ= 0
MO #24  (E2y #2 ) energy= 0.672369267892982  | 0.67154604030882   | 0.673192495477139  occ= 0
MO #25  (A1  #11) energy= 0.702865324067882  | 0.69844011365099   | 0.707290534484235  occ= 0
MO #26  (E1y #6 ) energy= 0.739904390604014  | 0.722284641673534  | 0.757524139534492  occ= 0
MO #27  (E1x #6 ) energy= 0.746172052543806  | 0.744018568926153  | 0.748325536161461  occ= 0
MO #28  (A1  #12) energy= 0.860824521471132  | 0.855357556060018  | 0.866291486881502  occ= 0
MO #29  (E1y #7 ) energy= 1.22081599148521   | 1.20233910653015   | 1.23929287644026   occ= 0
MO #30  (E1x #7 ) energy= 1.22681446357375   | 1.22438797308766   | 1.22924095405983   occ= 0
MO #31  (A1  #13) energy= 1.25172987496597   | 1.24203949981109   | 1.26142025012012   occ= 0
MO #32  (E3x #1 ) energy= 1.3306246582707    | 1.32599860258633   | 1.33525071395506   occ= 0
MO #33  (E3y #1 ) energy= 1.3306246582707    | 1.32599860258633   | 1.33525071395506   occ= 0
MO #34  (E2x #3 ) energy= 1.50280930144735   | 1.482477805572     | 1.5231407973227    occ= 0
MO #35  (E2y #3 ) energy= 1.50280930144735   | 1.482477805572     | 1.5231407973227    occ= 0
MO #36  (A1  #14) energy= 1.52637338555826   | 1.52293713210011   | 1.52980963901642   occ= 0
MO #37  (E1y #8 ) energy= 1.53688976476356   | 1.53085377992721   | 1.5429257495999    occ= 0
MO #38  (E1x #8 ) energy= 1.54913005148469   | 1.54800594178018   | 1.5502541611892    occ= 0
MO #39  (E2x #4 ) energy= 1.60691732565052   | 1.59913787329351   | 1.61469677800752   occ= 0
MO #40  (E2y #4 ) energy= 1.60691732565053   | 1.59913787329352   | 1.61469677800754   occ= 0
MO #41  (A1  #15) energy= 1.62974552553739   | 1.62717829770931   | 1.63231275336543   occ= 0
MO #42  (E1y #9 ) energy= 1.68222636550674   | 1.67190068090591   | 1.69255205010754   occ= 0
MO #43  (E1x #9 ) energy= 1.69168657412817   | 1.69014426998114   | 1.69322887827522   occ= 0
MO #44  (A1  #16) energy= 1.71172405663981   | 1.70370046276787   | 1.7197476505113    occ= 0
MO #45  (E3x #2 ) energy= 1.74340072177506   | 1.74217035944753   | 1.74463108410258   occ= 0
MO #46  (E3y #2 ) energy= 1.74340072177505   | 1.74217035944753   | 1.74463108410258   occ= 0
MO #47  (E2x #5 ) energy= 1.81642296418643   | 1.81361936088839   | 1.81922656748448   occ= 0
MO #48  (E2y #5 ) energy= 1.81642296418643   | 1.81361936088838   | 1.81922656748449   occ= 0
MO #49  (A1  #17) energy= 1.85295420673822   | 1.84931705182396   | 1.85659136165136   occ= 0
MO #50  (E1y #10) energy= 2.02337529959947   | 2.00619883125291   | 2.040551767946     occ= 0
MO #51  (E1x #10) energy= 2.03272855475556   | 2.03032123060968   | 2.03513587890148   occ= 0
MO #52  (A1  #18) energy= 2.60483533149818   | 2.60131308181798   | 2.60835758117806   occ= 0
MO #53  (E1y #11) energy= 2.83279522765815   | 2.79213690299867   | 2.87345355231762   occ= 0
MO #54  (E1x #11) energy= 2.84658649661822   | 2.84071233494844   | 2.852460658288     occ= 0
MO #55  (E1y #12) energy= 3.07719694861866   | 3.06895224992717   | 3.08544164731014   occ= 0
MO #56  (E1x #12) energy= 3.09106451752865   | 3.08959955980592   | 3.09252947525138   occ= 0
MO #57  (A1  #19) energy= 3.14753190001505   | 3.14241088411798   | 3.1526529159119    occ= 0
MO #58  (E2x #6 ) energy= 3.20674117787207   | 3.20145373311363   | 3.21202862263051   occ= 0
MO #59  (E2y #6 ) energy= 3.20674117787206   | 3.20145373311362   | 3.21202862263051   occ= 0
MO #60  (A1  #20) energy= 3.5128794456994    | 3.50465113611036   | 3.52110775528581   occ= 0
MO #61  (E4x #1 ) energy= 3.65024331868647   | 3.6430779259212    | 3.65740871145175   occ= 0
MO #62  (E4y #1 ) energy= 3.65024331868648   | 3.64307792592121   | 3.65740871145176   occ= 0
MO #63  (E1y #13) energy= 3.72624647783779   | 3.6992306176559    | 3.75326233801963   occ= 0
MO #64  (E1x #13) energy= 3.74927098488909   | 3.74464292914327   | 3.75389904063491   occ= 0
MO #65  (E3x #3 ) energy= 3.97811635009497   | 3.96688553196237   | 3.98934716822758   occ= 0
MO #66  (E3y #3 ) energy= 3.97811635009498   | 3.96688553196237   | 3.98934716822758   occ= 0
MO #67  (A1  #21) energy= 4.06883948008827   | 4.060998465157     | 4.07668049501942   occ= 0
MO #68  (E1y #14) energy= 4.07522685388324   | 4.06356220660896   | 4.08689150115752   occ= 0
MO #69  (E1x #14) energy= 4.10073742964945   | 4.09844623653393   | 4.10302862276496   occ= 0
MO #70  (E3x #4 ) energy= 4.10302659556819   | 4.09071221748281   | 4.11534097365356   occ= 0
MO #71  (E3y #4 ) energy= 4.10302659556819   | 4.09071221748281   | 4.11534097365356   occ= 0
MO #72  (E2x #7 ) energy= 4.11524589137771   | 4.10830999079537   | 4.12218179196006   occ= 0
MO #73  (E2y #7 ) energy= 4.11524589137771   | 4.10830999079537   | 4.12218179196007   occ= 0
MO #74  (A1  #22) energy= 4.14428852284327   | 4.13295884578619   | 4.15561819989994   occ= 0
MO #75  (E2x #8 ) energy= 4.34812525748382   | 4.31068403295973   | 4.38556648200793   occ= 0
MO #76  (E2y #8 ) energy= 4.3481252574838    | 4.31068403295972   | 4.38556648200791   occ= 0
MO #77  (A1  #23) energy= 4.70289053000872   | 4.69445300783674   | 4.71132805218066   occ= 0
MO #78  (E1y #15) energy= 4.91761329313276   | 4.90261200605013   | 4.93261458021538   occ= 0
MO #79  (E2x #9 ) energy= 4.93682439074014   | 4.92687994275019   | 4.9467688387301    occ= 0
MO #80  (E2y #9 ) energy= 4.93682439074006   | 4.92687994275011   | 4.94676883873003   occ= 0
MO #81  (E1x #15) energy= 4.94392724177114   | 4.94077312566866   | 4.94708135787364   occ= 0
MO #82  (A1  #24) energy= 5.19489347597533   | 5.1885036338441    | 5.20128331810671   occ= 0
MO #83  (E1y #16) energy= 6.00369220625689   | 5.98168976596145   | 6.02569464655234   occ= 0
MO #84  (E1x #16) energy= 6.02982768597846   | 6.0258042732743    | 6.03385109868259   occ= 0
MO #85  (A1  #25) energy= 6.34368316232922   | 6.33265879958315   | 6.35470752507462   occ= 0
MO #86  (E3x #5 ) energy= 6.86073387392851   | 6.85830844792959   | 6.86315929992744   occ= 0
MO #87  (E3y #5 ) energy= 6.86073387392851   | 6.85830844792958   | 6.86315929992743   occ= 0
MO #88  (E1y #17) energy= 7.75221756349669   | 7.74770504238604   | 7.75673008460734   occ= 0
MO #89  (E1x #17) energy= 7.76485460192075   | 7.76400515452031   | 7.76570404932117   occ= 0
MO #90  (A1  #26) energy= 8.17119473799891   | 8.16992106097946   | 8.17246841501825   occ= 0
MO #91  (E2x #10) energy= 8.25551649241198   | 8.25349328543572   | 8.25753969938825   occ= 0
MO #92  (E2y #10) energy= 8.25551649241191   | 8.25349328543564   | 8.25753969938819   occ= 0
MO #93  (A1  #27) energy= 8.64768777928899   | 8.64242385767366   | 8.65295170090407   occ= 0
MO #94  (E2x #11) energy= 8.66254602456372   | 8.65778456623985   | 8.66730748288759   occ= 0
MO #95  (E2y #11) energy= 8.66254602456372   | 8.65778456623985   | 8.66730748288759   occ= 0
MO #96  (E1y #18) energy= 8.67836950733438   | 8.67359655480971   | 8.68314245985904   occ= 0
MO #97  (E1x #18) energy= 8.69743451087673   | 8.69626809985489   | 8.69860092189851   occ= 0
MO #98  (A1  #28) energy= 10.0809524922356   | 10.0779374929612   | 10.08396749151     occ= 0
MO #99  (E1y #19) energy= 10.174666639824    | 10.1563977753205   | 10.1929355043276   occ= 0
MO #100 (E1x #19) energy= 10.1958443032297   | 10.1928331484129   | 10.1988554580465   occ= 0
MO #101 (A1  #29) energy= 10.4340821974352   | 10.426488228548    | 10.4416761663226   occ= 0
MO #102 (E4x #2 ) energy= 10.6094252322709   | 10.5931943089392   | 10.6256561556026   occ= 0
MO #103 (E4y #2 ) energy= 10.6094252322709   | 10.5931943089392   | 10.6256561556026   occ= 0
MO #104 (E3x #6 ) energy= 10.841581392739    | 10.8288893776969   | 10.8542734077812   occ= 0
MO #105 (E3y #6 ) energy= 10.841581392739    | 10.8288893776969   | 10.8542734077812   occ= 0
MO #106 (E1y #20) energy= 11.0279608505642   | 10.9918336675024   | 11.0640880336261   occ= 0
MO #107 (E1x #20) energy= 11.0682066094024   | 11.0612155769166   | 11.0751976418882   occ= 0
MO #108 (E2x #12) energy= 11.4800738844012   | 11.4694862207895   | 11.4906615480129   occ= 0
MO #109 (E2y #12) energy= 11.4800738844012   | 11.4694862207895   | 11.4906615480129   occ= 0
MO #110 (E1y #21) energy= 11.5598803553712   | 11.5469628944342   | 11.5727978163081   occ= 0
MO #111 (E1x #21) energy= 11.6024220425988   | 11.599114452043    | 11.6057296331545   occ= 0
MO #112 (A1  #30) energy= 11.6983898711602   | 11.6877523751886   | 11.7090273671317   occ= 0
MO #113 (E3x #7 ) energy= 11.8642841873847   | 11.8384632453739   | 11.8901051293956   occ= 0
MO #114 (E3y #7 ) energy= 11.8642841873847   | 11.8384632453739   | 11.8901051293956   occ= 0
MO #115 (E2x #13) energy= 12.1633427791702   | 12.1443358351828   | 12.1823497231576   occ= 0
MO #116 (E2y #13) energy= 12.1633427791702   | 12.1443358351828   | 12.1823497231576   occ= 0
MO #117 (E2x #14) energy= 12.9747682134363   | 12.9471566180547   | 13.0023798088179   occ= 0
MO #118 (E2y #14) energy= 12.9747682134363   | 12.9471566180547   | 13.0023798088179   occ= 0
MO #119 (A1  #31) energy= 13.3081598897739   | 13.2998724388305   | 13.3164473407167   occ= 0
MO #120 (E1y #22) energy= 13.5208237121247   | 13.496890719483    | 13.5447567047665   occ= 0
MO #121 (E1x #22) energy= 13.5584463688735   | 13.5538075212531   | 13.5630852164939   occ= 0
MO #122 (E1y #23) energy= 15.8037815133476   | 15.7870925664585   | 15.8204704602367   occ= 0
MO #123 (A1  #32) energy= 15.8119619270222   | 15.8062095351407   | 15.8177143189038   occ= 0
MO #124 (E1x #23) energy= 15.8386196410359   | 15.8350584869764   | 15.8421807950954   occ= 0
MO #125 (A1  #33) energy= 17.1539158094802   | 17.1479774630311   | 17.1598541559296   occ= 0
MO #126 (A1  #34) energy= 44.7440097901399   | 44.7348592553025   | 44.753160324986    occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.74537
pop of  0 O 3s        0.00588
pop of  0 O 4s        0.00173
pop of  0 O 5s        0.00012
pop of  0 O 6s        0.00001
pop of  0 O 2px       1.99212
pop of  0 O 2py       0.99658
pop of  0 O 2pz       1.60534
pop of  0 O 3px       0.00072
pop of  0 O 3py       0.00016
pop of  0 O 3pz       0.00350
pop of  0 O 4px       0.00045
pop of  0 O 4py       0.00042
pop of  0 O 4pz       0.00202
pop of  0 O 5px       0.00007
pop of  0 O 5py       0.00001
pop of  0 O 5pz       0.00022
pop of  0 O 6px       0.00001
pop of  0 O 6py       0.00000
pop of  0 O 6pz       0.00015
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00123
pop of  0 O 3dz^2     0.01423
pop of  0 O 3dxz      0.00262
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00014
pop of  0 O 4dz^2     0.00047
pop of  0 O 4dxz      0.00030
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00001
pop of  0 O 5dz^2     0.00028
pop of  0 O 5dxz      0.00002
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00000
pop of  0 O 6dz^2     0.00003
pop of  0 O 6dxz      0.00001
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00002
pop of  0 O 4f 0      0.00187
pop of  0 O 4f 1      0.00023
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00001
pop of  0 O 5f 0      0.00005
pop of  0 O 5f 1      0.00003
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00000
pop of  0 O 6f 0      0.00014
pop of  0 O 6f 1      0.00000
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00002
pop of  0 O 5g 0      0.00058
pop of  0 O 5g 1      0.00004
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00000
pop of  0 O 6g 0      0.00002
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.58770
pop of  1 H 2s        0.01616
pop of  1 H 3s        0.00992
pop of  1 H 4s        0.00045
pop of  1 H 5s        0.00013
pop of  1 H 2px       0.00299
pop of  1 H 2py       0.00058
pop of  1 H 2pz       0.00048
pop of  1 H 3px       0.00006
pop of  1 H 3py       0.00056
pop of  1 H 3pz       0.00001
pop of  1 H 4px       0.00000
pop of  1 H 4py       0.00007
pop of  1 H 4pz       0.00059
pop of  1 H 5px       0.00001
pop of  1 H 5py       0.00001
pop of  1 H 5pz       0.00002
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00001
pop of  1 H 3dz^2     0.00078
pop of  1 H 3dxz      0.00000
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00007
pop of  1 H 4dz^2     0.00033
pop of  1 H 4dxz      0.00008
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00004
pop of  1 H 5dz^2     0.00038
pop of  1 H 5dxz      0.00000
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00000
pop of  1 H 4f 0      0.00031
pop of  1 H 4f 1      0.00008
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00006
pop of  1 H 5f 0      0.00074
pop of  1 H 5f 1      0.00017
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.37719
charge of  1H =      0.37719
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.64107
#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.82)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab21.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 20:45:09 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       295.04

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmploaxit2j
max_memory 4000 MB (current use 569 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_0.82/tmploaxit2j
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 569 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.249164942405815  LUMO = 0.575227400227334
Initial guess E= -75.3970767883048  |g|= 0.00120519
macro= 0  E= -75.3970774044954  delta_E= -6.16191e-07  |g|= 0.00120519  1 KF 4 JK
macro= 1  E= -75.3970774044954  delta_E= -2.84217e-14  |g|= 1.27892e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3970774044954  |g|= 1.27892e-07  total 3 KF 9 JK
converged SCF energy = -75.3970774044954
u+d contributions  -0.008141715367487265
uu+dd contributions  -0.04192385775547257
ud contributions  -0.15308598516929656
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
after tapering qubits(H) =  6
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008141833545404289
uu+dd contributions  -0.04192365148657888
ud contributions  -0.15307252043549957
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008134649209514507
uu+dd contributions  -0.041985950701933304
ud contributions  -0.15349222432274529
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008134649209514507
uu+dd contributions  -0.041985950701933304
ud contributions  -0.15349222432274529
