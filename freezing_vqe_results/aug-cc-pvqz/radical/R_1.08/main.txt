#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.08)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab22.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 22:18:13 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   1.080000000000 AA    0.000000000000   0.000000000000   2.040904214530 Bohr

nuclear repulsion = 3.919831192
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         4.28
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmpl45tbxf3
max_memory 4000 MB (current use 272 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmpl45tbxf3
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 272 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.421065567478062  LUMO (A1) = 0.0203729516267078
Initial guess E= -75.3940541705089  |g|= 0.21761
macro= 0  E= -75.4059243095909  delta_E= -0.0118701  |g|= 0.21761  2 KF 5 JK
macro= 1  E= -75.4061848244279  delta_E= -0.000260515  |g|= 0.0916281  2 KF 5 JK
macro= 2  E= -75.4046577895873  delta_E= 0.00152703  |g|= 0.0623215  2 KF 5 JK
macro= 3  E= -75.4059892752755  delta_E= -0.00133149  |g|= 0.11118  2 KF 5 JK
macro= 4  E= -75.4046761346513  delta_E= 0.00131314  |g|= 0.0625507  2 KF 5 JK
macro= 5  E= -75.4060369163351  delta_E= -0.00136078  |g|= 0.110029  2 KF 5 JK
macro= 6  E= -75.404715609937  delta_E= 0.00132131  |g|= 0.0634262  2 KF 5 JK
macro= 7  E= -75.4060543290049  delta_E= -0.00133872  |g|= 0.109845  2 KF 5 JK
macro= 8  E= -75.4046499715427  delta_E= 0.00140436  |g|= 0.0630707  2 KF 5 JK
macro= 9  E= -75.4060571475314  delta_E= -0.00140718  |g|= 0.111023  2 KF 5 JK
macro= 10  E= -75.4046437868985  delta_E= 0.00141336  |g|= 0.0631  2 KF 5 JK
macro= 11  E= -75.4060646576187  delta_E= -0.00142087  |g|= 0.111149  2 KF 5 JK
macro= 12  E= -75.4046096430552  delta_E= 0.00145501  |g|= 0.0629308  2 KF 5 JK
macro= 13  E= -75.4060700013175  delta_E= -0.00146036  |g|= 0.111714  2 KF 5 JK
macro= 14  E= -75.4045885673581  delta_E= 0.00148143  |g|= 0.0628364  2 KF 5 JK
macro= 15  E= -75.4060763708488  delta_E= -0.0014878  |g|= 0.112054  2 KF 5 JK
macro= 16  E= -75.4045615822182  delta_E= 0.00151479  |g|= 0.0626896  2 KF 5 JK
macro= 17  E= -75.4060823086884  delta_E= -0.00152073  |g|= 0.112481  2 KF 5 JK
macro= 18  E= -75.4045375879053  delta_E= 0.00154472  |g|= 0.0625582  2 KF 5 JK
macro= 19  E= -75.4060884903576  delta_E= -0.0015509  |g|= 0.112856  2 KF 5 JK
macro= 20  E= -75.4045125070507  delta_E= 0.00157598  |g|= 0.0624113  2 KF 5 JK
macro= 21  E= -75.4060945932063  delta_E= -0.00158209  |g|= 0.113241  2 KF 5 JK
macro= 22  E= -75.4044882696076  delta_E= 0.00160632  |g|= 0.0622647  2 KF 5 JK
macro= 23  E= -75.406100755703  delta_E= -0.00161249  |g|= 0.113609  2 KF 5 JK
macro= 24  E= -75.4044640305085  delta_E= 0.00163673  |g|= 0.0621113  2 KF 5 JK
macro= 25  E= -75.4061069032974  delta_E= -0.00164287  |g|= 0.113971  2 KF 5 JK
macro= 26  E= -75.404440217195  delta_E= 0.00166669  |g|= 0.0619548  2 KF 5 JK
macro= 27  E= -75.4061130587602  delta_E= -0.00167284  |g|= 0.114323  2 KF 5 JK
macro= 28  E= -75.4044166716865  delta_E= 0.00169639  |g|= 0.0617937  2 KF 5 JK
macro= 29  E= -75.4061192004262  delta_E= -0.00170253  |g|= 0.114666  2 KF 5 JK
macro= 30  E= -75.4043934998924  delta_E= 0.0017257  |g|= 0.0616292  2 KF 5 JK
macro= 31  E= -75.406125326684  delta_E= -0.00173183  |g|= 0.115  2 KF 5 JK
macro= 32  E= -75.4043706848801  delta_E= 0.00175464  |g|= 0.061461  2 KF 5 JK
macro= 33  E= -75.4061314269495  delta_E= -0.00176074  |g|= 0.115324  2 KF 5 JK
macro= 34  E= -75.4043482622143  delta_E= 0.00178316  |g|= 0.0612897  2 KF 5 JK
macro= 35  E= -75.4061374947604  delta_E= -0.00178923  |g|= 0.115639  2 KF 5 JK
macro= 36  E= -75.4043262407822  delta_E= 0.00181125  |g|= 0.0611155  2 KF 5 JK
macro= 37  E= -75.4061435220232  delta_E= -0.00181728  |g|= 0.115945  2 KF 5 JK
macro= 38  E= -75.4043046384405  delta_E= 0.00183888  |g|= 0.0609386  2 KF 5 JK
macro= 39  E= -75.4061495016296  delta_E= -0.00184486  |g|= 0.116242  2 KF 5 JK
macro= 40  E= -75.4042834660987  delta_E= 0.00186604  |g|= 0.0607594  2 KF 5 JK
macro= 41  E= -75.4061554263771  delta_E= -0.00187196  |g|= 0.116529  2 KF 5 JK
macro= 42  E= -75.4042627349041  delta_E= 0.00189269  |g|= 0.0605781  2 KF 5 JK
macro= 43  E= -75.4061612895038  delta_E= -0.00189855  |g|= 0.116807  2 KF 5 JK
macro= 44  E= -75.4042424531378  delta_E= 0.00191884  |g|= 0.0603952  2 KF 5 JK
macro= 45  E= -75.4039531663118  delta_E= 0.000289287  |g|= 0.117077  2 KF 5 JK
macro= 46  E= -75.4053677244273  delta_E= -0.00141456  |g|= 0.103504  2 KF 5 JK
macro= 47  E= -75.403753549595  delta_E= 0.00161417  |g|= 0.0983518  2 KF 5 JK
macro= 48  E= -75.4052026592192  delta_E= -0.00144911  |g|= 0.105773  2 KF 5 JK
macro= 49  E= -75.4036792707185  delta_E= 0.00152339  |g|= 0.102141  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4036792707185  |g|= 0.102141  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4036792707185

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmpl45tbxf3
max_memory 4000 MB (current use 545 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmpl45tbxf3
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 545 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.279599750778511  LUMO (A1) = 0.02615148319319
Initial guess E= -75.406722586082  |g|= 0.0782559
macro= 0  E= -75.4077352079354  delta_E= -0.00101262  |g|= 0.0782559  2 KF 5 JK
macro= 1  E= -75.4077535200041  delta_E= -1.83121e-05  |g|= 0.0226597  2 KF 5 JK
macro= 2  E= -75.4075775262953  delta_E= 0.000175994  |g|= 0.0157821  2 KF 5 JK
macro= 3  E= -75.4077551905306  delta_E= -0.000177664  |g|= 0.0334598  2 KF 5 JK
macro= 4  E= -75.4076163693343  delta_E= 0.000138821  |g|= 0.0118989  2 KF 5 JK
macro= 5  E= -75.4077473709158  delta_E= -0.000131002  |g|= 0.0303959  2 KF 5 JK
macro= 6  E= -75.4075908034506  delta_E= 0.000156567  |g|= 0.0178233  2 KF 5 JK
macro= 7  E= -75.4077375390403  delta_E= -0.000146736  |g|= 0.0324815  2 KF 5 JK
macro= 8  E= -75.4076709261174  delta_E= 6.66129e-05  |g|= 0.0168916  2 KF 5 JK
macro= 9  E= -75.407740763615  delta_E= -6.98375e-05  |g|= 0.0270756  2 KF 5 JK
macro= 10  E= -75.4076547123496  delta_E= 8.60513e-05  |g|= 0.0156766  2 KF 5 JK
macro= 11  E= -75.4077404070308  delta_E= -8.56947e-05  |g|= 0.0277286  2 KF 5 JK
macro= 12  E= -75.4076524559412  delta_E= 8.79511e-05  |g|= 0.0161151  2 KF 5 JK
macro= 13  E= -75.4077407019544  delta_E= -8.8246e-05  |g|= 0.0279105  2 KF 5 JK
macro= 14  E= -75.4076503369184  delta_E= 9.0365e-05  |g|= 0.0161853  2 KF 5 JK
macro= 15  E= -75.4077408966779  delta_E= -9.05598e-05  |g|= 0.0280854  2 KF 5 JK
macro= 16  E= -75.4076495309535  delta_E= 9.13657e-05  |g|= 0.0162276  2 KF 5 JK
macro= 17  E= -75.4077409807058  delta_E= -9.14498e-05  |g|= 0.0281641  2 KF 5 JK
macro= 18  E= -75.4076493360419  delta_E= 9.16447e-05  |g|= 0.0162317  2 KF 5 JK
macro= 19  E= -75.4077410220929  delta_E= -9.16861e-05  |g|= 0.0281924  2 KF 5 JK
macro= 20  E= -75.4076492721798  delta_E= 9.17499e-05  |g|= 0.0162217  2 KF 5 JK
macro= 21  E= -75.4077410638892  delta_E= -9.17917e-05  |g|= 0.0282072  2 KF 5 JK
macro= 22  E= -75.4076491657069  delta_E= 9.18982e-05  |g|= 0.0162106  2 KF 5 JK
macro= 23  E= -75.407741114793  delta_E= -9.19491e-05  |g|= 0.0282233  2 KF 5 JK
macro= 24  E= -75.4076490086651  delta_E= 9.21061e-05  |g|= 0.0162015  2 KF 5 JK
macro= 25  E= -75.4077411712415  delta_E= -9.21626e-05  |g|= 0.0282426  2 KF 5 JK
macro= 26  E= -75.4076488297803  delta_E= 9.23415e-05  |g|= 0.016194  2 KF 5 JK
macro= 27  E= -75.4077412294588  delta_E= -9.23997e-05  |g|= 0.0282635  2 KF 5 JK
macro= 28  E= -75.4076486469452  delta_E= 9.25825e-05  |g|= 0.0161869  2 KF 5 JK
macro= 29  E= -75.4077412879036  delta_E= -9.2641e-05  |g|= 0.0282848  2 KF 5 JK
macro= 30  E= -75.4076484650456  delta_E= 9.28229e-05  |g|= 0.0161796  2 KF 5 JK
macro= 31  E= -75.4077413463939  delta_E= -9.28813e-05  |g|= 0.028306  2 KF 5 JK
macro= 32  E= -75.407648283558  delta_E= 9.30628e-05  |g|= 0.0161721  2 KF 5 JK
macro= 33  E= -75.4077414051174  delta_E= -9.31216e-05  |g|= 0.0283272  2 KF 5 JK
macro= 34  E= -75.4076481012899  delta_E= 9.33038e-05  |g|= 0.0161645  2 KF 5 JK
macro= 35  E= -75.4077414642116  delta_E= -9.33629e-05  |g|= 0.0283484  2 KF 5 JK
macro= 36  E= -75.4076479176872  delta_E= 9.35465e-05  |g|= 0.0161567  2 KF 5 JK
macro= 37  E= -75.4077415237112  delta_E= -9.3606e-05  |g|= 0.0283698  2 KF 5 JK
macro= 38  E= -75.407647732686  delta_E= 9.3791e-05  |g|= 0.0161487  2 KF 5 JK
macro= 39  E= -75.4077415836007  delta_E= -9.38509e-05  |g|= 0.0283912  2 KF 5 JK
macro= 40  E= -75.4076475463797  delta_E= 9.40372e-05  |g|= 0.0161407  2 KF 5 JK
macro= 41  E= -75.4077416438568  delta_E= -9.40975e-05  |g|= 0.0284127  2 KF 5 JK
macro= 42  E= -75.4076473588583  delta_E= 9.4285e-05  |g|= 0.0161324  2 KF 5 JK
macro= 43  E= -75.4077417044595  delta_E= -9.43456e-05  |g|= 0.0284342  2 KF 5 JK
macro= 44  E= -75.4076471701794  delta_E= 9.45343e-05  |g|= 0.0161241  2 KF 5 JK
macro= 45  E= -75.4077417653937  delta_E= -9.45952e-05  |g|= 0.0284559  2 KF 5 JK
macro= 46  E= -75.4076469803822  delta_E= 9.4785e-05  |g|= 0.0161156  2 KF 5 JK
macro= 47  E= -75.4077418266471  delta_E= -9.48463e-05  |g|= 0.0284776  2 KF 5 JK
macro= 48  E= -75.407646789503  delta_E= 9.50371e-05  |g|= 0.016107  2 KF 5 JK
macro= 49  E= -75.4077418882055  delta_E= -9.50987e-05  |g|= 0.0284993  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4077418882055  |g|= 0.0284993  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4077418882055
**** SCF Summaries ****
Total Energy =                         -75.407741888205550
Nuclear Repulsion Energy =               3.919831192000001
One-electron Energy =                 -111.846262691732846
Two-electron Energy =                   32.518689611527293
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    1    0    0    0    0    0    0    0
single occ                     0    0    1    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6347879610457  | -20.6517671771742  | -20.6178087449172  occ= 2
MO #2   (A1  #2 ) energy= -1.28021955498497  | -1.35235597042463  | -1.20808313954532  occ= 2
MO #3   (A1  #3 ) energy= -0.632202991698712 | -0.650909957913657 | -0.613496025483766 occ= 2
MO #4   (E1x #1 ) energy= -0.535178969830106 | -0.554376786654551 | -0.51598115300566  occ= 2
MO #5   (E1y #1 ) energy= -0.24544131561345  | -0.644104513559124 | 0.153221882332226  occ= 1
MO #6   (A1  #4 ) energy= 0.0266590042851727 | 0.0259963946880844 | 0.0273216138822589 occ= 0
MO #7   (A1  #5 ) energy= 0.112088742290203  | 0.111111375667152  | 0.113066108913264  occ= 0
MO #8   (E1y #2 ) energy= 0.137203373740705  | 0.133016917285166  | 0.141389830196244  occ= 0
MO #9   (E1x #2 ) energy= 0.140978500813481  | 0.140387754603221  | 0.141569247023741  occ= 0
MO #10  (A1  #6 ) energy= 0.157104755873069  | 0.155127516502495  | 0.159081995243629  occ= 0
MO #11  (E1y #3 ) energy= 0.211120214367323  | 0.209603864174697  | 0.212636564559942  occ= 0
MO #12  (E1x #3 ) energy= 0.213840350328801  | 0.213638598772611  | 0.21404210188499   occ= 0
MO #13  (A1  #7 ) energy= 0.222673111031575  | 0.220920991720093  | 0.224425230343037  occ= 0
MO #14  (A1  #8 ) energy= 0.327524226421406  | 0.323946751392628  | 0.331101701450196  occ= 0
MO #15  (E2x #1 ) energy= 0.478650640535604  | 0.473802202728686  | 0.483499078342523  occ= 0
MO #16  (E2y #1 ) energy= 0.478650640535602  | 0.473802202728683  | 0.483499078342521  occ= 0
MO #17  (A1  #9 ) energy= 0.498093855175412  | 0.4948322112322    | 0.501355499118579  occ= 0
MO #18  (E1y #4 ) energy= 0.543981149151122  | 0.538838114146858  | 0.549124184155375  occ= 0
MO #19  (E1x #4 ) energy= 0.548594408907977  | 0.547912213289957  | 0.549276604525996  occ= 0
MO #20  (A1  #10) energy= 0.632983341181176  | 0.631399705644226  | 0.63456697671803   occ= 0
MO #21  (E1y #5 ) energy= 0.649310983785916  | 0.637251439598099  | 0.661370527973729  occ= 0
MO #22  (E1x #5 ) energy= 0.652417426338371  | 0.650924255987243  | 0.653910596689492  occ= 0
MO #23  (E2x #2 ) energy= 0.687387212868633  | 0.686815767975102  | 0.687958657762164  occ= 0
MO #24  (E2y #2 ) energy= 0.687387212868635  | 0.686815767975103  | 0.687958657762164  occ= 0
MO #25  (A1  #11) energy= 0.701356160102752  | 0.697590656443601  | 0.705121663761972  occ= 0
MO #26  (E1y #6 ) energy= 0.757298570940998  | 0.734260789948039  | 0.780336351933959  occ= 0
MO #27  (E1x #6 ) energy= 0.762283701390573  | 0.759508624915345  | 0.765058777865803  occ= 0
MO #28  (A1  #12) energy= 0.783194274322368  | 0.779158419141647  | 0.787230129503004  occ= 0
MO #29  (E1y #7 ) energy= 1.11885030625529   | 1.10934990641103   | 1.12835070609954   occ= 0
MO #30  (E1x #7 ) energy= 1.12515138471227   | 1.12385754730901   | 1.12644522211551   occ= 0
MO #31  (A1  #13) energy= 1.21944470079564   | 1.21098517403477   | 1.22790422755616   occ= 0
MO #32  (E3x #1 ) energy= 1.32350952662044   | 1.31908407663132   | 1.32793497660956   occ= 0
MO #33  (E3y #1 ) energy= 1.32350952662044   | 1.31908407663132   | 1.32793497660955   occ= 0
MO #34  (A1  #14) energy= 1.40528936421098   | 1.39971711996487   | 1.41086160845713   occ= 0
MO #35  (E2x #3 ) energy= 1.49846658855524   | 1.47507989301922   | 1.52185328409125   occ= 0
MO #36  (E2y #3 ) energy= 1.49846658855524   | 1.47507989301922   | 1.52185328409125   occ= 0
MO #37  (E1y #8 ) energy= 1.53952433892185   | 1.53060069140726   | 1.54844798643644   occ= 0
MO #38  (E1x #8 ) energy= 1.55345644534508   | 1.55192351608435   | 1.55498937460579   occ= 0
MO #39  (E2x #4 ) energy= 1.56159761275482   | 1.55794588764313   | 1.56524933786651   occ= 0
MO #40  (E2y #4 ) energy= 1.56159761275481   | 1.55794588764313   | 1.5652493378665    occ= 0
MO #41  (A1  #15) energy= 1.61146385823194   | 1.60761095940305   | 1.61531675706084   occ= 0
MO #42  (A1  #16) energy= 1.67991925632213   | 1.67782871938877   | 1.68200979325443   occ= 0
MO #43  (E3x #2 ) energy= 1.70419321244132   | 1.70295527233547   | 1.70543115254718   occ= 0
MO #44  (E3y #2 ) energy= 1.70419321244132   | 1.70295527233547   | 1.70543115254718   occ= 0
MO #45  (E1y #9 ) energy= 1.73465722697951   | 1.72422697863192   | 1.74508747532709   occ= 0
MO #46  (E1x #9 ) energy= 1.74064532491236   | 1.73919044026834   | 1.74210020955637   occ= 0
MO #47  (E2x #5 ) energy= 1.90808395039272   | 1.9046119015411    | 1.91155599924435   occ= 0
MO #48  (E2y #5 ) energy= 1.90808395039272   | 1.90461190154109   | 1.91155599924434   occ= 0
MO #49  (A1  #17) energy= 1.9488524495477    | 1.94470956340333   | 1.9529953356916    occ= 0
MO #50  (E1y #10) energy= 2.10074849718686   | 2.08688422233091   | 2.1146127720428    occ= 0
MO #51  (E1x #10) energy= 2.1132707832454    | 2.11097571640525   | 2.11556585008553   occ= 0
MO #52  (A1  #18) energy= 2.29991954286218   | 2.29460388077657   | 2.30523520494778   occ= 0
MO #53  (E1y #11) energy= 2.58936010058372   | 2.54619560524779   | 2.63252459591966   occ= 0
MO #54  (E1x #11) energy= 2.59849055268175   | 2.59271848317744   | 2.60426262218607   occ= 0
MO #55  (E2x #6 ) energy= 2.79957898605816   | 2.79534519434988   | 2.80381277776643   occ= 0
MO #56  (E2y #6 ) energy= 2.79957898605815   | 2.79534519434988   | 2.80381277776644   occ= 0
MO #57  (E1y #12) energy= 2.87617425193989   | 2.87133420189208   | 2.88101430198769   occ= 0
MO #58  (E1x #12) energy= 2.88768138002703   | 2.88678331492022   | 2.88857944513385   occ= 0
MO #59  (A1  #19) energy= 2.99121503013622   | 2.98739820732354   | 2.99503185294878   occ= 0
MO #60  (A1  #20) energy= 3.52247103229451   | 3.5143172610464    | 3.53062480354172   occ= 0
MO #61  (E4x #1 ) energy= 3.65966546623276   | 3.65241780806097   | 3.66691312440455   occ= 0
MO #62  (E4y #1 ) energy= 3.65966546623277   | 3.65241780806097   | 3.66691312440456   occ= 0
MO #63  (E1y #13) energy= 3.74632341532971   | 3.72545012261087   | 3.76719670804854   occ= 0
MO #64  (E1x #13) energy= 3.76975586970291   | 3.76569667718021   | 3.77381506222561   occ= 0
MO #65  (E3x #3 ) energy= 3.86544347875519   | 3.85827125028173   | 3.87261570722865   occ= 0
MO #66  (E3y #3 ) energy= 3.8654434787552    | 3.85827125028174   | 3.87261570722866   occ= 0
MO #67  (A1  #21) energy= 3.97677686905312   | 3.96756235497818   | 3.98599138312754   occ= 0
MO #68  (E3x #4 ) energy= 4.08841067498826   | 4.07192468998746   | 4.10489665998907   occ= 0
MO #69  (E3y #4 ) energy= 4.08841067498826   | 4.07192468998745   | 4.10489665998907   occ= 0
MO #70  (E2x #7 ) energy= 4.17267705531178   | 4.16208382224055   | 4.18327028838301   occ= 0
MO #71  (E2y #7 ) energy= 4.17267705531177   | 4.16208382224055   | 4.183270288383     occ= 0
MO #72  (E1y #14) energy= 4.21382388636336   | 4.20049366438534   | 4.22715410834139   occ= 0
MO #73  (A1  #22) energy= 4.21989600565137   | 4.20712333533366   | 4.23266867596897   occ= 0
MO #74  (E2x #8 ) energy= 4.22835016100547   | 4.20307042562197   | 4.25362989638897   occ= 0
MO #75  (E2y #8 ) energy= 4.22835016100546   | 4.20307042562196   | 4.25362989638895   occ= 0
MO #76  (E1x #14) energy= 4.2382557138649    | 4.23594985697869   | 4.2405615707511    occ= 0
MO #77  (A1  #23) energy= 4.32331046937578   | 4.31793934562185   | 4.32868159312972   occ= 0
MO #78  (E1y #15) energy= 4.65507123880534   | 4.62697390112865   | 4.68316857648202   occ= 0
MO #79  (E1x #15) energy= 4.67874919178258   | 4.67382458828579   | 4.68367379527937   occ= 0
MO #80  (E2x #9 ) energy= 4.72210269064124   | 4.70272804399168   | 4.7414773372908    occ= 0
MO #81  (E2y #9 ) energy= 4.72210269064122   | 4.70272804399166   | 4.74147733729078   occ= 0
MO #82  (A1  #24) energy= 5.2329131306559    | 5.22685039851823   | 5.23897586279356   occ= 0
MO #83  (E1y #16) energy= 5.35270260988358   | 5.33766041280309   | 5.36774480696408   occ= 0
MO #84  (E1x #16) energy= 5.37772291536659   | 5.37476002205417   | 5.38068580867902   occ= 0
MO #85  (A1  #25) energy= 5.61959880932787   | 5.60802225557745   | 5.63117536307805   occ= 0
MO #86  (E3x #5 ) energy= 6.60753147339275   | 6.60658278070652   | 6.60848016607898   occ= 0
MO #87  (E3y #5 ) energy= 6.60753147339275   | 6.60658278070652   | 6.60848016607899   occ= 0
MO #88  (E2x #10) energy= 7.39192701476482   | 7.38955257186974   | 7.39430145765989   occ= 0
MO #89  (E2y #10) energy= 7.39192701476481   | 7.38955257186974   | 7.39430145765989   occ= 0
MO #90  (A1  #26) energy= 7.46465709237714   | 7.46219550297939   | 7.46711868177483   occ= 0
MO #91  (E1y #17) energy= 7.6811625855374    | 7.67814250291865   | 7.68418266815614   occ= 0
MO #92  (E1x #17) energy= 7.6913423106175    | 7.69068056257686   | 7.69200405865813   occ= 0
MO #93  (A1  #27) energy= 8.26656984951223   | 8.26459836317563   | 8.26854133584875   occ= 0
MO #94  (E2x #11) energy= 8.5100618574985    | 8.50931025162411   | 8.51081346337288   occ= 0
MO #95  (E2y #11) energy= 8.51006185749852   | 8.50931025162413   | 8.51081346337291   occ= 0
MO #96  (E1y #18) energy= 8.79206939414787   | 8.78913881377473   | 8.79499997452099   occ= 0
MO #97  (E1x #18) energy= 8.80191636539336   | 8.80131809662256   | 8.80251463416417   occ= 0
MO #98  (E1y #19) energy= 9.29260608979544   | 9.28529213806411   | 9.29992004152678   occ= 0
MO #99  (E1x #19) energy= 9.30980288518228   | 9.30816617049499   | 9.31143959986956   occ= 0
MO #100 (A1  #28) energy= 9.4891388622319    | 9.48629100760274   | 9.49198671686084   occ= 0
MO #101 (E4x #2 ) energy= 10.6132279882503   | 10.5969842548188   | 10.6294717216817   occ= 0
MO #102 (E4y #2 ) energy= 10.6132279882503   | 10.5969842548188   | 10.6294717216817   occ= 0
MO #103 (E3x #6 ) energy= 10.7190920228251   | 10.7064076745331   | 10.7317763711171   occ= 0
MO #104 (E3y #6 ) energy= 10.7190920228251   | 10.7064076745331   | 10.7317763711171   occ= 0
MO #105 (A1  #29) energy= 10.894238651496    | 10.8880997434623   | 10.9003775595295   occ= 0
MO #106 (E1y #20) energy= 10.919813650918    | 10.8779385231776   | 10.9616887786584   occ= 0
MO #107 (E1x #20) energy= 10.9576845836705   | 10.9501925834626   | 10.9651765838785   occ= 0
MO #108 (E2x #12) energy= 10.9987749659314   | 10.9888945459506   | 11.0086553859122   occ= 0
MO #109 (E2y #12) energy= 10.9987749659314   | 10.9888945459506   | 11.0086553859122   occ= 0
MO #110 (E1y #21) energy= 11.4259487405006   | 11.4112523648786   | 11.4406451161227   occ= 0
MO #111 (E1x #21) energy= 11.4665347216677   | 11.4632459062074   | 11.469823537128    occ= 0
MO #112 (A1  #30) energy= 11.4849832551635   | 11.4761508471689   | 11.4938156631581   occ= 0
MO #113 (A1  #31) energy= 11.8577455644078   | 11.8466202224739   | 11.8688709063418   occ= 0
MO #114 (E3x #7 ) energy= 11.8600392923714   | 11.8341730736849   | 11.8859055110579   occ= 0
MO #115 (E3y #7 ) energy= 11.8600392923714   | 11.8341730736849   | 11.8859055110579   occ= 0
MO #116 (E2x #13) energy= 11.9962203446974   | 11.9780782722231   | 12.0143624171717   occ= 0
MO #117 (E2y #13) energy= 11.9962203446974   | 11.9780782722231   | 12.0143624171717   occ= 0
MO #118 (E1y #22) energy= 12.4438550262974   | 12.4231992148571   | 12.4645108377377   occ= 0
MO #119 (E1x #22) energy= 12.4822878429242   | 12.4778450427684   | 12.4867306430801   occ= 0
MO #120 (E2x #14) energy= 12.7725003103588   | 12.741897835135    | 12.8031027855827   occ= 0
MO #121 (E2y #14) energy= 12.7725003103588   | 12.741897835135    | 12.8031027855827   occ= 0
MO #122 (A1  #32) energy= 13.6837016674965   | 13.678166858442    | 13.689236476551    occ= 0
MO #123 (E1y #23) energy= 13.6921095847228   | 13.6676705855745   | 13.7165485838711   occ= 0
MO #124 (E1x #23) energy= 13.7279726359186   | 13.7232203749341   | 13.7327248969031   occ= 0
MO #125 (A1  #33) energy= 15.87074634521     | 15.8645369003922   | 15.8769557900274   occ= 0
MO #126 (A1  #34) energy= 42.4594494921633   | 42.4495389526852   | 42.4693600316466   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.85948
pop of  0 O 3s        0.00311
pop of  0 O 4s        0.00100
pop of  0 O 5s        0.00023
pop of  0 O 6s        0.00005
pop of  0 O 2px       1.99289
pop of  0 O 2py       0.99736
pop of  0 O 2pz       1.47145
pop of  0 O 3px       0.00142
pop of  0 O 3py       0.00016
pop of  0 O 3pz       0.00056
pop of  0 O 4px       0.00047
pop of  0 O 4py       0.00060
pop of  0 O 4pz       0.00179
pop of  0 O 5px       0.00018
pop of  0 O 5py       0.00007
pop of  0 O 5pz       0.00007
pop of  0 O 6px       0.00002
pop of  0 O 6py       0.00001
pop of  0 O 6pz       0.00005
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00066
pop of  0 O 3dz^2     0.00605
pop of  0 O 3dxz      0.00142
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00015
pop of  0 O 4dz^2     0.00053
pop of  0 O 4dxz      0.00033
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00003
pop of  0 O 5dz^2     0.00007
pop of  0 O 5dxz      0.00005
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00000
pop of  0 O 6dz^2     0.00010
pop of  0 O 6dxz      0.00001
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00001
pop of  0 O 4f 0      0.00055
pop of  0 O 4f 1      0.00017
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00001
pop of  0 O 5f 0      0.00007
pop of  0 O 5f 1      0.00005
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00000
pop of  0 O 6f 0      0.00002
pop of  0 O 6f 1      0.00001
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00001
pop of  0 O 5g 0      0.00013
pop of  0 O 5g 1      0.00003
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00001
pop of  0 O 6g 0      0.00004
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.64183
pop of  1 H 2s        0.00851
pop of  1 H 3s        0.00230
pop of  1 H 4s        0.00010
pop of  1 H 5s        0.00004
pop of  1 H 2px       0.00274
pop of  1 H 2py       0.00035
pop of  1 H 2pz       0.00087
pop of  1 H 3px       0.00001
pop of  1 H 3py       0.00031
pop of  1 H 3pz       0.00045
pop of  1 H 4px       0.00003
pop of  1 H 4py       0.00014
pop of  1 H 4pz       0.00006
pop of  1 H 5px       0.00000
pop of  1 H 5py       0.00003
pop of  1 H 5pz       0.00003
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00006
pop of  1 H 3dz^2     0.00014
pop of  1 H 3dxz      0.00011
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00000
pop of  1 H 4dz^2     0.00000
pop of  1 H 4dxz      0.00000
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00003
pop of  1 H 5dz^2     0.00006
pop of  1 H 5dxz      0.00000
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00001
pop of  1 H 4f 0      0.00011
pop of  1 H 4f 1      0.00000
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00000
pop of  1 H 5f 0      0.00016
pop of  1 H 5f 1      0.00005
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34146
charge of  1H =      0.34146
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.84367
#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.08)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab22.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 22:18:37 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       289.51

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmp29lv6rcg
max_memory 4000 MB (current use 570 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.08/tmp29lv6rcg
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 570 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.245441315613447  LUMO = 0.332982018994837
Initial guess E= -75.4077470905964  |g|= 0.000365582
macro= 0  E= -75.407747152412  delta_E= -6.18156e-08  |g|= 0.000365582  1 KF 3 JK
macro= 1  E= -75.407747152412  delta_E= 0  |g|= 5.87057e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.407747152412  |g|= 5.87057e-06  total 3 KF 8 JK
converged SCF energy = -75.407747152412
u+d contributions  -0.008462078748442273
uu+dd contributions  -0.0405801459877246
ud contributions  -0.14617614298528164
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
after tapering qubits(H) =  6
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008457198591966204
uu+dd contributions  -0.04057457698386659
ud contributions  -0.14616159923664168
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008131516508165699
uu+dd contributions  -0.04029354837184856
ud contributions  -0.14608841053676624
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008131516508165699
uu+dd contributions  -0.04029354837184856
ud contributions  -0.14608841053676624
