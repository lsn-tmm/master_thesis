#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab20.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 22:18:03 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   1.040000000000 AA    0.000000000000   0.000000000000   1.965315169548 Bohr

nuclear repulsion = 4.07059393015385
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         3.98
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmp4zjhpmix
max_memory 4000 MB (current use 272 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmp4zjhpmix
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 272 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.425188045812796  LUMO (A1) = 0.0223834196918848
Initial guess E= -75.4012144176724  |g|= 0.216766
macro= 0  E= -75.4123207854768  delta_E= -0.0111064  |g|= 0.216766  2 KF 5 JK
macro= 1  E= -75.4126845215721  delta_E= -0.000363736  |g|= 0.0930426  2 KF 5 JK
macro= 2  E= -75.4111182761878  delta_E= 0.00156625  |g|= 0.0629827  2 KF 5 JK
macro= 3  E= -75.4124748665859  delta_E= -0.00135659  |g|= 0.111508  2 KF 5 JK
macro= 4  E= -75.4111175102368  delta_E= 0.00135736  |g|= 0.0623647  2 KF 5 JK
macro= 5  E= -75.4125136178504  delta_E= -0.00139611  |g|= 0.110803  2 KF 5 JK
macro= 6  E= -75.4112788485413  delta_E= 0.00123477  |g|= 0.0639028  2 KF 5 JK
macro= 7  E= -75.4125399725397  delta_E= -0.00126112  |g|= 0.108661  2 KF 5 JK
macro= 8  E= -75.4111527844407  delta_E= 0.00138719  |g|= 0.0631437  2 KF 5 JK
macro= 9  E= -75.4125384112287  delta_E= -0.00138563  |g|= 0.110911  2 KF 5 JK
macro= 10  E= -75.4111794849426  delta_E= 0.00135893  |g|= 0.0633783  2 KF 5 JK
macro= 11  E= -75.412547508954  delta_E= -0.00136802  |g|= 0.110501  2 KF 5 JK
macro= 12  E= -75.4111315505578  delta_E= 0.00141596  |g|= 0.0631178  2 KF 5 JK
macro= 13  E= -75.4125513922785  delta_E= -0.00141984  |g|= 0.111304  2 KF 5 JK
macro= 14  E= -75.4111192660367  delta_E= 0.00143213  |g|= 0.0630931  2 KF 5 JK
macro= 15  E= -75.4125577484132  delta_E= -0.00143848  |g|= 0.111511  2 KF 5 JK
macro= 16  E= -75.4110901276324  delta_E= 0.00146762  |g|= 0.0629378  2 KF 5 JK
macro= 17  E= -75.4125629681575  delta_E= -0.00147284  |g|= 0.111982  2 KF 5 JK
macro= 18  E= -75.4110691871542  delta_E= 0.00149378  |g|= 0.0628383  2 KF 5 JK
macro= 19  E= -75.4125687675837  delta_E= -0.00149958  |g|= 0.112317  2 KF 5 JK
macro= 20  E= -75.4110446004861  delta_E= 0.00152417  |g|= 0.0627043  2 KF 5 JK
macro= 21  E= -75.4125743296542  delta_E= -0.00152973  |g|= 0.112704  2 KF 5 JK
macro= 22  E= -75.411022008474  delta_E= 0.00155232  |g|= 0.0625807  2 KF 5 JK
macro= 23  E= -75.4125800300878  delta_E= -0.00155802  |g|= 0.113055  2 KF 5 JK
macro= 24  E= -75.4109987932666  delta_E= 0.00158124  |g|= 0.062446  2 KF 5 JK
macro= 25  E= -75.4125856846493  delta_E= -0.00158689  |g|= 0.113411  2 KF 5 JK
macro= 26  E= -75.4109762202707  delta_E= 0.00160946  |g|= 0.0623108  2 KF 5 JK
macro= 27  E= -75.4125913696888  delta_E= -0.00161515  |g|= 0.113752  2 KF 5 JK
macro= 28  E= -75.4109537326816  delta_E= 0.00163764  |g|= 0.0621702  2 KF 5 JK
macro= 29  E= -75.4125970408178  delta_E= -0.00164331  |g|= 0.114088  2 KF 5 JK
macro= 30  E= -75.410931621815  delta_E= 0.00166542  |g|= 0.0620269  2 KF 5 JK
macro= 31  E= -75.4126027090177  delta_E= -0.00167109  |g|= 0.114413  2 KF 5 JK
macro= 32  E= -75.4109097821483  delta_E= 0.00169293  |g|= 0.0618799  2 KF 5 JK
macro= 33  E= -75.4126083599961  delta_E= -0.00169858  |g|= 0.114731  2 KF 5 JK
macro= 34  E= -75.4108882893676  delta_E= 0.00172007  |g|= 0.0617299  2 KF 5 JK
macro= 35  E= -75.4126139909187  delta_E= -0.0017257  |g|= 0.11504  2 KF 5 JK
macro= 36  E= -75.4108671330165  delta_E= 0.00174686  |g|= 0.0615769  2 KF 5 JK
macro= 37  E= -75.4126195938984  delta_E= -0.00175246  |g|= 0.115341  2 KF 5 JK
macro= 38  E= -75.4108463396729  delta_E= 0.00177325  |g|= 0.0614212  2 KF 5 JK
macro= 39  E= -75.4126251634379  delta_E= -0.00177882  |g|= 0.115633  2 KF 5 JK
macro= 40  E= -75.4108259164495  delta_E= 0.00179925  |g|= 0.0612631  2 KF 5 JK
macro= 41  E= -75.4126306931842  delta_E= -0.00180478  |g|= 0.115917  2 KF 5 JK
macro= 42  E= -75.4108058768798  delta_E= 0.00182482  |g|= 0.0611028  2 KF 5 JK
macro= 43  E= -75.4126361774059  delta_E= -0.0018303  |g|= 0.116192  2 KF 5 JK
macro= 44  E= -75.4107862291852  delta_E= 0.00184995  |g|= 0.0609405  2 KF 5 JK
macro= 45  E= -75.4126416103987  delta_E= -0.00185538  |g|= 0.116459  2 KF 5 JK
macro= 46  E= -75.4107669816823  delta_E= 0.00187463  |g|= 0.0607766  2 KF 5 JK
macro= 47  E= -75.412646986784  delta_E= -0.00188001  |g|= 0.116717  2 KF 5 JK
macro= 48  E= -75.4107481404253  delta_E= 0.00189885  |g|= 0.0606112  2 KF 5 JK
macro= 49  E= -75.4105299532413  delta_E= 0.000218187  |g|= 0.116968  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4105299532413  |g|= 0.116968  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4105299532413

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmp4zjhpmix
max_memory 4000 MB (current use 545 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmp4zjhpmix
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 545 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.279243326727931  LUMO (A1) = 0.026773862968966
Initial guess E= -75.4133736241241  |g|= 0.0727889
macro= 0  E= -75.414220132662  delta_E= -0.000846509  |g|= 0.0727889  2 KF 5 JK
macro= 1  E= -75.4142416647385  delta_E= -2.15321e-05  |g|= 0.0226547  2 KF 5 JK
macro= 2  E= -75.4140603809624  delta_E= 0.000181284  |g|= 0.0157713  2 KF 5 JK
macro= 3  E= -75.4142378230782  delta_E= -0.000177442  |g|= 0.034117  2 KF 5 JK
macro= 4  E= -75.4140704094859  delta_E= 0.000167414  |g|= 0.0127084  2 KF 5 JK
macro= 5  E= -75.4142187876801  delta_E= -0.000148378  |g|= 0.0343364  2 KF 5 JK
macro= 6  E= -75.4141663451029  delta_E= 5.24426e-05  |g|= 0.0157793  2 KF 5 JK
macro= 7  E= -75.4142019966519  delta_E= -3.56515e-05  |g|= 0.0273631  2 KF 5 JK
macro= 8  E= -75.4141212585417  delta_E= 8.07381e-05  |g|= 0.0172519  2 KF 5 JK
macro= 9  E= -75.4142407917141  delta_E= -0.000119533  |g|= 0.0302104  2 KF 5 JK
macro= 10  E= -75.4140935359739  delta_E= 0.000147256  |g|= 0.0154461  2 KF 5 JK
macro= 11  E= -75.4142353835144  delta_E= -0.000141848  |g|= 0.0322947  2 KF 5 JK
macro= 12  E= -75.4141353683761  delta_E= 0.000100015  |g|= 0.0158057  2 KF 5 JK
macro= 13  E= -75.4142316989807  delta_E= -9.63306e-05  |g|= 0.0290331  2 KF 5 JK
macro= 14  E= -75.4141375613421  delta_E= 9.41376e-05  |g|= 0.0154064  2 KF 5 JK
macro= 15  E= -75.4142323447904  delta_E= -9.47834e-05  |g|= 0.0288567  2 KF 5 JK
macro= 16  E= -75.4141333792457  delta_E= 9.89655e-05  |g|= 0.0154149  2 KF 5 JK
macro= 17  E= -75.4142331695616  delta_E= -9.97903e-05  |g|= 0.0291497  2 KF 5 JK
macro= 18  E= -75.4141318118339  delta_E= 0.000101358  |g|= 0.0154681  2 KF 5 JK
macro= 19  E= -75.4142333105687  delta_E= -0.000101499  |g|= 0.029275  2 KF 5 JK
macro= 20  E= -75.4141320030527  delta_E= 0.000101308  |g|= 0.0154724  2 KF 5 JK
macro= 21  E= -75.4142332212287  delta_E= -0.000101218  |g|= 0.0292682  2 KF 5 JK
macro= 22  E= -75.414132196838  delta_E= 0.000101024  |g|= 0.0154562  2 KF 5 JK
macro= 23  E= -75.4142332217472  delta_E= -0.000101025  |g|= 0.0292578  2 KF 5 JK
macro= 24  E= -75.4141320523593  delta_E= 0.000101169  |g|= 0.0154425  2 KF 5 JK
macro= 25  E= -75.4141964786928  delta_E= -6.44263e-05  |g|= 0.0292715  2 KF 5 JK
macro= 26  E= -75.4141513617878  delta_E= 4.51169e-05  |g|= 0.0188032  2 KF 5 JK
macro= 27  E= -75.414186990742  delta_E= -3.5629e-05  |g|= 0.0283538  2 KF 5 JK
macro= 28  E= -75.4141400363012  delta_E= 4.69544e-05  |g|= 0.0194816  2 KF 5 JK
macro= 29  E= -75.4141780186924  delta_E= -3.79824e-05  |g|= 0.0291452  2 KF 5 JK
macro= 30  E= -75.4141473320734  delta_E= 3.06866e-05  |g|= 0.0205952  2 KF 5 JK
macro= 31  E= -75.4141780847839  delta_E= -3.07527e-05  |g|= 0.0287881  2 KF 5 JK
macro= 32  E= -75.4141431689404  delta_E= 3.49158e-05  |g|= 0.0204069  2 KF 5 JK
macro= 33  E= -75.414176731714  delta_E= -3.35628e-05  |g|= 0.0290384  2 KF 5 JK
macro= 34  E= -75.4141455211112  delta_E= 3.12106e-05  |g|= 0.0206124  2 KF 5 JK
macro= 35  E= -75.4141769101256  delta_E= -3.1389e-05  |g|= 0.0289177  2 KF 5 JK
macro= 36  E= -75.414143908514  delta_E= 3.30016e-05  |g|= 0.0205296  2 KF 5 JK
macro= 37  E= -75.4141762655241  delta_E= -3.2357e-05  |g|= 0.0290203  2 KF 5 JK
macro= 38  E= -75.414144689123  delta_E= 3.15764e-05  |g|= 0.0206125  2 KF 5 JK
macro= 39  E= -75.4141761070407  delta_E= -3.14179e-05  |g|= 0.0289869  2 KF 5 JK
macro= 40  E= -75.4141440098686  delta_E= 3.20972e-05  |g|= 0.0205972  2 KF 5 JK
macro= 41  E= -75.4141756470031  delta_E= -3.16371e-05  |g|= 0.0290363  2 KF 5 JK
macro= 42  E= -75.4141442264091  delta_E= 3.14206e-05  |g|= 0.0206424  2 KF 5 JK
macro= 43  E= -75.4141753654392  delta_E= -3.1139e-05  |g|= 0.0290348  2 KF 5 JK
macro= 44  E= -75.4141438893938  delta_E= 3.1476e-05  |g|= 0.0206511  2 KF 5 JK
macro= 45  E= -75.4141749758231  delta_E= -3.10864e-05  |g|= 0.0290646  2 KF 5 JK
macro= 46  E= -75.4141438957041  delta_E= 3.10801e-05  |g|= 0.020682  2 KF 5 JK
macro= 47  E= -75.4141746539195  delta_E= -3.07582e-05  |g|= 0.0290749  2 KF 5 JK
macro= 48  E= -75.4141436868744  delta_E= 3.0967e-05  |g|= 0.020699  2 KF 5 JK
macro= 49  E= -75.414174293041  delta_E= -3.06062e-05  |g|= 0.0290974  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.414174293041  |g|= 0.0290974  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.414174293041
**** SCF Summaries ****
Total Energy =                         -75.414174293041000
Nuclear Repulsion Energy =               4.070593930153847
One-electron Energy =                 -112.107350218952263
Two-electron Energy =                   32.622581995757415
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    0    1    0    0    0    0    0    0
single occ                     0    1    0    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6355817179569  | -20.652461874936   | -20.6187015609777  occ= 2
MO #2   (A1  #2 ) energy= -1.29088772156777  | -1.36240157737558  | -1.21937386575997  occ= 2
MO #3   (A1  #3 ) energy= -0.644219552583124 | -0.66355167668177  | -0.624887428484479 occ= 2
MO #4   (E1y #1 ) energy= -0.537429678803165 | -0.556585478757745 | -0.518273878848584 occ= 2
MO #5   (E1x #1 ) energy= -0.248167358555657 | -0.645948885615692 | 0.149614168504387  occ= 1
MO #6   (A1  #4 ) energy= 0.0272839091291868 | 0.0266856957899159 | 0.0278821224684651 occ= 0
MO #7   (A1  #5 ) energy= 0.113005748937205  | 0.112179630049204  | 0.113831867825267  occ= 0
MO #8   (E1x #2 ) energy= 0.136340406819082  | 0.132294855949836  | 0.140385957688328  occ= 0
MO #9   (E1y #2 ) energy= 0.140117332984624  | 0.139549716513164  | 0.140684949456083  occ= 0
MO #10  (A1  #6 ) energy= 0.159516492438888  | 0.157625088727514  | 0.161407896150282  occ= 0
MO #11  (E1x #3 ) energy= 0.212311569258089  | 0.210667956392884  | 0.213955182123293  occ= 0
MO #12  (E1y #3 ) energy= 0.215037254174555  | 0.214820005818433  | 0.215254502530679  occ= 0
MO #13  (A1  #7 ) energy= 0.222383695985564  | 0.220690149377482  | 0.224077242593694  occ= 0
MO #14  (A1  #8 ) energy= 0.336123149675604  | 0.332640774879513  | 0.339605524471734  occ= 0
MO #15  (E2x #1 ) energy= 0.478355138769679  | 0.47346948265754   | 0.483240794881818  occ= 0
MO #16  (E2y #1 ) energy= 0.478355138769682  | 0.473469482657543  | 0.483240794881822  occ= 0
MO #17  (A1  #9 ) energy= 0.500825391526733  | 0.497385767826258  | 0.504265015227238  occ= 0
MO #18  (E1x #4 ) energy= 0.545814761009868  | 0.540557834187563  | 0.551071687832165  occ= 0
MO #19  (E1y #4 ) energy= 0.550545525173518  | 0.549845331477592  | 0.551245718869453  occ= 0
MO #20  (A1  #10) energy= 0.640109355397957  | 0.638827588156476  | 0.641391122639381  occ= 0
MO #21  (E1x #5 ) energy= 0.645057482262552  | 0.632633536345027  | 0.657481428180073  occ= 0
MO #22  (E1y #5 ) energy= 0.647954920005016  | 0.646427904573906  | 0.64948193543613   occ= 0
MO #23  (E2x #2 ) energy= 0.685576205386719  | 0.684994313061405  | 0.686158097712029  occ= 0
MO #24  (E2y #2 ) energy= 0.685576205386727  | 0.684994313061415  | 0.686158097712038  occ= 0
MO #25  (A1  #11) energy= 0.705651820955347  | 0.701092563640661  | 0.710211078269991  occ= 0
MO #26  (E1x #6 ) energy= 0.757857921906897  | 0.735617197108412  | 0.780098646705386  occ= 0
MO #27  (E1y #6 ) energy= 0.763062726320592  | 0.760376550281751  | 0.765748902359436  occ= 0
MO #28  (A1  #12) energy= 0.780433647045406  | 0.776658342378022  | 0.784208951713209  occ= 0
MO #29  (E1x #7 ) energy= 1.13341495420506   | 1.12258128481873   | 1.14424862359141   occ= 0
MO #30  (E1y #7 ) energy= 1.13955003271227   | 1.1380950023478    | 1.14100506307676   occ= 0
MO #31  (A1  #13) energy= 1.22385294317139   | 1.21522200583583   | 1.23248388050712   occ= 0
MO #32  (E3x #1 ) energy= 1.32434738114659   | 1.31985387118259   | 1.32884089111059   occ= 0
MO #33  (E3y #1 ) energy= 1.32434738114659   | 1.31985387118259   | 1.32884089111059   occ= 0
MO #34  (A1  #14) energy= 1.43490598144526   | 1.4291423583218    | 1.4406696045687    occ= 0
MO #35  (E2x #3 ) energy= 1.4982011987191    | 1.47480775896335   | 1.52159463847483   occ= 0
MO #36  (E2y #3 ) energy= 1.4982011987191    | 1.47480775896335   | 1.52159463847483   occ= 0
MO #37  (E1x #8 ) energy= 1.53991632130565   | 1.53151717612588   | 1.54831546648542   occ= 0
MO #38  (E1y #8 ) energy= 1.5540033797266    | 1.55252868698333   | 1.55547807246986   occ= 0
MO #39  (E2x #4 ) energy= 1.56678491409293   | 1.56303788899929   | 1.57053193918658   occ= 0
MO #40  (E2y #4 ) energy= 1.56678491409294   | 1.5630378889993    | 1.57053193918658   occ= 0
MO #41  (A1  #15) energy= 1.61646186870769   | 1.61251753610228   | 1.62040620131309   occ= 0
MO #42  (A1  #16) energy= 1.66572551346956   | 1.66366671879276   | 1.66778430814671   occ= 0
MO #43  (E3x #2 ) energy= 1.71107938248293   | 1.70983306268177   | 1.7123257022841    occ= 0
MO #44  (E3y #2 ) energy= 1.71107938248293   | 1.70983306268177   | 1.7123257022841    occ= 0
MO #45  (E1x #9 ) energy= 1.72089782944956   | 1.71064633696446   | 1.73114932193465   occ= 0
MO #46  (E1y #9 ) energy= 1.72704377610786   | 1.72561461108883   | 1.7284729411269    occ= 0
MO #47  (E2x #5 ) energy= 1.89409402680459   | 1.89059861800667   | 1.89758943560251   occ= 0
MO #48  (E2y #5 ) energy= 1.89409402680462   | 1.8905986180067    | 1.89758943560253   occ= 0
MO #49  (A1  #17) energy= 1.92889162121326   | 1.92465022487033   | 1.93313301755633   occ= 0
MO #50  (E1x #10) energy= 2.11286489382569   | 2.09833668408648   | 2.12739310356491   occ= 0
MO #51  (E1y #10) energy= 2.12515886811742   | 2.12279914150904   | 2.1275185947258    occ= 0
MO #52  (A1  #18) energy= 2.3426671827139    | 2.33758876512367   | 2.34774560030411   occ= 0
MO #53  (E1x #11) energy= 2.59227009969285   | 2.55000036490953   | 2.63453983447618   occ= 0
MO #54  (E1y #11) energy= 2.60177677754143   | 2.59607444545688   | 2.60747910962599   occ= 0
MO #55  (E2x #6 ) energy= 2.85672929849161   | 2.85223997759949   | 2.86121861938374   occ= 0
MO #56  (E2y #6 ) energy= 2.85672929849162   | 2.85223997759949   | 2.86121861938375   occ= 0
MO #57  (E1x #12) energy= 2.90446166945002   | 2.8988737822215    | 2.91004955667855   occ= 0
MO #58  (E1y #12) energy= 2.91640446118206   | 2.91539777811719   | 2.91741114424695   occ= 0
MO #59  (A1  #19) energy= 3.00857933002847   | 3.00479532142265   | 3.01236333863436   occ= 0
MO #60  (A1  #20) energy= 3.56699726269359   | 3.55898063884835   | 3.57501388653951   occ= 0
MO #61  (E4x #1 ) energy= 3.65790003530459   | 3.65062902991034   | 3.66517104069885   occ= 0
MO #62  (E4y #1 ) energy= 3.65790003530461   | 3.65062902991036   | 3.66517104069886   occ= 0
MO #63  (E1x #13) energy= 3.76422791020262   | 3.74289212867505   | 3.78556369173019   occ= 0
MO #64  (E1y #13) energy= 3.78815144557092   | 3.78400870813355   | 3.79229418300831   occ= 0
MO #65  (E3x #3 ) energy= 3.88183848155065   | 3.87431887796166   | 3.88935808513963   occ= 0
MO #66  (E3y #3 ) energy= 3.88183848155064   | 3.87431887796166   | 3.88935808513962   occ= 0
MO #67  (A1  #21) energy= 3.9784782433602    | 3.96938644448202   | 3.98757004223872   occ= 0
MO #68  (E3x #4 ) energy= 4.0880823825432    | 4.0719209211245    | 4.10424384396191   occ= 0
MO #69  (E3y #4 ) energy= 4.0880823825432    | 4.0719209211245    | 4.10424384396191   occ= 0
MO #70  (E2x #7 ) energy= 4.16285519034257   | 4.15257402312418   | 4.17313635756097   occ= 0
MO #71  (E2y #7 ) energy= 4.16285519034257   | 4.15257402312419   | 4.17313635756098   occ= 0
MO #72  (E1x #14) energy= 4.20338851244544   | 4.18898622414365   | 4.21779080074723   occ= 0
MO #73  (A1  #22) energy= 4.21431306262774   | 4.20016795959382   | 4.22845816566168   occ= 0
MO #74  (E1y #14) energy= 4.227841518135     | 4.22539008139838   | 4.23029295487161   occ= 0
MO #75  (E2x #8 ) energy= 4.24904887652232   | 4.22208068953477   | 4.27601706350988   occ= 0
MO #76  (E2y #8 ) energy= 4.24904887652233   | 4.22208068953478   | 4.27601706350989   occ= 0
MO #77  (A1  #23) energy= 4.34251583340626   | 4.33815852199695   | 4.3468731448156    occ= 0
MO #78  (E1x #15) energy= 4.69002690403897   | 4.66408135977274   | 4.71597244830519   occ= 0
MO #79  (E1y #15) energy= 4.71399963754687   | 4.70936004122175   | 4.71863923387199   occ= 0
MO #80  (E2x #9 ) energy= 4.75601408514348   | 4.73828676277925   | 4.77374140750772   occ= 0
MO #81  (E2y #9 ) energy= 4.75601408514349   | 4.73828676277925   | 4.77374140750772   occ= 0
MO #82  (A1  #24) energy= 5.22519335515724   | 5.21836902819416   | 5.23201768212035   occ= 0
MO #83  (E1x #16) energy= 5.41512509571493   | 5.39950815058883   | 5.43074204084104   occ= 0
MO #84  (E1y #16) energy= 5.44023571574734   | 5.43719301503106   | 5.44327841646365   occ= 0
MO #85  (A1  #25) energy= 5.66877479770778   | 5.65850643173209   | 5.67904316368351   occ= 0
MO #86  (E3x #5 ) energy= 6.6324228015168    | 6.63129346359582   | 6.63355213943776   occ= 0
MO #87  (E3y #5 ) energy= 6.63242280151679   | 6.63129346359581   | 6.63355213943776   occ= 0
MO #88  (E2x #10) energy= 7.51159517240925   | 7.50894818108572   | 7.51424216373276   occ= 0
MO #89  (E2y #10) energy= 7.51159517240925   | 7.50894818108572   | 7.51424216373276   occ= 0
MO #90  (A1  #26) energy= 7.58979574169784   | 7.58701159087958   | 7.59257989251612   occ= 0
MO #91  (E1x #17) energy= 7.70396128855536   | 7.70085647129162   | 7.7070661058191    occ= 0
MO #92  (E1y #17) energy= 7.71435039764805   | 7.7136784840349    | 7.71502231126122   occ= 0
MO #93  (A1  #27) energy= 8.35463308277986   | 8.35218649813317   | 8.3570796674266    occ= 0
MO #94  (E2x #11) energy= 8.52144702122306   | 8.52049610761382   | 8.5223979348323    occ= 0
MO #95  (E2y #11) energy= 8.52144702122306   | 8.52049610761382   | 8.5223979348323    occ= 0
MO #96  (E1x #18) energy= 8.7560074296446    | 8.753046967756     | 8.7589678915332    occ= 0
MO #97  (E1y #18) energy= 8.76691541464191   | 8.76628631112577   | 8.76754451815806   occ= 0
MO #98  (E1x #19) energy= 9.47893030358788   | 9.4709646005492    | 9.48689600662654   occ= 0
MO #99  (E1y #19) energy= 9.49738095083663   | 9.49559306569601   | 9.49916883597732   occ= 0
MO #100 (A1  #28) energy= 9.56471632789703   | 9.56141210493474   | 9.56802055085931   occ= 0
MO #101 (E4x #2 ) energy= 10.610711746233    | 10.5944970876925   | 10.6269264047735   occ= 0
MO #102 (E4y #2 ) energy= 10.610711746233    | 10.5944970876925   | 10.6269264047735   occ= 0
MO #103 (E3x #6 ) energy= 10.7288229115642   | 10.7161535840234   | 10.7414922391051   occ= 0
MO #104 (E3y #6 ) energy= 10.7288229115642   | 10.7161535840234   | 10.7414922391051   occ= 0
MO #105 (E1x #20) energy= 10.9104626827003   | 10.8685939217511   | 10.9523314436496   occ= 0
MO #106 (A1  #29) energy= 10.9225769862154   | 10.9164392393186   | 10.9287147331122   occ= 0
MO #107 (E1y #20) energy= 10.9482497351199   | 10.9407943004014   | 10.9557051698383   occ= 0
MO #108 (E2x #12) energy= 11.0522467531481   | 11.0424113161183   | 11.0620821901779   occ= 0
MO #109 (E2y #12) energy= 11.052246753148    | 11.0424113161182   | 11.0620821901778   occ= 0
MO #110 (E1x #21) energy= 11.478885475439    | 11.4636241737623   | 11.4941467771158   occ= 0
MO #111 (A1  #30) energy= 11.5153341411683   | 11.5067264319019   | 11.5239418504346   occ= 0
MO #112 (E1y #21) energy= 11.5195327520184   | 11.5161620238339   | 11.5229034802029   occ= 0
MO #113 (E3x #7 ) energy= 11.8585105982079   | 11.8327494616767   | 11.8842717347392   occ= 0
MO #114 (E3y #7 ) energy= 11.8585105982079   | 11.8327494616767   | 11.8842717347392   occ= 0
MO #115 (A1  #31) energy= 11.9246005167342   | 11.9137235949811   | 11.9354774384874   occ= 0
MO #116 (E2x #13) energy= 12.0008070842714   | 11.9827228490729   | 12.0188913194699   occ= 0
MO #117 (E2y #13) energy= 12.0008070842714   | 11.9827228490729   | 12.0188913194698   occ= 0
MO #118 (E1x #22) energy= 12.4966390841355   | 12.4762246035198   | 12.5170535647512   occ= 0
MO #119 (E1y #22) energy= 12.5348364794263   | 12.530440254562    | 12.5392327042907   occ= 0
MO #120 (E2x #14) energy= 12.7862478001791   | 12.7559382210257   | 12.8165573793325   occ= 0
MO #121 (E2y #14) energy= 12.7862478001791   | 12.7559382210257   | 12.8165573793325   occ= 0
MO #122 (A1  #32) energy= 13.8900064115347   | 13.8843965464037   | 13.8956162766658   occ= 0
MO #123 (E1x #23) energy= 13.9580358101012   | 13.9349244765519   | 13.9811471436506   occ= 0
MO #124 (E1y #23) energy= 13.993764064035    | 13.989206439025    | 13.9983216890451   occ= 0
MO #125 (A1  #33) energy= 16.2369052139744   | 16.2309867655506   | 16.2428236623983   occ= 0
MO #126 (A1  #34) energy= 42.5962277096101   | 42.586393352377    | 42.6060620668407   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.84535
pop of  0 O 3s        0.00355
pop of  0 O 4s        0.00112
pop of  0 O 5s        0.00024
pop of  0 O 6s        0.00005
pop of  0 O 2px       0.99704
pop of  0 O 2py       1.99223
pop of  0 O 2pz       1.48823
pop of  0 O 3px       0.00013
pop of  0 O 3py       0.00144
pop of  0 O 3pz       0.00082
pop of  0 O 4px       0.00067
pop of  0 O 4py       0.00060
pop of  0 O 4pz       0.00186
pop of  0 O 5px       0.00007
pop of  0 O 5py       0.00020
pop of  0 O 5pz       0.00007
pop of  0 O 6px       0.00001
pop of  0 O 6py       0.00002
pop of  0 O 6pz       0.00006
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00165
pop of  0 O 3dz^2     0.00700
pop of  0 O 3dxz      0.00078
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00034
pop of  0 O 4dz^2     0.00057
pop of  0 O 4dxz      0.00016
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00004
pop of  0 O 5dz^2     0.00008
pop of  0 O 5dxz      0.00002
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00001
pop of  0 O 6dz^2     0.00011
pop of  0 O 6dxz      0.00000
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00018
pop of  0 O 4f 0      0.00068
pop of  0 O 4f 1      0.00001
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00005
pop of  0 O 5f 0      0.00008
pop of  0 O 5f 1      0.00001
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00001
pop of  0 O 6f 0      0.00003
pop of  0 O 6f 1      0.00000
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00003
pop of  0 O 5g 0      0.00018
pop of  0 O 5g 1      0.00001
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00001
pop of  0 O 6g 0      0.00005
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.63492
pop of  1 H 2s        0.00976
pop of  1 H 3s        0.00307
pop of  1 H 4s        0.00008
pop of  1 H 5s        0.00004
pop of  1 H 2px       0.00043
pop of  1 H 2py       0.00298
pop of  1 H 2pz       0.00082
pop of  1 H 3px       0.00034
pop of  1 H 3py       0.00000
pop of  1 H 3pz       0.00040
pop of  1 H 4px       0.00015
pop of  1 H 4py       0.00003
pop of  1 H 4pz       0.00011
pop of  1 H 5px       0.00003
pop of  1 H 5py       0.00001
pop of  1 H 5pz       0.00003
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00010
pop of  1 H 3dz^2     0.00020
pop of  1 H 3dxz      0.00007
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00000
pop of  1 H 4dz^2     0.00001
pop of  1 H 4dxz      0.00001
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00000
pop of  1 H 5dz^2     0.00009
pop of  1 H 5dxz      0.00003
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00001
pop of  1 H 4f 0      0.00013
pop of  1 H 4f 1      0.00000
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00007
pop of  1 H 5f 0      0.00022
pop of  1 H 5f 1      0.00001
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34586
charge of  1H =      0.34586
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.79949
#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab20.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 22:18:27 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       289.53

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmpgf8zusjw
max_memory 4000 MB (current use 568 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.04/tmpgf8zusjw
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 568 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248167358555668  LUMO = 0.364624498629462
Initial guess E= -75.4141861992964  |g|= 0.000665229
macro= 0  E= -75.4141864711962  delta_E= -2.719e-07  |g|= 0.000665229  1 KF 4 JK
macro= 1  E= -75.4141864711962  delta_E= 2.84217e-14  |g|= 1.20875e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4141864711962  |g|= 1.20875e-07  total 3 KF 9 JK
converged SCF energy = -75.4141864711962
u+d contributions  -0.008536561605331993
uu+dd contributions  -0.0409109127911974
ud contributions  -0.14740823098761854
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
after tapering qubits(H) =  6
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008532241192538032
uu+dd contributions  -0.04090615654992659
ud contributions  -0.14739419945006974
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008207781967187773
uu+dd contributions  -0.04062170795790672
ud contributions  -0.14731421038544606
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008207781967187773
uu+dd contributions  -0.04062170795790672
ud contributions  -0.14731421038544606
