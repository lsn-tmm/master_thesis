#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.12)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab36.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 20:45:59 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   1.120000000000 AA    0.000000000000   0.000000000000   2.116493259513 Bohr

nuclear repulsion = 3.77983722085714
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         4.25
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmp2ixsi1e4
max_memory 4000 MB (current use 272 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmp2ixsi1e4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 272 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.417427645368424  LUMO (A1) = 0.0177333839629088
Initial guess E= -75.3854555769489  |g|= 0.218505
macro= 0  E= -75.3981819362672  delta_E= -0.0127264  |g|= 0.218505  2 KF 5 JK
macro= 1  E= -75.3983354572499  delta_E= -0.000153521  |g|= 0.0902697  2 KF 5 JK
macro= 2  E= -75.3968523910001  delta_E= 0.00148307  |g|= 0.0618479  2 KF 5 JK
macro= 3  E= -75.3981674213879  delta_E= -0.00131503  |g|= 0.110933  2 KF 5 JK
macro= 4  E= -75.3968182211014  delta_E= 0.0013492  |g|= 0.0624718  2 KF 5 JK
macro= 5  E= -75.3982103285194  delta_E= -0.00139211  |g|= 0.110459  2 KF 5 JK
macro= 6  E= -75.3968448408652  delta_E= 0.00136549  |g|= 0.0631214  2 KF 5 JK
macro= 7  E= -75.3982307170884  delta_E= -0.00138588  |g|= 0.110405  2 KF 5 JK
macro= 8  E= -75.3967819522089  delta_E= 0.00144876  |g|= 0.0628192  2 KF 5 JK
macro= 9  E= -75.3982342533049  delta_E= -0.0014523  |g|= 0.111511  2 KF 5 JK
macro= 10  E= -75.3967702360969  delta_E= 0.00146402  |g|= 0.0628118  2 KF 5 JK
macro= 11  E= -75.3982420946531  delta_E= -0.00147186  |g|= 0.111716  2 KF 5 JK
macro= 12  E= -75.3967367146778  delta_E= 0.00150538  |g|= 0.0626407  2 KF 5 JK
macro= 13  E= -75.3982480412244  delta_E= -0.00151133  |g|= 0.112257  2 KF 5 JK
macro= 14  E= -75.39671325604  delta_E= 0.00153479  |g|= 0.0625206  2 KF 5 JK
macro= 15  E= -75.3982548590075  delta_E= -0.0015416  |g|= 0.112626  2 KF 5 JK
macro= 16  E= -75.3966855168064  delta_E= 0.00156934  |g|= 0.0623575  2 KF 5 JK
macro= 17  E= -75.3982613238885  delta_E= -0.00157581  |g|= 0.113055  2 KF 5 JK
macro= 18  E= -75.396660026431  delta_E= 0.0016013  |g|= 0.0622032  2 KF 5 JK
macro= 19  E= -75.3982679859798  delta_E= -0.00160796  |g|= 0.113443  2 KF 5 JK
macro= 20  E= -75.3966339084754  delta_E= 0.00163408  |g|= 0.0620359  2 KF 5 JK
macro= 21  E= -75.3982745858279  delta_E= -0.00164068  |g|= 0.113835  2 KF 5 JK
macro= 22  E= -75.3966084960925  delta_E= 0.00166609  |g|= 0.061867  2 KF 5 JK
macro= 23  E= -75.3982812269305  delta_E= -0.00167273  |g|= 0.114211  2 KF 5 JK
macro= 24  E= -75.3965832422554  delta_E= 0.00169798  |g|= 0.0616917  2 KF 5 JK
macro= 25  E= -75.3982878497432  delta_E= -0.00170461  |g|= 0.114579  2 KF 5 JK
macro= 26  E= -75.3965584309141  delta_E= 0.00172942  |g|= 0.0615128  2 KF 5 JK
macro= 27  E= -75.398294467084  delta_E= -0.00173604  |g|= 0.114937  2 KF 5 JK
macro= 28  E= -75.3965339753466  delta_E= 0.00176049  |g|= 0.0613294  2 KF 5 JK
macro= 29  E= -75.3983010596982  delta_E= -0.00176708  |g|= 0.115285  2 KF 5 JK
macro= 30  E= -75.3965099483081  delta_E= 0.00179111  |g|= 0.0611423  2 KF 5 JK
macro= 31  E= -75.3983076225034  delta_E= -0.00179767  |g|= 0.115623  2 KF 5 JK
macro= 32  E= -75.3964863491402  delta_E= 0.00182127  |g|= 0.0609517  2 KF 5 JK
macro= 33  E= -75.398314144393  delta_E= -0.0018278  |g|= 0.115951  2 KF 5 JK
macro= 34  E= -75.3964632056208  delta_E= 0.00185094  |g|= 0.0607581  2 KF 5 JK
macro= 35  E= -75.3983206171529  delta_E= -0.00185741  |g|= 0.116268  2 KF 5 JK
macro= 36  E= -75.3964405296589  delta_E= 0.00188009  |g|= 0.0605617  2 KF 5 JK
macro= 37  E= -75.398327031689  delta_E= -0.0018865  |g|= 0.116576  2 KF 5 JK
macro= 38  E= -75.3964183365735  delta_E= 0.0019087  |g|= 0.060363  2 KF 5 JK
macro= 39  E= -75.3983333797427  delta_E= -0.00191504  |g|= 0.116874  2 KF 5 JK
macro= 40  E= -75.3963966368608  delta_E= 0.00193674  |g|= 0.0601623  2 KF 5 JK
macro= 41  E= -75.3960378511256  delta_E= 0.000358786  |g|= 0.117162  2 KF 5 JK
macro= 42  E= -75.397550691599  delta_E= -0.00151284  |g|= 0.104859  2 KF 5 JK
macro= 43  E= -75.3958657838261  delta_E= 0.00168491  |g|= 0.0977935  2 KF 5 JK
macro= 44  E= -75.3973754982794  delta_E= -0.00150971  |g|= 0.106532  2 KF 5 JK
macro= 45  E= -75.3957868558889  delta_E= 0.00158864  |g|= 0.10191  2 KF 5 JK
macro= 46  E= -75.3973864329013  delta_E= -0.00159958  |g|= 0.107669  2 KF 5 JK
macro= 47  E= -75.3957694446236  delta_E= 0.00161699  |g|= 0.10177  2 KF 5 JK
macro= 48  E= -75.3973622872243  delta_E= -0.00159284  |g|= 0.107786  2 KF 5 JK
macro= 49  E= -75.3957283029225  delta_E= 0.00163398  |g|= 0.102352  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3957283029225  |g|= 0.102352  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3957283029225

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmp2ixsi1e4
max_memory 4000 MB (current use 545 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmp2ixsi1e4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 545 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.278933395491557  LUMO (A1) = 0.0253833235976536
Initial guess E= -75.398812123373  |g|= 0.0806009
macro= 0  E= -75.3998351172697  delta_E= -0.00102299  |g|= 0.0806009  2 KF 5 JK
macro= 1  E= -75.3999306598778  delta_E= -9.55426e-05  |g|= 0.026701  2 KF 5 JK
macro= 2  E= -75.3997971788388  delta_E= 0.000133481  |g|= 0.015245  2 KF 5 JK
macro= 3  E= -75.3999279873887  delta_E= -0.000130809  |g|= 0.030801  2 KF 5 JK
macro= 4  E= -75.399797434726  delta_E= 0.000130553  |g|= 0.0140864  2 KF 5 JK
macro= 5  E= -75.3999300198075  delta_E= -0.000132585  |g|= 0.0309057  2 KF 5 JK
macro= 6  E= -75.3997970041968  delta_E= 0.000133016  |g|= 0.014068  2 KF 5 JK
macro= 7  E= -75.3999307607231  delta_E= -0.000133757  |g|= 0.0309454  2 KF 5 JK
macro= 8  E= -75.3997971494189  delta_E= 0.000133611  |g|= 0.0142661  2 KF 5 JK
macro= 9  E= -75.399931364139  delta_E= -0.000134215  |g|= 0.0309378  2 KF 5 JK
macro= 10  E= -75.3997972652021  delta_E= 0.000134099  |g|= 0.0145468  2 KF 5 JK
macro= 11  E= -75.3999310244996  delta_E= -0.000133759  |g|= 0.0309248  2 KF 5 JK
macro= 12  E= -75.3997975702795  delta_E= 0.000133454  |g|= 0.0149096  2 KF 5 JK
macro= 13  E= -75.3999303066638  delta_E= -0.000132736  |g|= 0.0308907  2 KF 5 JK
macro= 14  E= -75.3997978601862  delta_E= 0.000132446  |g|= 0.0151807  2 KF 5 JK
macro= 15  E= -75.3999298749909  delta_E= -0.000132015  |g|= 0.0308566  2 KF 5 JK
macro= 16  E= -75.3997980186476  delta_E= 0.000131856  |g|= 0.0153003  2 KF 5 JK
macro= 17  E= -75.399929722304  delta_E= -0.000131704  |g|= 0.0308374  2 KF 5 JK
macro= 18  E= -75.3997980780731  delta_E= 0.000131644  |g|= 0.0153358  2 KF 5 JK
macro= 19  E= -75.3999296792052  delta_E= -0.000131601  |g|= 0.0308303  2 KF 5 JK
macro= 20  E= -75.3997980984644  delta_E= 0.000131581  |g|= 0.0153426  2 KF 5 JK
macro= 21  E= -75.3999296673907  delta_E= -0.000131569  |g|= 0.030828  2 KF 5 JK
macro= 22  E= -75.3997981074731  delta_E= 0.00013156  |g|= 0.0153417  2 KF 5 JK
macro= 23  E= -75.3999296631438  delta_E= -0.000131556  |g|= 0.0308273  2 KF 5 JK
macro= 24  E= -75.3997981137113  delta_E= 0.000131549  |g|= 0.015339  2 KF 5 JK
macro= 25  E= -75.3999296605051  delta_E= -0.000131547  |g|= 0.0308269  2 KF 5 JK
macro= 26  E= -75.3997981193905  delta_E= 0.000131541  |g|= 0.0153358  2 KF 5 JK
macro= 27  E= -75.3999296581568  delta_E= -0.000131539  |g|= 0.0308266  2 KF 5 JK
macro= 28  E= -75.3997981250079  delta_E= 0.000131533  |g|= 0.0153326  2 KF 5 JK
macro= 29  E= -75.3999296558391  delta_E= -0.000131531  |g|= 0.0308263  2 KF 5 JK
macro= 30  E= -75.3997981306631  delta_E= 0.000131525  |g|= 0.0153293  2 KF 5 JK
macro= 31  E= -75.399929653507  delta_E= -0.000131523  |g|= 0.030826  2 KF 5 JK
macro= 32  E= -75.399798136375  delta_E= 0.000131517  |g|= 0.0153259  2 KF 5 JK
macro= 33  E= -75.3999296511542  delta_E= -0.000131515  |g|= 0.0308257  2 KF 5 JK
macro= 34  E= -75.3997981421455  delta_E= 0.000131509  |g|= 0.0153225  2 KF 5 JK
macro= 35  E= -75.3999296487797  delta_E= -0.000131507  |g|= 0.0308254  2 KF 5 JK
macro= 36  E= -75.3997981479755  delta_E= 0.000131501  |g|= 0.015319  2 KF 5 JK
macro= 37  E= -75.3999296463833  delta_E= -0.000131498  |g|= 0.030825  2 KF 5 JK
macro= 38  E= -75.3997981538655  delta_E= 0.000131493  |g|= 0.0153155  2 KF 5 JK
macro= 39  E= -75.3999296439653  delta_E= -0.00013149  |g|= 0.0308247  2 KF 5 JK
macro= 40  E= -75.3997981598154  delta_E= 0.000131484  |g|= 0.0153119  2 KF 5 JK
macro= 41  E= -75.3999296415256  delta_E= -0.000131482  |g|= 0.0308244  2 KF 5 JK
macro= 42  E= -75.3997981658259  delta_E= 0.000131476  |g|= 0.0153082  2 KF 5 JK
macro= 43  E= -75.3999296390639  delta_E= -0.000131473  |g|= 0.0308241  2 KF 5 JK
macro= 44  E= -75.399798171897  delta_E= 0.000131467  |g|= 0.0153045  2 KF 5 JK
macro= 45  E= -75.3999296365801  delta_E= -0.000131465  |g|= 0.0308238  2 KF 5 JK
macro= 46  E= -75.3997981780289  delta_E= 0.000131459  |g|= 0.0153008  2 KF 5 JK
macro= 47  E= -75.3999296340739  delta_E= -0.000131456  |g|= 0.0308234  2 KF 5 JK
macro= 48  E= -75.399798184222  delta_E= 0.00013145  |g|= 0.015297  2 KF 5 JK
macro= 49  E= -75.3999296315454  delta_E= -0.000131447  |g|= 0.0308231  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3999296315454  |g|= 0.0308231  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3999296315454
**** SCF Summaries ****
Total Energy =                         -75.399929631545405
Nuclear Repulsion Energy =               3.779837220857142
One-electron Energy =                 -111.596581024821262
Two-electron Energy =                   32.416814172418711
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    0    1    0    0    0    0    0    0
single occ                     0    1    0    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6350090523139  | -20.6522048172235  | -20.6178132874043  occ= 2
MO #2   (A1  #2 ) energy= -1.27070842040631  | -1.3436779884439   | -1.19773885236872  occ= 2
MO #3   (A1  #3 ) energy= -0.620205793797171 | -0.63832329265775  | -0.602088294936591 occ= 2
MO #4   (E1y #1 ) energy= -0.53333555724635  | -0.552620679619056 | -0.514050434873644 occ= 2
MO #5   (E1x #1 ) energy= -0.243002010801812 | -0.644435032456446 | 0.158431010852822  occ= 1
MO #6   (A1  #4 ) energy= 0.0260427035926408 | 0.0252973129087512 | 0.0267880942765318 occ= 0
MO #7   (A1  #5 ) energy= 0.111069166696861  | 0.109893393651426  | 0.11224493974233   occ= 0
MO #8   (E1x #2 ) energy= 0.137900089112756  | 0.133488114861787  | 0.142312063363724  occ= 0
MO #9   (E1y #2 ) energy= 0.141694109440064  | 0.141077496725329  | 0.1423107221548    occ= 0
MO #10  (A1  #6 ) energy= 0.154296824301987  | 0.152228611534018  | 0.156365037069958  occ= 0
MO #11  (E1x #3 ) energy= 0.210273974750227  | 0.208836035815007  | 0.211711913685443  occ= 0
MO #12  (E1y #3 ) energy= 0.213032119300295  | 0.212843410369975  | 0.213220828230616  occ= 0
MO #13  (A1  #7 ) energy= 0.223003802694931  | 0.221239083038538  | 0.224768522351342  occ= 0
MO #14  (A1  #8 ) energy= 0.319530454743075  | 0.31588372985692   | 0.323177179629274  occ= 0
MO #15  (E2x #1 ) energy= 0.478797750507373  | 0.474096326278492  | 0.483499174736255  occ= 0
MO #16  (E2y #1 ) energy= 0.478797750507376  | 0.474096326278494  | 0.483499174736258  occ= 0
MO #17  (A1  #9 ) energy= 0.495514596891415  | 0.492515440853201  | 0.498513752929743  occ= 0
MO #18  (E1x #4 ) energy= 0.542519712819691  | 0.537525931022583  | 0.547513494616791  occ= 0
MO #19  (E1y #4 ) energy= 0.547120086729106  | 0.546461219616969  | 0.547778953841248  occ= 0
MO #20  (A1  #10) energy= 0.624949434999268  | 0.623164529268065  | 0.62673434073048   occ= 0
MO #21  (E1x #5 ) energy= 0.653319459910266  | 0.641390069881846  | 0.665248849938682  occ= 0
MO #22  (E1y #5 ) energy= 0.656678576439454  | 0.655216609481103  | 0.658140543397807  occ= 0
MO #23  (E2x #2 ) energy= 0.688963626882676  | 0.68839793874009   | 0.689529315025262  occ= 0
MO #24  (E2y #2 ) energy= 0.68896362688269   | 0.688397938740102  | 0.689529315025274  occ= 0
MO #25  (A1  #11) energy= 0.698592765537155  | 0.695488971361892  | 0.701696559712446  occ= 0
MO #26  (E1x #6 ) energy= 0.754652233595716  | 0.731977381021287  | 0.777327086170149  occ= 0
MO #27  (E1y #6 ) energy= 0.760701043115571  | 0.757867824279636  | 0.763534261951509  occ= 0
MO #28  (A1  #12) energy= 0.787675912349159  | 0.783350188987215  | 0.792001635711143  occ= 0
MO #29  (E1x #7 ) energy= 1.10513612190554   | 1.0968458239581    | 1.11342641985297   occ= 0
MO #30  (E1y #7 ) energy= 1.11163060229227   | 1.11048295388568   | 1.11277825069888   occ= 0
MO #31  (A1  #13) energy= 1.21471809995263   | 1.20651047622155   | 1.2229257236838    occ= 0
MO #32  (E3x #1 ) energy= 1.3227402534599    | 1.31847880979803   | 1.32700169712176   occ= 0
MO #33  (E3y #1 ) energy= 1.32274025345989   | 1.31847880979803   | 1.32700169712176   occ= 0
MO #34  (A1  #14) energy= 1.37688858920529   | 1.37155216092832   | 1.38222501748231   occ= 0
MO #35  (E2x #3 ) energy= 1.49780880051274   | 1.47511308321859   | 1.52050451780688   occ= 0
MO #36  (E2y #3 ) energy= 1.49780880051274   | 1.4751130832186    | 1.52050451780688   occ= 0
MO #37  (E1x #8 ) energy= 1.53798346090372   | 1.52856299141289   | 1.54740393039455   occ= 0
MO #38  (E1y #8 ) energy= 1.55174160644141   | 1.5501656413228    | 1.55331757156001   occ= 0
MO #39  (E2x #4 ) energy= 1.55727118637883   | 1.55310344660023   | 1.56143892615743   occ= 0
MO #40  (E2y #4 ) energy= 1.55727118637884   | 1.55310344660024   | 1.56143892615744   occ= 0
MO #41  (A1  #15) energy= 1.60640715909163   | 1.60257404922754   | 1.61024026895577   occ= 0
MO #42  (A1  #16) energy= 1.69690038165756   | 1.6947672599546    | 1.69903350336042   occ= 0
MO #43  (E3x #2 ) energy= 1.69752043505997   | 1.69631347452283   | 1.6987273955971    occ= 0
MO #44  (E3y #2 ) energy= 1.69752043505996   | 1.69631347452283   | 1.6987273955971    occ= 0
MO #45  (E1x #9 ) energy= 1.74935422199983   | 1.73864669053507   | 1.7600617534646    occ= 0
MO #46  (E1y #9 ) energy= 1.75536291123421   | 1.75386434668083   | 1.75686147578759   occ= 0
MO #47  (E2x #5 ) energy= 1.9219624425568    | 1.91852439506584   | 1.92540049004774   occ= 0
MO #48  (E2y #5 ) energy= 1.92196244255681   | 1.91852439506586   | 1.92540049004776   occ= 0
MO #49  (A1  #17) energy= 1.96828602537948   | 1.96430859117264   | 1.97226345958597   occ= 0
MO #50  (E1x #10) energy= 2.08135476619895   | 2.06809179972926   | 2.09461773266865   occ= 0
MO #51  (E1y #10) energy= 2.09393350353968   | 2.09172048095203   | 2.09614652612731   occ= 0
MO #52  (A1  #18) energy= 2.25861975882861   | 2.25307960346787   | 2.26415991418935   occ= 0
MO #53  (E1x #11) energy= 2.59491943736205   | 2.5507193131313    | 2.6391195615928    occ= 0
MO #54  (E1y #11) energy= 2.60414119347274   | 2.59827036975747   | 2.61001201718801   occ= 0
MO #55  (E2x #6 ) energy= 2.74709451909992   | 2.74314787734105   | 2.75104116085878   occ= 0
MO #56  (E2y #6 ) energy= 2.74709451909992   | 2.74314787734106   | 2.75104116085878   occ= 0
MO #57  (E1x #12) energy= 2.85058981791646   | 2.84652979054629   | 2.85464984528664   occ= 0
MO #58  (E1y #12) energy= 2.86171903871022   | 2.86093500322635   | 2.86250307419408   occ= 0
MO #59  (A1  #19) energy= 2.97253981489452   | 2.96856055822976   | 2.97651907155929   occ= 0
MO #60  (A1  #20) energy= 3.47182413019192   | 3.4637109316343    | 3.47993732874941   occ= 0
MO #61  (E4x #1 ) energy= 3.66105402393154   | 3.65389573961      | 3.66821230825308   occ= 0
MO #62  (E4y #1 ) energy= 3.66105402393155   | 3.65389573961001   | 3.66821230825309   occ= 0
MO #63  (E1x #13) energy= 3.72153733765865   | 3.70086732747447   | 3.74220734784288   occ= 0
MO #64  (E1y #13) energy= 3.7443705774589    | 3.74037513415457   | 3.74836602076322   occ= 0
MO #65  (E3x #3 ) energy= 3.84971387299837   | 3.84287246626381   | 3.85655527973294   occ= 0
MO #66  (E3y #3 ) energy= 3.84971387299837   | 3.8428724662638    | 3.85655527973294   occ= 0
MO #67  (A1  #21) energy= 3.97712695511024   | 3.96754769757155   | 3.98670621264883   occ= 0
MO #68  (E3x #4 ) energy= 4.08831900330855   | 4.07153699726599   | 4.10510100935111   occ= 0
MO #69  (E3y #4 ) energy= 4.08831900330856   | 4.071536997266     | 4.10510100935111   occ= 0
MO #70  (E2x #7 ) energy= 4.17902638093506   | 4.16799827332399   | 4.19005448854613   occ= 0
MO #71  (E2y #7 ) energy= 4.17902638093508   | 4.16799827332401   | 4.19005448854614   occ= 0
MO #72  (E2x #8 ) energy= 4.20920638735525   | 4.18561014060322   | 4.23280263410728   occ= 0
MO #73  (E2y #8 ) energy= 4.20920638735526   | 4.18561014060323   | 4.23280263410729   occ= 0
MO #74  (E1x #14) energy= 4.21500597303216   | 4.20263317926625   | 4.22737876679806   occ= 0
MO #75  (A1  #22) energy= 4.23266474126444   | 4.22129524952135   | 4.24403423300751   occ= 0
MO #76  (E1y #14) energy= 4.2395549405719    | 4.23737793038879   | 4.241731950755     occ= 0
MO #77  (A1  #23) energy= 4.30597579308445   | 4.29952190460437   | 4.31242968156456   occ= 0
MO #78  (E1x #15) energy= 4.61941465200036   | 4.58993027975472   | 4.64889902424599   occ= 0
MO #79  (E1y #15) energy= 4.64290557064633   | 4.63780230001376   | 4.64800884127889   occ= 0
MO #80  (E2x #9 ) energy= 4.6876936568805    | 4.66656772384514   | 4.70881958991585   occ= 0
MO #81  (E2y #9 ) energy= 4.6876936568805    | 4.66656772384515   | 4.70881958991585   occ= 0
MO #82  (A1  #24) energy= 5.19860924225959   | 5.19315669844656   | 5.20406178607271   occ= 0
MO #83  (E1x #16) energy= 5.30437541376674   | 5.28927654571565   | 5.31947428181788   occ= 0
MO #84  (E1y #16) energy= 5.32926246271373   | 5.32628504868274   | 5.33223987674471   occ= 0
MO #85  (A1  #25) energy= 5.61461145262015   | 5.60181361504466   | 5.62740929019564   occ= 0
MO #86  (E3x #5 ) energy= 6.58812628043328   | 6.5873367001698    | 6.58891586069674   occ= 0
MO #87  (E3y #5 ) energy= 6.58812628043328   | 6.5873367001698    | 6.58891586069675   occ= 0
MO #88  (E2x #10) energy= 7.28471628784432   | 7.28260702167781   | 7.28682555401083   occ= 0
MO #89  (E2y #10) energy= 7.28471628784432   | 7.28260702167781   | 7.28682555401083   occ= 0
MO #90  (A1  #26) energy= 7.36743401617951   | 7.36533638720858   | 7.36953164515043   occ= 0
MO #91  (E1x #17) energy= 7.65543099967534   | 7.65246027454652   | 7.65840172480418   occ= 0
MO #92  (E1y #17) energy= 7.6654659766187    | 7.66481036716921   | 7.66612158606817   occ= 0
MO #93  (A1  #27) energy= 8.19187537955657   | 8.190274484548     | 8.19347627456515   occ= 0
MO #94  (E2x #11) energy= 8.49944497352222   | 8.49885032449585   | 8.5000396225486    occ= 0
MO #95  (E2y #11) energy= 8.49944497352223   | 8.49885032449586   | 8.50003962254861   occ= 0
MO #96  (E1x #18) energy= 8.8242032908818    | 8.8213077111836    | 8.82709887058002   occ= 0
MO #97  (E1y #18) energy= 8.83316884568756   | 8.83259616341996   | 8.83374152795518   occ= 0
MO #98  (E1x #19) energy= 9.1191455188786    | 9.1125084565074    | 9.12578258124983   occ= 0
MO #99  (E1y #19) energy= 9.13487785516615   | 9.13340641642564   | 9.13634929390667   occ= 0
MO #100 (A1  #28) energy= 9.44115643421049   | 9.43866548251544   | 9.44364738590573   occ= 0
MO #101 (E4x #2 ) energy= 10.6152709578805   | 10.5989244282698   | 10.6316174874911   occ= 0
MO #102 (E4y #2 ) energy= 10.6152709578805   | 10.5989244282698   | 10.6316174874911   occ= 0
MO #103 (E3x #6 ) energy= 10.7102223799014   | 10.6974652128422   | 10.7229795469607   occ= 0
MO #104 (E3y #6 ) energy= 10.7102223799014   | 10.6974652128421   | 10.7229795469606   occ= 0
MO #105 (A1  #29) energy= 10.7611802574138   | 10.754983506671    | 10.7673770081565   occ= 0
MO #106 (E1x #20) energy= 10.9117978030388   | 10.8695800149959   | 10.9540155910818   occ= 0
MO #107 (E1y #20) energy= 10.9495074373889   | 10.9419446172935   | 10.9570702574844   occ= 0
MO #108 (E2x #12) energy= 10.9574761796709   | 10.9475087338045   | 10.9674436255373   occ= 0
MO #109 (E2y #12) energy= 10.9574761796709   | 10.9475087338045   | 10.9674436255373   occ= 0
MO #110 (E1x #21) energy= 11.3469074481357   | 11.3326910656894   | 11.3611238305821   occ= 0
MO #111 (E1y #21) energy= 11.3876770949657   | 11.3844005074674   | 11.390953682464    occ= 0
MO #112 (A1  #30) energy= 11.4591203392215   | 11.4500995169148   | 11.4681411615282   occ= 0
MO #113 (A1  #31) energy= 11.828816632465    | 11.8176332659853   | 11.8399999989446   occ= 0
MO #114 (E3x #7 ) energy= 11.8608596370199   | 11.8347366431848   | 11.886982630855    occ= 0
MO #115 (E3y #7 ) energy= 11.8608596370199   | 11.8347366431848   | 11.886982630855    occ= 0
MO #116 (E2x #13) energy= 11.9899444648204   | 11.9716242686013   | 12.0082646610395   occ= 0
MO #117 (E2y #13) energy= 11.9899444648204   | 11.9716242686013   | 12.0082646610395   occ= 0
MO #118 (E1x #22) energy= 12.4335428645109   | 12.4125064113505   | 12.4545793176713   occ= 0
MO #119 (E1y #22) energy= 12.471931135581    | 12.4674400391491   | 12.4764222320128   occ= 0
MO #120 (E2x #14) energy= 12.7601723117577   | 12.729116470102    | 12.7912281534134   occ= 0
MO #121 (E2y #14) energy= 12.7601723117577   | 12.729116470102    | 12.7912281534134   occ= 0
MO #122 (E1x #23) energy= 13.4622586782783   | 13.4363601859339   | 13.4881571706228   occ= 0
MO #123 (E1y #23) energy= 13.4980975903142   | 13.4931260425817   | 13.5030691380467   occ= 0
MO #124 (A1  #32) energy= 13.5154643239263   | 13.5098575702417   | 13.5210710776109   occ= 0
MO #125 (A1  #33) energy= 15.50995016514     | 15.503327615907    | 15.516572714373    occ= 0
MO #126 (A1  #34) energy= 42.370036407959    | 42.3599981459757   | 42.3800746699432   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.87301
pop of  0 O 3s        0.00276
pop of  0 O 4s        0.00090
pop of  0 O 5s        0.00023
pop of  0 O 6s        0.00006
pop of  0 O 2px       0.99768
pop of  0 O 2py       1.99329
pop of  0 O 2pz       1.45222
pop of  0 O 3px       0.00028
pop of  0 O 3py       0.00144
pop of  0 O 3pz       0.00035
pop of  0 O 4px       0.00042
pop of  0 O 4py       0.00035
pop of  0 O 4pz       0.00171
pop of  0 O 5px       0.00002
pop of  0 O 5py       0.00016
pop of  0 O 5pz       0.00007
pop of  0 O 6px       0.00000
pop of  0 O 6py       0.00002
pop of  0 O 6pz       0.00003
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00130
pop of  0 O 3dz^2     0.00535
pop of  0 O 3dxz      0.00055
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00032
pop of  0 O 4dz^2     0.00048
pop of  0 O 4dxz      0.00011
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00005
pop of  0 O 5dz^2     0.00005
pop of  0 O 5dxz      0.00002
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00001
pop of  0 O 6dz^2     0.00010
pop of  0 O 6dxz      0.00000
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00015
pop of  0 O 4f 0      0.00045
pop of  0 O 4f 1      0.00001
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00006
pop of  0 O 5f 0      0.00006
pop of  0 O 5f 1      0.00002
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00001
pop of  0 O 6f 0      0.00002
pop of  0 O 6f 1      0.00001
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00002
pop of  0 O 5g 0      0.00010
pop of  0 O 5g 1      0.00001
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00001
pop of  0 O 6g 0      0.00003
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.65096
pop of  1 H 2s        0.00738
pop of  1 H 3s        0.00168
pop of  1 H 4s        0.00011
pop of  1 H 5s        0.00006
pop of  1 H 2px       0.00029
pop of  1 H 2py       0.00259
pop of  1 H 2pz       0.00094
pop of  1 H 3px       0.00028
pop of  1 H 3py       0.00002
pop of  1 H 3pz       0.00051
pop of  1 H 4px       0.00014
pop of  1 H 4py       0.00002
pop of  1 H 4pz       0.00003
pop of  1 H 5px       0.00002
pop of  1 H 5py       0.00000
pop of  1 H 5pz       0.00003
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00012
pop of  1 H 3dz^2     0.00010
pop of  1 H 3dxz      0.00003
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00000
pop of  1 H 4dz^2     0.00000
pop of  1 H 4dxz      0.00003
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00000
pop of  1 H 5dz^2     0.00003
pop of  1 H 5dxz      0.00007
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00000
pop of  1 H 4f 0      0.00008
pop of  1 H 4f 1      0.00001
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00004
pop of  1 H 5f 0      0.00011
pop of  1 H 5f 1      0.00000
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.33430
charge of  1H =      0.33430
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.86074
#INFO: **** input file is /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/main.py ****
import numpy as np
import sys
sys.path.append('../../../../nevpt2/src/')
import time
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

start = time.time()

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.12)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
#outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
#outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
#outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
#outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % BO_IAO_external_solver.solve_with_fci()[0])

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
#outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
VQE_settings.target_sector = 11
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])

x = np.load('PARAMETER_FILE.npy',allow_pickle=True).item()
VQE_settings.initial_point = x['opt_params']

VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])

end = time.time()

outfile.write("Total time execution %.2f s\n" % (end-start))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lab36.labcalcolo.lab', release='4.18.0-348.7.1.el8_5.x86_64', version='#1 SMP Tue Dec 21 19:02:23 UTC 2021', machine='x86_64', processor='x86_64')  Threads 12
Python 3.8.8 (default, Apr 13 2021, 19:58:26) 
[GCC 7.3.0]
numpy 1.20.1  scipy 1.6.2
Date: Tue Jan 25 20:46:24 2022
PySCF version 2.0.1
PySCF path  /home/studenti/alessandro.tammaro/.local/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       293.82

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmpk1wafzuo
max_memory 4000 MB (current use 570 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/studenti/alessandro.tammaro/Desktop/freezing_vqe_test/aug-cc-pvqz/radical/R_1.12/tmpk1wafzuo
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 570 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.243002010801814  LUMO = 0.304228278770597
Initial guess E= -75.3999378562968  |g|= 0.000402804
macro= 0  E= -75.3999379512429  delta_E= -9.49461e-08  |g|= 0.000402804  1 KF 4 JK
macro= 1  E= -75.3999379512429  delta_E= 1.42109e-14  |g|= 3.01456e-08  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3999379512429  |g|= 3.01456e-08  total 3 KF 9 JK
converged SCF energy = -75.3999379512429
u+d contributions  -0.00839672630695611
uu+dd contributions  -0.040251531251039516
ud contributions  -0.1449177210931912
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
after tapering qubits(H) =  6
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.008391563126987292
uu+dd contributions  -0.04024569828548615
ud contributions  -0.14490445983554884
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.0080593654976661
uu+dd contributions  -0.03996538566295031
ud contributions  -0.14482856662882268
     ┌───┐
q_0: ┤ X ├
     └───┘
q_1: ─────
     ┌───┐
q_2: ┤ X ├
     ├───┤
q_3: ┤ X ├
     └───┘
q_4: ─────
          
q_5: ─────
          
u+d contributions  -0.0080593654976661
uu+dd contributions  -0.03996538566295031
ud contributions  -0.14482856662882268
