#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 22:56:53 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.720000000000 AA    0.000000000000   0.000000000000   1.360602809687 Bohr

nuclear repulsion = 5.879746788
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         5.64
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpmq1lxylp
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpmq1lxylp
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.484583807820373  LUMO (A1) = 0.02783534421383
Initial guess E= -75.312516469008  |g|= 0.208598
macro= 0  E= -75.3196068597954  delta_E= -0.00709039  |g|= 0.208598  2 KF 5 JK
macro= 1  E= -75.3206736349624  delta_E= -0.00106678  |g|= 0.106337  2 KF 5 JK
macro= 2  E= -75.3192585846948  delta_E= 0.00141505  |g|= 0.064746  2 KF 5 JK
macro= 3  E= -75.3206038373405  delta_E= -0.00134525  |g|= 0.112158  2 KF 5 JK
macro= 4  E= -75.3195820713724  delta_E= 0.00102177  |g|= 0.0625083  2 KF 5 JK
macro= 5  E= -75.3206390235569  delta_E= -0.00105695  |g|= 0.10731  2 KF 5 JK
macro= 6  E= -75.3195200506749  delta_E= 0.00111897  |g|= 0.0627332  2 KF 5 JK
macro= 7  E= -75.3206357052465  delta_E= -0.00111565  |g|= 0.107961  2 KF 5 JK
macro= 8  E= -75.3195340388017  delta_E= 0.00110167  |g|= 0.0627798  2 KF 5 JK
macro= 9  E= -75.3206389167935  delta_E= -0.00110488  |g|= 0.107661  2 KF 5 JK
macro= 10  E= -75.3195094781733  delta_E= 0.00112944  |g|= 0.0626904  2 KF 5 JK
macro= 11  E= -75.3206411675376  delta_E= -0.00113169  |g|= 0.10813  2 KF 5 JK
macro= 12  E= -75.3195004157547  delta_E= 0.00114075  |g|= 0.0627109  2 KF 5 JK
macro= 13  E= -75.3206436254823  delta_E= -0.00114321  |g|= 0.108328  2 KF 5 JK
macro= 14  E= -75.3194862986494  delta_E= 0.00115733  |g|= 0.0626705  2 KF 5 JK
macro= 15  E= -75.3206460689525  delta_E= -0.00115977  |g|= 0.108614  2 KF 5 JK
macro= 16  E= -75.3194739488478  delta_E= 0.00117212  |g|= 0.0626497  2 KF 5 JK
macro= 17  E= -75.3206485169805  delta_E= -0.00117457  |g|= 0.108865  2 KF 5 JK
macro= 18  E= -75.3194610921456  delta_E= 0.00118742  |g|= 0.0626208  2 KF 5 JK
macro= 19  E= -75.3206509671923  delta_E= -0.00118988  |g|= 0.109122  2 KF 5 JK
macro= 20  E= -75.3194484559397  delta_E= 0.00120251  |g|= 0.0625935  2 KF 5 JK
macro= 21  E= -75.3206534152498  delta_E= -0.00120496  |g|= 0.109371  2 KF 5 JK
macro= 22  E= -75.3194358177891  delta_E= 0.0012176  |g|= 0.0625646  2 KF 5 JK
macro= 23  E= -75.3206558617485  delta_E= -0.00122004  |g|= 0.109617  2 KF 5 JK
macro= 24  E= -75.3194232567522  delta_E= 0.0012326  |g|= 0.0625352  2 KF 5 JK
macro= 25  E= -75.3206583049701  delta_E= -0.00123505  |g|= 0.109859  2 KF 5 JK
macro= 26  E= -75.3194107589258  delta_E= 0.00124755  |g|= 0.0625047  2 KF 5 JK
macro= 27  E= -75.3206607443956  delta_E= -0.00124999  |g|= 0.110097  2 KF 5 JK
macro= 28  E= -75.3193983385524  delta_E= 0.00126241  |g|= 0.0624734  2 KF 5 JK
macro= 29  E= -75.3206631790627  delta_E= -0.00126484  |g|= 0.110331  2 KF 5 JK
macro= 30  E= -75.3193860010224  delta_E= 0.00127718  |g|= 0.0624412  2 KF 5 JK
macro= 31  E= -75.3206656082005  delta_E= -0.00127961  |g|= 0.11056  2 KF 5 JK
macro= 32  E= -75.3193737538241  delta_E= 0.00129185  |g|= 0.0624081  2 KF 5 JK
macro= 33  E= -75.3206680309776  delta_E= -0.00129428  |g|= 0.110785  2 KF 5 JK
macro= 34  E= -75.3193616033228  delta_E= 0.00130643  |g|= 0.0623741  2 KF 5 JK
macro= 35  E= -75.3206704465899  delta_E= -0.00130884  |g|= 0.111006  2 KF 5 JK
macro= 36  E= -75.3193495556678  delta_E= 0.00132089  |g|= 0.0623392  2 KF 5 JK
macro= 37  E= -75.3206728542312  delta_E= -0.0013233  |g|= 0.111223  2 KF 5 JK
macro= 38  E= -75.3193376165434  delta_E= 0.00133524  |g|= 0.0623034  2 KF 5 JK
macro= 39  E= -75.3206752531034  delta_E= -0.00133764  |g|= 0.111435  2 KF 5 JK
macro= 40  E= -75.3193257912401  delta_E= 0.00134946  |g|= 0.0622668  2 KF 5 JK
macro= 41  E= -75.3206776424166  delta_E= -0.00135185  |g|= 0.111643  2 KF 5 JK
macro= 42  E= -75.3193140846423  delta_E= 0.00136356  |g|= 0.0622293  2 KF 5 JK
macro= 43  E= -75.3206800213904  delta_E= -0.00136594  |g|= 0.111847  2 KF 5 JK
macro= 44  E= -75.3193025012414  delta_E= 0.00137752  |g|= 0.062191  2 KF 5 JK
macro= 45  E= -75.3206823892559  delta_E= -0.00137989  |g|= 0.112047  2 KF 5 JK
macro= 46  E= -75.3192910451433  delta_E= 0.00139134  |g|= 0.0621519  2 KF 5 JK
macro= 47  E= -75.3206847452569  delta_E= -0.0013937  |g|= 0.112242  2 KF 5 JK
macro= 48  E= -75.3192797200774  delta_E= 0.00140503  |g|= 0.062112  2 KF 5 JK
macro= 49  E= -75.3206870886519  delta_E= -0.00140737  |g|= 0.112433  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3206870886519  |g|= 0.112433  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3206870886519

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpmq1lxylp
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpmq1lxylp
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1y) = -0.278981708179194  LUMO (A1) = 0.0294338866822993
Initial guess E= -75.3221170219528  |g|= 0.0369446
macro= 0  E= -75.3222514471266  delta_E= -0.000134425  |g|= 0.0369446  2 KF 5 JK
macro= 1  E= -75.322227729959  delta_E= 2.37172e-05  |g|= 0.0199806  2 KF 5 JK
macro= 2  E= -75.322250337336  delta_E= -2.26074e-05  |g|= 0.0294768  2 KF 5 JK
macro= 3  E= -75.3222292986234  delta_E= 2.10387e-05  |g|= 0.0198574  2 KF 5 JK
macro= 4  E= -75.3222467728206  delta_E= -1.74742e-05  |g|= 0.0293482  2 KF 5 JK
macro= 5  E= -75.3222297252675  delta_E= 1.70476e-05  |g|= 0.0203805  2 KF 5 JK
macro= 6  E= -75.3222472319702  delta_E= -1.75067e-05  |g|= 0.0293288  2 KF 5 JK
macro= 7  E= -75.3222301900318  delta_E= 1.70419e-05  |g|= 0.0204108  2 KF 5 JK
macro= 8  E= -75.3222476338036  delta_E= -1.74438e-05  |g|= 0.0291463  2 KF 5 JK
macro= 9  E= -75.3222312713569  delta_E= 1.63624e-05  |g|= 0.020427  2 KF 5 JK
macro= 10  E= -75.3222473478178  delta_E= -1.60765e-05  |g|= 0.0288567  2 KF 5 JK
macro= 11  E= -75.3222315764869  delta_E= 1.57713e-05  |g|= 0.020528  2 KF 5 JK
macro= 12  E= -75.3222471286526  delta_E= -1.55522e-05  |g|= 0.0287175  2 KF 5 JK
macro= 13  E= -75.3222315916834  delta_E= 1.5537e-05  |g|= 0.0206119  2 KF 5 JK
macro= 14  E= -75.3222470815465  delta_E= -1.54899e-05  |g|= 0.0286667  2 KF 5 JK
macro= 15  E= -75.3222315700872  delta_E= 1.55115e-05  |g|= 0.0206501  2 KF 5 JK
macro= 16  E= -75.3222470671944  delta_E= -1.54971e-05  |g|= 0.0286485  2 KF 5 JK
macro= 17  E= -75.322231548722  delta_E= 1.55185e-05  |g|= 0.0206664  2 KF 5 JK
macro= 18  E= -75.3222470530794  delta_E= -1.55044e-05  |g|= 0.0286423  2 KF 5 JK
macro= 19  E= -75.3222315320504  delta_E= 1.5521e-05  |g|= 0.0206739  2 KF 5 JK
macro= 20  E= -75.3222470375611  delta_E= -1.55055e-05  |g|= 0.0286406  2 KF 5 JK
macro= 21  E= -75.3222315173531  delta_E= 1.55202e-05  |g|= 0.0206776  2 KF 5 JK
macro= 22  E= -75.322247021067  delta_E= -1.55037e-05  |g|= 0.0286407  2 KF 5 JK
macro= 23  E= -75.3222315038044  delta_E= 1.55173e-05  |g|= 0.0206798  2 KF 5 JK
macro= 24  E= -75.3222470041085  delta_E= -1.55003e-05  |g|= 0.0286415  2 KF 5 JK
macro= 25  E= -75.3222314906677  delta_E= 1.55134e-05  |g|= 0.0206813  2 KF 5 JK
macro= 26  E= -75.3222469869586  delta_E= -1.54963e-05  |g|= 0.0286427  2 KF 5 JK
macro= 27  E= -75.3222314777381  delta_E= 1.55092e-05  |g|= 0.0206825  2 KF 5 JK
macro= 28  E= -75.3222469697338  delta_E= -1.5492e-05  |g|= 0.028644  2 KF 5 JK
macro= 29  E= -75.3222314648838  delta_E= 1.55049e-05  |g|= 0.0206836  2 KF 5 JK
macro= 30  E= -75.3222469524876  delta_E= -1.54876e-05  |g|= 0.0286454  2 KF 5 JK
macro= 31  E= -75.3222314520659  delta_E= 1.55004e-05  |g|= 0.0206847  2 KF 5 JK
macro= 32  E= -75.3222469352407  delta_E= -1.54832e-05  |g|= 0.0286468  2 KF 5 JK
macro= 33  E= -75.3222314392614  delta_E= 1.5496e-05  |g|= 0.0206858  2 KF 5 JK
macro= 34  E= -75.3222469180029  delta_E= -1.54787e-05  |g|= 0.0286482  2 KF 5 JK
macro= 35  E= -75.322231426464  delta_E= 1.54915e-05  |g|= 0.0206868  2 KF 5 JK
macro= 36  E= -75.322246900778  delta_E= -1.54743e-05  |g|= 0.0286496  2 KF 5 JK
macro= 37  E= -75.3222314136691  delta_E= 1.54871e-05  |g|= 0.0206879  2 KF 5 JK
macro= 38  E= -75.322246883567  delta_E= -1.54699e-05  |g|= 0.028651  2 KF 5 JK
macro= 39  E= -75.3222314008757  delta_E= 1.54827e-05  |g|= 0.0206889  2 KF 5 JK
macro= 40  E= -75.3222468663712  delta_E= -1.54655e-05  |g|= 0.0286524  2 KF 5 JK
macro= 41  E= -75.3222313880836  delta_E= 1.54783e-05  |g|= 0.0206899  2 KF 5 JK
macro= 42  E= -75.3222468491905  delta_E= -1.54611e-05  |g|= 0.0286538  2 KF 5 JK
macro= 43  E= -75.3222313752914  delta_E= 1.54739e-05  |g|= 0.020691  2 KF 5 JK
macro= 44  E= -75.3222468320252  delta_E= -1.54567e-05  |g|= 0.0286553  2 KF 5 JK
macro= 45  E= -75.3222313625001  delta_E= 1.54695e-05  |g|= 0.020692  2 KF 5 JK
macro= 46  E= -75.3222468148754  delta_E= -1.54524e-05  |g|= 0.0286567  2 KF 5 JK
macro= 47  E= -75.3222313497093  delta_E= 1.54652e-05  |g|= 0.020693  2 KF 5 JK
macro= 48  E= -75.3222467977406  delta_E= -1.5448e-05  |g|= 0.0286581  2 KF 5 JK
macro= 49  E= -75.3222313369192  delta_E= 1.54608e-05  |g|= 0.0206941  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3222313369192  |g|= 0.0206941  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3222313369192
**** SCF Summaries ****
Total Energy =                         -75.322231336919160
Nuclear Repulsion Energy =               5.879746788000000
One-electron Energy =                 -115.196658814587352
Two-electron Energy =                   33.994680689668186
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    1    0    0    0    0    0    0    0
single occ                     0    0    1    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.5815439761457  | -20.5985943644746  | -20.5644935878168  occ= 2
MO #2   (A1  #2 ) energy= -1.41957813516675  | -1.48542227397783  | -1.35373399635568  occ= 2
MO #3   (A1  #3 ) energy= -0.72395726106791  | -0.750551891032895 | -0.697362631102924 occ= 2
MO #4   (E1x #1 ) energy= -0.549694219356927 | -0.569073513591403 | -0.530314925122452 occ= 2
MO #5   (E1y #1 ) energy= -0.256323967751745 | -0.657750251776276 | 0.145102316272793  occ= 1
MO #6   (A1  #4 ) energy= 0.0294887640747435 | 0.0290867971185009 | 0.0298907310309764 occ= 0
MO #7   (A1  #5 ) energy= 0.114420786440349  | 0.114025315871703  | 0.114816257008948  occ= 0
MO #8   (E1y #2 ) energy= 0.127328372140617  | 0.12389179849889   | 0.130764945782343  occ= 0
MO #9   (E1x #2 ) energy= 0.130399215064081  | 0.129956539618861  | 0.130841890509302  occ= 0
MO #10  (A1  #6 ) energy= 0.164624518890098  | 0.163221204531618  | 0.166027833248619  occ= 0
MO #11  (A1  #7 ) energy= 0.227102655401537  | 0.226002612919343  | 0.228202697883728  occ= 0
MO #12  (E1y #3 ) energy= 0.229321165690938  | 0.226530758925425  | 0.232111572456452  occ= 0
MO #13  (E1x #3 ) energy= 0.232130344629208  | 0.231779240291674  | 0.232481448966743  occ= 0
MO #14  (A1  #8 ) energy= 0.386132748597235  | 0.383610969843138  | 0.388654527351452  occ= 0
MO #15  (E2x #1 ) energy= 0.471201665653478  | 0.466682675857983  | 0.475720655448972  occ= 0
MO #16  (E2y #1 ) energy= 0.471201665653476  | 0.466682675857983  | 0.475720655448971  occ= 0
MO #17  (A1  #9 ) energy= 0.536208168123795  | 0.532932457759311  | 0.539483878488275  occ= 0
MO #18  (E1y #4 ) energy= 0.556128850228426  | 0.550091378907436  | 0.562166321549409  occ= 0
MO #19  (E1x #4 ) energy= 0.561965406974812  | 0.561153847213586  | 0.562776966736046  occ= 0
MO #20  (E1y #5 ) energy= 0.628817416879745  | 0.617593062699057  | 0.640041771060421  occ= 0
MO #21  (E1x #5 ) energy= 0.631042426350167  | 0.62970637455473   | 0.632378478145594  occ= 0
MO #22  (A1  #10) energy= 0.646412719862705  | 0.645363440031115  | 0.647461999694312  occ= 0
MO #23  (E2x #2 ) energy= 0.670698372698063  | 0.669636170389939  | 0.671760575006185  occ= 0
MO #24  (E2y #2 ) energy= 0.670698372698069  | 0.669636170389945  | 0.67176057500619   occ= 0
MO #25  (A1  #11) energy= 0.688973711386981  | 0.685479191881614  | 0.692468230891916  occ= 0
MO #26  (E1y #6 ) energy= 0.722970416369687  | 0.706835727786513  | 0.739105104952854  occ= 0
MO #27  (E1x #6 ) energy= 0.729529520658273  | 0.727534750988945  | 0.7315242903276    occ= 0
MO #28  (A1  #12) energy= 0.919682041485284  | 0.91389862434354   | 0.925465458626226  occ= 0
MO #29  (E1y #7 ) energy= 1.26686824371858   | 1.24538486808867   | 1.28835161934848   occ= 0
MO #30  (A1  #13) energy= 1.27250930113686   | 1.26221963552959   | 1.28279896674445   occ= 0
MO #31  (E1x #7 ) energy= 1.27334089247378   | 1.27050425015466   | 1.2761775347929    occ= 0
MO #32  (E3x #1 ) energy= 1.33319399389684   | 1.32855851263875   | 1.33782947515494   occ= 0
MO #33  (E3y #1 ) energy= 1.33319399389684   | 1.32855851263875   | 1.33782947515494   occ= 0
MO #34  (E2x #3 ) energy= 1.50949198184879   | 1.48953624074253   | 1.52944772295504   occ= 0
MO #35  (E2y #3 ) energy= 1.50949198184878   | 1.48953624074252   | 1.52944772295503   occ= 0
MO #36  (A1  #14) energy= 1.52780716220751   | 1.52507277141887   | 1.5305415529963    occ= 0
MO #37  (E1y #8 ) energy= 1.53927935601863   | 1.53359370138367   | 1.54496501065359   occ= 0
MO #38  (E1x #8 ) energy= 1.55064379375349   | 1.54959616695383   | 1.55169142055314   occ= 0
MO #39  (A1  #15) energy= 1.62295601146624   | 1.61895794636829   | 1.62695407656802   occ= 0
MO #40  (E2x #4 ) energy= 1.62390351783625   | 1.61461396488253   | 1.63319307078997   occ= 0
MO #41  (E2y #4 ) energy= 1.62390351783626   | 1.61461396488254   | 1.63319307078999   occ= 0
MO #42  (E1y #9 ) energy= 1.6926120990563    | 1.68170430988192   | 1.70351988823068   occ= 0
MO #43  (E1x #9 ) energy= 1.70380238936803   | 1.70211791822999   | 1.70548686050603   occ= 0
MO #44  (A1  #16) energy= 1.72194692735697   | 1.7165519836634    | 1.72734187105037   occ= 0
MO #45  (E3x #2 ) energy= 1.75458154543187   | 1.75336012083181   | 1.75580297003193   occ= 0
MO #46  (E3y #2 ) energy= 1.75458154543187   | 1.75336012083181   | 1.75580297003193   occ= 0
MO #47  (E2x #5 ) energy= 1.7870370934816    | 1.78523865789373   | 1.78883552906947   occ= 0
MO #48  (E2y #5 ) energy= 1.78703709348162   | 1.78523865789374   | 1.78883552906949   occ= 0
MO #49  (A1  #17) energy= 1.91569410210005   | 1.9095321180552    | 1.92185608614562   occ= 0
MO #50  (E1y #10) energy= 1.94262765708178   | 1.92563047127592   | 1.95962484288758   occ= 0
MO #51  (E1x #10) energy= 1.95167147550755   | 1.94936181558161   | 1.95398113543349   occ= 0
MO #52  (A1  #18) energy= 2.76504095140032   | 2.76151362231243   | 2.76856828048837   occ= 0
MO #53  (E1y #11) energy= 3.00615483031136   | 2.96268294857223   | 3.04962671205049   occ= 0
MO #54  (E1x #11) energy= 3.02018828080752   | 3.01408794551748   | 3.02628861609755   occ= 0
MO #55  (E1y #12) energy= 3.15755057801813   | 3.14879193448453   | 3.16630922155176   occ= 0
MO #56  (E1x #12) energy= 3.1735481719131    | 3.17169589994471   | 3.17540044388146   occ= 0
MO #57  (A1  #19) energy= 3.23955425033283   | 3.23404527921067   | 3.24506322145666   occ= 0
MO #58  (E2x #6 ) energy= 3.33953187357325   | 3.33415192128447   | 3.34491182586201   occ= 0
MO #59  (E2y #6 ) energy= 3.33953187357327   | 3.3341519212845    | 3.34491182586203   occ= 0
MO #60  (A1  #20) energy= 3.390443268393     | 3.38139602802652   | 3.3994905087614    occ= 0
MO #61  (E4x #1 ) energy= 3.64586469303467   | 3.63874733428427   | 3.65298205178507   occ= 0
MO #62  (E4y #1 ) energy= 3.64586469303466   | 3.63874733428426   | 3.65298205178506   occ= 0
MO #63  (E1y #13) energy= 3.68043090475266   | 3.65410577471879   | 3.70675603478647   occ= 0
MO #64  (E1x #13) energy= 3.70322824910143   | 3.69882909582816   | 3.70762740237457   occ= 0
MO #65  (E3x #3 ) energy= 4.01162956965067   | 3.99693355310948   | 4.02632558619186   occ= 0
MO #66  (E3y #3 ) energy= 4.01162956965067   | 3.99693355310948   | 4.02632558619186   occ= 0
MO #67  (E1y #14) energy= 4.0580317884891    | 4.04833605145197   | 4.06772752552622   occ= 0
MO #68  (A1  #21) energy= 4.08050619897344   | 4.07228775203116   | 4.08872464591563   occ= 0
MO #69  (E1x #14) energy= 4.08379651664476   | 4.08171163921478   | 4.08588139407474   occ= 0
MO #70  (A1  #22) energy= 4.10135796230079   | 4.09264590392482   | 4.1100700206765    occ= 0
MO #71  (E2x #7 ) energy= 4.10167662861413   | 4.09557219673302   | 4.10778106049525   occ= 0
MO #72  (E2y #7 ) energy= 4.10167662861412   | 4.09557219673301   | 4.10778106049524   occ= 0
MO #73  (E3x #4 ) energy= 4.12215206930045   | 4.11329919688499   | 4.13100494171591   occ= 0
MO #74  (E3y #4 ) energy= 4.12215206930045   | 4.11329919688499   | 4.13100494171592   occ= 0
MO #75  (E2x #8 ) energy= 4.346244616479     | 4.30690681647827   | 4.38558241647975   occ= 0
MO #76  (E2y #8 ) energy= 4.34624461647902   | 4.30690681647829   | 4.38558241647977   occ= 0
MO #77  (E1y #15) energy= 4.99913224153636   | 4.98568883780641   | 5.01257564526628   occ= 0
MO #78  (A1  #23) energy= 5.01171477155189   | 5.00167248823768   | 5.02175705486618   occ= 0
MO #79  (E1x #15) energy= 5.0268934123845    | 5.0239158149512    | 5.02987100981779   occ= 0
MO #80  (E2x #9 ) energy= 5.03938855823676   | 5.03040064659198   | 5.04837646988157   occ= 0
MO #81  (E2y #9 ) energy= 5.03938855823669   | 5.0304006465919    | 5.0483764698815    occ= 0
MO #82  (A1  #24) energy= 5.41556318171468   | 5.40905135698913   | 5.42207500644081   occ= 0
MO #83  (E1y #16) energy= 6.30246608258967   | 6.27936154817899   | 6.32557061700038   occ= 0
MO #84  (E1x #16) energy= 6.32921632175235   | 6.32500844151147   | 6.33342420199312   occ= 0
MO #85  (A1  #25) energy= 6.51209331426396   | 6.50010623920166   | 6.5240803893246    occ= 0
MO #86  (E3x #5 ) energy= 7.03213336804518   | 7.02892777413714   | 7.03533896195321   occ= 0
MO #87  (E3y #5 ) energy= 7.03213336804517   | 7.02892777413714   | 7.03533896195321   occ= 0
MO #88  (E1y #17) energy= 7.78147448606061   | 7.77532000581746   | 7.78762896630376   occ= 0
MO #89  (E1x #17) energy= 7.79652617313215   | 7.79542299919681   | 7.79762934706751   occ= 0
MO #90  (A1  #26) energy= 8.02067928146224   | 8.0191770325485    | 8.02218153037625   occ= 0
MO #91  (E2x #10) energy= 8.27108393375249   | 8.2696252509004    | 8.27254261660456   occ= 0
MO #92  (E2y #10) energy= 8.27108393375243   | 8.26962525090034   | 8.27254261660451   occ= 0
MO #93  (A1  #27) energy= 8.4273559134637    | 8.42398191534369   | 8.43072991158365   occ= 0
MO #94  (E1y #18) energy= 8.83459026197556   | 8.82741729508957   | 8.84176322886159   occ= 0
MO #95  (E1x #18) energy= 8.85796636696381   | 8.856237906108     | 8.85969482781962   occ= 0
MO #96  (E2x #11) energy= 9.09584642775337   | 9.08845958635682   | 9.10323326914988   occ= 0
MO #97  (E2y #11) energy= 9.09584642775332   | 9.08845958635678   | 9.10323326914985   occ= 0
MO #98  (E1y #19) energy= 10.0588319942938   | 10.0383887583085   | 10.0792752302791   occ= 0
MO #99  (E1x #19) energy= 10.081146175986    | 10.0778750715935   | 10.0844172803784   occ= 0
MO #100 (E4x #2 ) energy= 10.603342078301    | 10.5870688147879   | 10.6196153418141   occ= 0
MO #101 (E4y #2 ) energy= 10.6033420783009   | 10.5870688147878   | 10.6196153418141   occ= 0
MO #102 (A1  #28) energy= 10.7668116457398   | 10.7626774985276   | 10.7709457929524   occ= 0
MO #103 (E3x #6 ) energy= 10.9299542138063   | 10.9172978365484   | 10.9426105910641   occ= 0
MO #104 (E3y #6 ) energy= 10.9299542138063   | 10.9172978365484   | 10.9426105910641   occ= 0
MO #105 (A1  #29) energy= 11.1293658648921   | 11.1202181616644   | 11.1385135681197   occ= 0
MO #106 (E1y #20) energy= 11.2053078023528   | 11.1723991392208   | 11.2382164654848   occ= 0
MO #107 (E1x #20) energy= 11.2490089084765   | 11.2423585874076   | 11.2556592295454   occ= 0
MO #108 (E2x #12) energy= 11.4919965684525   | 11.4802972265828   | 11.5036959103222   occ= 0
MO #109 (E2y #12) energy= 11.4919965684525   | 11.4802972265828   | 11.5036959103222   occ= 0
MO #110 (A1  #30) energy= 11.729591651959    | 11.7189350592841   | 11.7402482446339   occ= 0
MO #111 (E3x #7 ) energy= 11.8525683172037   | 11.8266314209949   | 11.8785052134126   occ= 0
MO #112 (E3y #7 ) energy= 11.8525683172037   | 11.8266314209949   | 11.8785052134126   occ= 0
MO #113 (E1y #21) energy= 11.9180630895316   | 11.9059986939137   | 11.9301274851494   occ= 0
MO #114 (E1x #21) energy= 11.9578857099904   | 11.9547075895242   | 11.9610638304567   occ= 0
MO #115 (E2x #13) energy= 12.4677687290001   | 12.4448325663822   | 12.490704891618    occ= 0
MO #116 (E2y #13) energy= 12.4677687290001   | 12.4448325663822   | 12.490704891618    occ= 0
MO #117 (E2x #14) energy= 13.2642373292622   | 13.2425854016487   | 13.2858892568756   occ= 0
MO #118 (E2y #14) energy= 13.2642373292621   | 13.2425854016486   | 13.2858892568756   occ= 0
MO #119 (A1  #31) energy= 13.9622546288625   | 13.9526633990802   | 13.9718458586435   occ= 0
MO #120 (E1y #22) energy= 14.1104682612462   | 14.0847985491416   | 14.1361379733508   occ= 0
MO #121 (E1x #22) energy= 14.1489802724525   | 14.1440959236892   | 14.1538646212159   occ= 0
MO #122 (A1  #32) energy= 16.6188128804237   | 16.6134664478038   | 16.624159313043    occ= 0
MO #123 (E1y #23) energy= 16.6967895592247   | 16.6819821335672   | 16.7115969848821   occ= 0
MO #124 (E1x #23) energy= 16.7307834635198   | 16.7275632685136   | 16.7340036585261   occ= 0
MO #125 (A1  #33) energy= 17.4322811856181   | 17.4277328297517   | 17.4368295414844   occ= 0
MO #126 (A1  #34) energy= 47.3771613490519   | 47.3685427669598   | 47.3857799311367   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.68952
pop of  0 O 3s        0.00678
pop of  0 O 4s        0.00173
pop of  0 O 5s        0.00004
pop of  0 O 6s        0.00000
pop of  0 O 2px       1.99190
pop of  0 O 2py       0.99609
pop of  0 O 2pz       1.66610
pop of  0 O 3px       0.00054
pop of  0 O 3py       0.00026
pop of  0 O 3pz       0.00555
pop of  0 O 4px       0.00048
pop of  0 O 4py       0.00040
pop of  0 O 4pz       0.00175
pop of  0 O 5px       0.00006
pop of  0 O 5py       0.00000
pop of  0 O 5pz       0.00048
pop of  0 O 6px       0.00001
pop of  0 O 6py       0.00000
pop of  0 O 6pz       0.00009
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00143
pop of  0 O 3dz^2     0.01929
pop of  0 O 3dxz      0.00308
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00010
pop of  0 O 4dz^2     0.00024
pop of  0 O 4dxz      0.00022
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00000
pop of  0 O 5dz^2     0.00038
pop of  0 O 5dxz      0.00001
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00000
pop of  0 O 6dz^2     0.00000
pop of  0 O 6dxz      0.00001
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00003
pop of  0 O 4f 0      0.00262
pop of  0 O 4f 1      0.00021
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00000
pop of  0 O 5f 0      0.00001
pop of  0 O 5f 1      0.00001
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00000
pop of  0 O 6f 0      0.00016
pop of  0 O 6f 1      0.00000
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00002
pop of  0 O 5g 0      0.00077
pop of  0 O 5g 1      0.00003
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00000
pop of  0 O 6g 0      0.00000
pop of  0 O 6g 1      0.00000
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.56518
pop of  1 H 2s        0.01787
pop of  1 H 3s        0.01432
pop of  1 H 4s        0.00156
pop of  1 H 5s        0.00027
pop of  1 H 2px       0.00272
pop of  1 H 2py       0.00057
pop of  1 H 2pz       0.00032
pop of  1 H 3px       0.00016
pop of  1 H 3py       0.00078
pop of  1 H 3pz       0.00022
pop of  1 H 4px       0.00000
pop of  1 H 4py       0.00004
pop of  1 H 4pz       0.00073
pop of  1 H 5px       0.00002
pop of  1 H 5py       0.00001
pop of  1 H 5pz       0.00006
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00000
pop of  1 H 3dz^2     0.00125
pop of  1 H 3dxz      0.00006
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00013
pop of  1 H 4dz^2     0.00081
pop of  1 H 4dxz      0.00010
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00003
pop of  1 H 5dz^2     0.00046
pop of  1 H 5dxz      0.00001
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00001
pop of  1 H 4f 0      0.00042
pop of  1 H 4f 1      0.00017
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00007
pop of  1 H 5f 0      0.00102
pop of  1 H 5f 1      0.00019
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.39042
charge of  1H =      0.39042
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.55263
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 23:05:42 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       291.65

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp34ywcqvp
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp34ywcqvp
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.256323967751756  LUMO = 0.676842614495405
Initial guess E= -75.3222442964922  |g|= 0.00100816
macro= 0  E= -75.3222446910176  delta_E= -3.94525e-07  |g|= 0.00100816  1 KF 4 JK
macro= 1  E= -75.3222446910176  delta_E= -1.42109e-14  |g|= 7.30798e-08  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3222446910176  |g|= 7.30798e-08  total 3 KF 9 JK
converged SCF energy = -75.3222446910176
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 23:06:23 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       338.05

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpri6sgj4r
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpri6sgj4r
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.256325910711844  LUMO = 0.676843095033174
Initial guess E= -75.3222442956951  |g|= 0.00100852
macro= 0  E= -75.3222446910176  delta_E= -3.95322e-07  |g|= 0.00100852  1 KF 3 JK
macro= 1  E= -75.3222446910176  delta_E= 0  |g|= 7.333e-08  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3222446910176  |g|= 7.333e-08  total 3 KF 8 JK
converged SCF energy = -75.3222446910176
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 23:07:18 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       397.97

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpdwp3ga8c
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpdwp3ga8c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.256634175817859  LUMO = 0.029479720290384
Initial guess E= -75.3229480097836  |g|= 0.011831
macro= 0  E= -75.3229780965014  delta_E= -3.00867e-05  |g|= 0.000423554  2 KF 7 JK
macro= 1  E= -75.3229780965015  delta_E= -9.9476e-14  |g|= 6.68196e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3229780965015  |g|= 6.68196e-06  total 4 KF 12 JK
converged SCF energy = -75.3229780965015
u+d contributions  -0.04992861116658957
uu+dd contributions  -0.08459215729779039
ud contributions  -0.19819916013099054
u+d contributions  -0.007927089945444879
uu+dd contributions  -0.04250261905754627
ud contributions  -0.15596354552071862
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 23:08:14 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       433.93

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp40rqrgqc
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp40rqrgqc
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.256996219895875  LUMO = 0.676709354878275
Initial guess E= -75.3222442890369  |g|= 0.000914613
macro= 0  E= -75.3222446910175  delta_E= -4.01981e-07  |g|= 0.000914613  1 KF 2 JK
macro= 1  E= -75.3222446910175  delta_E= 0  |g|= 1.06682e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3222446910175  |g|= 1.06682e-07  total 3 KF 7 JK
converged SCF energy = -75.3222446910175
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_0.72/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,0.72)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64')  Threads 1
Python 3.9.7 | packaged by conda-forge | (default, Sep  2 2021, 17:58:46) 
[Clang 11.1.0 ]
numpy 1.21.2  scipy 1.7.1
Date: Wed Jan  5 23:09:10 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/caltech_entanglement/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       498.85

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpe6959uku
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpe6959uku
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.257303021449073  LUMO = 0.0294908815626683
Initial guess E= -75.3229010075336  |g|= 0.00793418
macro= 0  E= -75.3229196525321  delta_E= -1.8645e-05  |g|= 0.00031136  2 KF 7 JK
macro= 1  E= -75.3229196525321  delta_E= -2.84217e-14  |g|= 5.02211e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3229196525321  |g|= 5.02211e-06  total 4 KF 12 JK
converged SCF energy = -75.3229196525321
u+d contributions  -0.015461114195424671
uu+dd contributions  -0.04187462907343742
ud contributions  -0.11698423900727699
u+d contributions  -0.003222898170193471
uu+dd contributions  -0.029627185488445836
ud contributions  -0.10473366796562417
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


 >>>>> AM I PREPARED?  False
qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
In the tapering subroutine, i=0, E(i)=-74.685162, i_min=-1
In the tapering subroutine, i=1, E(i)=-75.137112, i_min=0
In the tapering subroutine, i=2, E(i)=-75.322245, i_min=1
In the tapering subroutine, i=3, E(i)=-74.631149, i_min=2
In the tapering subroutine, i=4, E(i)=-75.317837, i_min=2
In the tapering subroutine, i=5, E(i)=-74.631072, i_min=2
In the tapering subroutine, i=6, E(i)=-74.752115, i_min=2
In the tapering subroutine, i=7, E(i)=-74.667820, i_min=2
In the tapering subroutine, i=8, E(i)=-75.137112, i_min=2
In the tapering subroutine, i=9, E(i)=-75.178238, i_min=2
In the tapering subroutine, i=10, E(i)=-74.659793, i_min=2
In the tapering subroutine, i=11, E(i)=-75.322245, i_min=2
In the tapering subroutine, i=12, E(i)=-74.647927, i_min=2
In the tapering subroutine, i=13, E(i)=-75.317837, i_min=2
In the tapering subroutine, i=14, E(i)=-74.667820, i_min=2
In the tapering subroutine, i=15, E(i)=-74.790874, i_min=2
after tapering qubits(H) =  4
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
          
q_0: ─────
     ┌───┐
q_1: ┤ X ├
     └───┘
q_2: ─────
          
q_3: ─────
          
u+d contributions  -0.0032229188976890875
uu+dd contributions  -0.029627192263620216
ud contributions  -0.10472606754249929
 >>>>> AM I PREPARED?  True
          
q_0: ─────
     ┌───┐
q_1: ┤ X ├
     └───┘
q_2: ─────
          
q_3: ─────
          
u+d contributions  -0.0032230876820136933
uu+dd contributions  -0.02962729834716503
ud contributions  -0.1047259629531462
 >>>>> AM I PREPARED?  True
          
q_0: ─────
     ┌───┐
q_1: ┤ X ├
     └───┘
q_2: ─────
          
q_3: ─────
          
u+d contributions  -0.0032230876820136933
uu+dd contributions  -0.02962729834716503
ud contributions  -0.1047259629531462
