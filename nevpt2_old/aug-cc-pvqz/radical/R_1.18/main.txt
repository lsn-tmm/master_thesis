#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:39:31 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   1.180000000000 AA    0.000000000000   0.000000000000   2.229876826987 Bohr

nuclear repulsion = 3.5876421079322
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         4.11
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp87ifd6i4
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp87ifd6i4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.412761104455358  LUMO (A1) = 0.0122029747358306
Initial guess E= -75.3705969823353  |g|= 0.220164
macro= 0  E= -75.3848060755708  delta_E= -0.0142091  |g|= 0.220164  2 KF 5 JK
macro= 1  E= -75.3811514195274  delta_E= 0.00365466  |g|= 0.0887308  2 KF 5 JK
macro= 2  E= -75.3843132105881  delta_E= -0.00316179  |g|= 0.127689  2 KF 5 JK
macro= 3  E= -75.3843913461466  delta_E= -7.81356e-05  |g|= 0.0796642  2 KF 5 JK
macro= 4  E= -75.3847143466804  delta_E= -0.000323001  |g|= 0.0909616  2 KF 5 JK
macro= 5  E= -75.3831501657576  delta_E= 0.00156418  |g|= 0.0610421  2 KF 5 JK
macro= 6  E= -75.3846774046335  delta_E= -0.00152724  |g|= 0.114847  2 KF 5 JK
macro= 7  E= -75.3831177585054  delta_E= 0.00155965  |g|= 0.0614302  2 KF 5 JK
macro= 8  E= -75.3846981664018  delta_E= -0.00158041  |g|= 0.115427  2 KF 5 JK
macro= 9  E= -75.3834885195694  delta_E= 0.00120965  |g|= 0.0630501  2 KF 5 JK
macro= 10  E= -75.3847128101068  delta_E= -0.00122429  |g|= 0.108845  2 KF 5 JK
macro= 11  E= -75.3833594495355  delta_E= 0.00135336  |g|= 0.062093  2 KF 5 JK
macro= 12  E= -75.3847166121391  delta_E= -0.00135716  |g|= 0.110961  2 KF 5 JK
macro= 13  E= -75.3833638950345  delta_E= 0.00135272  |g|= 0.0621286  2 KF 5 JK
macro= 14  E= -75.3847238434931  delta_E= -0.00135995  |g|= 0.110892  2 KF 5 JK
macro= 15  E= -75.38332584574  delta_E= 0.001398  |g|= 0.0619445  2 KF 5 JK
macro= 16  E= -75.3847298879105  delta_E= -0.00140404  |g|= 0.111537  2 KF 5 JK
macro= 17  E= -75.3833010341279  delta_E= 0.00142885  |g|= 0.061828  2 KF 5 JK
macro= 18  E= -75.3847363861242  delta_E= -0.00143535  |g|= 0.111954  2 KF 5 JK
macro= 19  E= -75.3832722301807  delta_E= 0.00146416  |g|= 0.0616851  2 KF 5 JK
macro= 20  E= -75.384742817079  delta_E= -0.00147059  |g|= 0.112426  2 KF 5 JK
macro= 21  E= -75.3832450122201  delta_E= 0.0014978  |g|= 0.0615466  2 KF 5 JK
macro= 22  E= -75.3847493171626  delta_E= -0.0015043  |g|= 0.112866  2 KF 5 JK
macro= 23  E= -75.3832175874339  delta_E= 0.00153173  |g|= 0.0614014  2 KF 5 JK
macro= 24  E= -75.3847558350999  delta_E= -0.00153825  |g|= 0.1133  2 KF 5 JK
macro= 25  E= -75.3831906185273  delta_E= 0.00156522  |g|= 0.0612531  2 KF 5 JK
macro= 26  E= -75.3847623729243  delta_E= -0.00157175  |g|= 0.113721  2 KF 5 JK
macro= 27  E= -75.3831639210754  delta_E= 0.00159845  |g|= 0.0611005  2 KF 5 JK
macro= 28  E= -75.3847689193501  delta_E= -0.001605  |g|= 0.114131  2 KF 5 JK
macro= 29  E= -75.3831376052019  delta_E= 0.00163131  |g|= 0.0609441  2 KF 5 JK
macro= 30  E= -75.3847754656929  delta_E= -0.00163786  |g|= 0.114529  2 KF 5 JK
macro= 31  E= -75.3831116706838  delta_E= 0.0016638  |g|= 0.060784  2 KF 5 JK
macro= 32  E= -75.3847820031867  delta_E= -0.00167033  |g|= 0.114915  2 KF 5 JK
macro= 33  E= -75.3830861545244  delta_E= 0.00169585  |g|= 0.0606204  2 KF 5 JK
macro= 34  E= -75.3847885226996  delta_E= -0.00170237  |g|= 0.115289  2 KF 5 JK
macro= 35  E= -75.3830610758903  delta_E= 0.00172745  |g|= 0.0604536  2 KF 5 JK
macro= 36  E= -75.3847950154998  delta_E= -0.00173394  |g|= 0.115652  2 KF 5 JK
macro= 37  E= -75.3830364572359  delta_E= 0.00175856  |g|= 0.0602838  2 KF 5 JK
macro= 38  E= -75.3848014727927  delta_E= -0.00176502  |g|= 0.116003  2 KF 5 JK
macro= 39  E= -75.383012316072  delta_E= 0.00178916  |g|= 0.0601114  2 KF 5 JK
macro= 40  E= -75.3848078861089  delta_E= -0.00179557  |g|= 0.116342  2 KF 5 JK
macro= 41  E= -75.3829886683426  delta_E= 0.00181922  |g|= 0.0599367  2 KF 5 JK
macro= 42  E= -75.384814247183  delta_E= -0.00182558  |g|= 0.11667  2 KF 5 JK
macro= 43  E= -75.3829655271315  delta_E= 0.00184872  |g|= 0.05976  2 KF 5 JK
macro= 44  E= -75.3848205481081  delta_E= -0.00185502  |g|= 0.116987  2 KF 5 JK
macro= 45  E= -75.3829429033196  delta_E= 0.00187764  |g|= 0.0595816  2 KF 5 JK
macro= 46  E= -75.3848267813328  delta_E= -0.00188388  |g|= 0.117292  2 KF 5 JK
macro= 47  E= -75.3829208054391  delta_E= 0.00190598  |g|= 0.0594018  2 KF 5 JK
macro= 48  E= -75.3848329397322  delta_E= -0.00191213  |g|= 0.117587  2 KF 5 JK
macro= 49  E= -75.382899239889  delta_E= 0.0019337  |g|= 0.059221  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.382899239889  |g|= 0.059221  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.382899239889

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp87ifd6i4
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp87ifd6i4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.209630253463338  LUMO (A1) = 0.025519271503222
Initial guess E= -75.3856518678694  |g|= 0.0610497
macro= 0  E= -75.3848165868424  delta_E= 0.000835281  |g|= 0.0610497  2 KF 5 JK
macro= 1  E= -75.3861937755533  delta_E= -0.00137719  |g|= 0.0730037  2 KF 5 JK
macro= 2  E= -75.3847489346367  delta_E= 0.00144484  |g|= 0.0275232  2 KF 5 JK
macro= 3  E= -75.3861730465887  delta_E= -0.00142411  |g|= 0.0751622  2 KF 5 JK
macro= 4  E= -75.3847467607795  delta_E= 0.00142629  |g|= 0.0280228  2 KF 5 JK
macro= 5  E= -75.3861690065565  delta_E= -0.00142225  |g|= 0.0752041  2 KF 5 JK
macro= 6  E= -75.3847439596383  delta_E= 0.00142505  |g|= 0.0289096  2 KF 5 JK
macro= 7  E= -75.3861660810797  delta_E= -0.00142212  |g|= 0.0752684  2 KF 5 JK
macro= 8  E= -75.384741784632  delta_E= 0.0014243  |g|= 0.0290779  2 KF 5 JK
macro= 9  E= -75.3861601168289  delta_E= -0.00141833  |g|= 0.0754344  2 KF 5 JK
macro= 10  E= -75.3847441548875  delta_E= 0.00141596  |g|= 0.0295375  2 KF 5 JK
macro= 11  E= -75.3861564140019  delta_E= -0.00141226  |g|= 0.0753987  2 KF 5 JK
macro= 12  E= -75.3847431840619  delta_E= 0.00141323  |g|= 0.0298711  2 KF 5 JK
macro= 13  E= -75.3861514496278  delta_E= -0.00140827  |g|= 0.0755033  2 KF 5 JK
macro= 14  E= -75.384744808626  delta_E= 0.00140664  |g|= 0.0302383  2 KF 5 JK
macro= 15  E= -75.3861468706824  delta_E= -0.00140206  |g|= 0.0755184  2 KF 5 JK
macro= 16  E= -75.3847456484602  delta_E= 0.00140122  |g|= 0.030604  2 KF 5 JK
macro= 17  E= -75.386142064821  delta_E= -0.00139642  |g|= 0.0755652  2 KF 5 JK
macro= 18  E= -75.3847472271166  delta_E= 0.00139484  |g|= 0.0309685  2 KF 5 JK
macro= 19  E= -75.3861372144012  delta_E= -0.00138999  |g|= 0.0755918  2 KF 5 JK
macro= 20  E= -75.384748950427  delta_E= 0.00138826  |g|= 0.0313361  2 KF 5 JK
macro= 21  E= -75.3861322828409  delta_E= -0.00138333  |g|= 0.0756171  2 KF 5 JK
macro= 22  E= -75.3847509953393  delta_E= 0.00138129  |g|= 0.0317039  2 KF 5 JK
macro= 23  E= -75.3861272773481  delta_E= -0.00137628  |g|= 0.0756357  2 KF 5 JK
macro= 24  E= -75.3847533002962  delta_E= 0.00137398  |g|= 0.0320727  2 KF 5 JK
macro= 25  E= -75.3861222005392  delta_E= -0.0013689  |g|= 0.0756491  2 KF 5 JK
macro= 26  E= -75.3860247525539  delta_E= 9.7448e-05  |g|= 0.032442  2 KF 5 JK
macro= 27  E= -75.3861276439444  delta_E= -0.000102891  |g|= 0.037248  2 KF 5 JK
macro= 28  E= -75.3860400589618  delta_E= 8.7585e-05  |g|= 0.0270404  2 KF 5 JK
macro= 29  E= -75.3861315855416  delta_E= -9.15266e-05  |g|= 0.0362315  2 KF 5 JK
macro= 30  E= -75.3860481356361  delta_E= 8.34499e-05  |g|= 0.0273344  2 KF 5 JK
macro= 31  E= -75.3861193076375  delta_E= -7.1172e-05  |g|= 0.0362294  2 KF 5 JK
macro= 32  E= -75.3860557248782  delta_E= 6.35828e-05  |g|= 0.0280013  2 KF 5 JK
macro= 33  E= -75.3861239215618  delta_E= -6.81967e-05  |g|= 0.0357774  2 KF 5 JK
macro= 34  E= -75.3860595880706  delta_E= 6.43335e-05  |g|= 0.027784  2 KF 5 JK
macro= 35  E= -75.3861223426475  delta_E= -6.27546e-05  |g|= 0.0357901  2 KF 5 JK
macro= 36  E= -75.3860583917566  delta_E= 6.39509e-05  |g|= 0.0279017  2 KF 5 JK
macro= 37  E= -75.386125438493  delta_E= -6.70467e-05  |g|= 0.0358816  2 KF 5 JK
macro= 38  E= -75.3860606363612  delta_E= 6.48021e-05  |g|= 0.0277445  2 KF 5 JK
macro= 39  E= -75.3861245029198  delta_E= -6.38666e-05  |g|= 0.0358749  2 KF 5 JK
macro= 40  E= -75.3860586852983  delta_E= 6.58176e-05  |g|= 0.0278274  2 KF 5 JK
macro= 41  E= -75.3861264902161  delta_E= -6.78049e-05  |g|= 0.0360242  2 KF 5 JK
macro= 42  E= -75.3860598533115  delta_E= 6.66369e-05  |g|= 0.0277253  2 KF 5 JK
macro= 43  E= -75.3861260731686  delta_E= -6.62199e-05  |g|= 0.0360243  2 KF 5 JK
macro= 44  E= -75.386058105591  delta_E= 6.79676e-05  |g|= 0.0277719  2 KF 5 JK
macro= 45  E= -75.3861272815741  delta_E= -6.9176e-05  |g|= 0.0361586  2 KF 5 JK
macro= 46  E= -75.3860584348306  delta_E= 6.88467e-05  |g|= 0.027713  2 KF 5 JK
macro= 47  E= -75.3861272412406  delta_E= -6.88064e-05  |g|= 0.036184  2 KF 5 JK
macro= 48  E= -75.3860570425253  delta_E= 7.01987e-05  |g|= 0.0277333  2 KF 5 JK
macro= 49  E= -75.3861280104744  delta_E= -7.09679e-05  |g|= 0.0362942  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.3861280104744  |g|= 0.0362942  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.3861280104744
**** SCF Summaries ****
Total Energy =                         -75.386128010474437
Nuclear Repulsion Energy =               3.587642107932204
One-electron Energy =                 -111.171595693408520
Two-electron Energy =                   32.197825575001893
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    0    1    0    0    0    0    0    0
single occ                     0    1    0    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6533964055637  | -20.6701696142871  | -20.6366231968403  occ= 2
MO #2   (A1  #2 ) energy= -1.26599404325643  | -1.33878141723996  | -1.1932066692729   occ= 2
MO #3   (A1  #3 ) energy= -0.608826758808834 | -0.625818380844601 | -0.591835136773068 occ= 2
MO #4   (E1y #1 ) energy= -0.538651626283261 | -0.557743343888838 | -0.519559908677683 occ= 2
MO #5   (E1x #1 ) energy= -0.248847958671058 | -0.642206875580562 | 0.144510958238446  occ= 1
MO #6   (A1  #4 ) energy= 0.0246197692603138 | 0.0236667726081179 | 0.0255727659125098 occ= 0
MO #7   (A1  #5 ) energy= 0.108095685130337  | 0.106509187073434  | 0.109682183187251  occ= 0
MO #8   (E1x #2 ) energy= 0.140203287253733  | 0.134506444461693  | 0.145900130045772  occ= 0
MO #9   (E1y #2 ) energy= 0.142241524726251  | 0.141608213223005  | 0.142874836229497  occ= 0
MO #10  (A1  #6 ) energy= 0.148909783150808  | 0.146828096063029  | 0.150991470238583  occ= 0
MO #11  (E1x #3 ) energy= 0.209458349324905  | 0.207930967740241  | 0.210985730909567  occ= 0
MO #12  (E1y #3 ) energy= 0.211942030368258  | 0.21176250619974   | 0.212121554536774  occ= 0
MO #13  (A1  #7 ) energy= 0.223214160167599  | 0.221153566529458  | 0.225274753805744  occ= 0
MO #14  (A1  #8 ) energy= 0.306556569414845  | 0.303027933336015  | 0.31008520549375   occ= 0
MO #15  (E2x #1 ) energy= 0.478501112509268  | 0.473370307533646  | 0.483631917484889  occ= 0
MO #16  (E2y #1 ) energy= 0.478501112509267  | 0.473370307533646  | 0.483631917484888  occ= 0
MO #17  (A1  #9 ) energy= 0.490981000594181  | 0.488093092841     | 0.4938689083474    occ= 0
MO #18  (E1x #4 ) energy= 0.540622735296059  | 0.53540665959283   | 0.54583881099928   occ= 0
MO #19  (E1y #4 ) energy= 0.545149152611532  | 0.544463033420652  | 0.545835271802423  occ= 0
MO #20  (A1  #10) energy= 0.612144845891027  | 0.610185402177529  | 0.614104289604523  occ= 0
MO #21  (E1x #5 ) energy= 0.659156605045757  | 0.647718001101725  | 0.670595208989794  occ= 0
MO #22  (E1y #5 ) energy= 0.661544557691145  | 0.660114035280914  | 0.662975080101379  occ= 0
MO #23  (E2x #2 ) energy= 0.69022713313145   | 0.689558633206566  | 0.690895633056332  occ= 0
MO #24  (E2y #2 ) energy= 0.690227133131453  | 0.689558633206567  | 0.690895633056333  occ= 0
MO #25  (A1  #11) energy= 0.695478274100887  | 0.693085392740533  | 0.69787115546131   occ= 0
MO #26  (E1x #6 ) energy= 0.752537414469766  | 0.726778105804792  | 0.778296723134744  occ= 0
MO #27  (E1y #6 ) energy= 0.75525136064522   | 0.752275173302306  | 0.758227547988137  occ= 0
MO #28  (A1  #12) energy= 0.794097037898772  | 0.789392922501621  | 0.798801153296049  occ= 0
MO #29  (E1x #7 ) energy= 1.08427470836905   | 1.07717306152587   | 1.09137635521222   occ= 0
MO #30  (E1y #7 ) energy= 1.09088895271829   | 1.08987146110182   | 1.09190644433478   occ= 0
MO #31  (A1  #13) energy= 1.20440262671852   | 1.19614175729791   | 1.21266349613917   occ= 0
MO #32  (E3x #1 ) energy= 1.32130260835917   | 1.31678435770778   | 1.32582085901055   occ= 0
MO #33  (E3y #1 ) energy= 1.32130260835917   | 1.31678435770778   | 1.32582085901055   occ= 0
MO #34  (A1  #14) energy= 1.33576094520409   | 1.33090653874177   | 1.3406153516664    occ= 0
MO #35  (E2x #3 ) energy= 1.49222046465239   | 1.47147033277188   | 1.51297059653289   occ= 0
MO #36  (E2y #3 ) energy= 1.49222046465239   | 1.47147033277189   | 1.5129705965329    occ= 0
MO #37  (E1x #8 ) energy= 1.53367579344967   | 1.52329863317045   | 1.54405295372889   occ= 0
MO #38  (E1y #8 ) energy= 1.54669907102401   | 1.54499364965983   | 1.5484044923882    occ= 0
MO #39  (E2x #4 ) energy= 1.55220383557701   | 1.54578237332833   | 1.55862529782569   occ= 0
MO #40  (E2y #4 ) energy= 1.55220383557701   | 1.54578237332832   | 1.55862529782568   occ= 0
MO #41  (A1  #15) energy= 1.59658100977562   | 1.59258871193966   | 1.60057330761156   occ= 0
MO #42  (E3x #2 ) energy= 1.68698398310696   | 1.68568810872225   | 1.68827985749167   occ= 0
MO #43  (E3y #2 ) energy= 1.68698398310696   | 1.68568810872225   | 1.68827985749167   occ= 0
MO #44  (A1  #16) energy= 1.72359711205565   | 1.7213787756537    | 1.72581544845814   occ= 0
MO #45  (E1x #9 ) energy= 1.77010709404809   | 1.7589210529426    | 1.78129313515356   occ= 0
MO #46  (E1y #9 ) energy= 1.77606057463874   | 1.77446945393487   | 1.77765169534261   occ= 0
MO #47  (E2x #5 ) energy= 1.93982205145099   | 1.93650843049787   | 1.94313567240411   occ= 0
MO #48  (E2y #5 ) energy= 1.939822051451     | 1.93650843049788   | 1.94313567240412   occ= 0
MO #49  (A1  #17) energy= 1.9935683128184    | 1.99005360480346   | 1.99708302083332   occ= 0
MO #50  (E1x #10) energy= 2.04279707577579   | 2.0305696239511    | 2.05502452760049   occ= 0
MO #51  (E1y #10) energy= 2.05479475110238   | 2.05273644087876   | 2.05685306132601   occ= 0
MO #52  (A1  #18) energy= 2.19785523525604   | 2.19186027312793   | 2.20385019738415   occ= 0
MO #53  (E1x #11) energy= 2.60770226982686   | 2.56361946178307   | 2.65178507787065   occ= 0
MO #54  (E1y #11) energy= 2.61651510840697   | 2.61062668283654   | 2.6224035339774    occ= 0
MO #55  (E2x #6 ) energy= 2.67483910243976   | 2.67124663185918   | 2.67843157302034   occ= 0
MO #56  (E2y #6 ) energy= 2.67483910243976   | 2.67124663185918   | 2.67843157302034   occ= 0
MO #57  (E1x #12) energy= 2.81411352238472   | 2.81092524778929   | 2.81730179698014   occ= 0
MO #58  (E1y #12) energy= 2.82441921440687   | 2.82374624844364   | 2.82509218037011   occ= 0
MO #59  (A1  #19) energy= 2.93176158200486   | 2.92748645300173   | 2.93603671100797   occ= 0
MO #60  (A1  #20) energy= 3.39329143425258   | 3.38586578529524   | 3.40071708320991   occ= 0
MO #61  (E4x #1 ) energy= 3.6611491338903    | 3.65385096860857   | 3.66844729917203   occ= 0
MO #62  (E4y #1 ) energy= 3.66114913389029   | 3.65385096860856   | 3.66844729917203   occ= 0
MO #63  (E1x #13) energy= 3.66937030603198   | 3.64934080342623   | 3.68939980863774   occ= 0
MO #64  (E1y #13) energy= 3.69092766399829   | 3.6870828535798    | 3.6947724744168    occ= 0
MO #65  (E3x #3 ) energy= 3.82535732002846   | 3.81873135714321   | 3.83198328291371   occ= 0
MO #66  (E3y #3 ) energy= 3.82535732002846   | 3.81873135714322   | 3.83198328291372   occ= 0
MO #67  (A1  #21) energy= 3.97159093024211   | 3.96141588958723   | 3.98176597089688   occ= 0
MO #68  (E3x #4 ) energy= 4.08441515918676   | 4.06749610658467   | 4.10133421178885   occ= 0
MO #69  (E3y #4 ) energy= 4.08441515918676   | 4.06749610658467   | 4.10133421178885   occ= 0
MO #70  (E2x #7 ) energy= 4.1608243014747    | 4.14456035756742   | 4.17708824538198   occ= 0
MO #71  (E2y #7 ) energy= 4.16082430147469   | 4.14456035756741   | 4.17708824538197   occ= 0
MO #72  (E2x #8 ) energy= 4.19795476767867   | 4.1821179328891    | 4.21379160246823   occ= 0
MO #73  (E2y #8 ) energy= 4.19795476767866   | 4.18211793288909   | 4.21379160246822   occ= 0
MO #74  (E1x #14) energy= 4.2040901601596    | 4.19256648097226   | 4.21561383934695   occ= 0
MO #75  (E1y #14) energy= 4.22880825784845   | 4.22671182091885   | 4.23090469477805   occ= 0
MO #76  (A1  #22) energy= 4.25837154686188   | 4.24994985638034   | 4.2667932373434    occ= 0
MO #77  (A1  #23) energy= 4.28009938391699   | 4.27141758236206   | 4.28878118547184   occ= 0
MO #78  (E1x #15) energy= 4.5569946707168    | 4.52838191225402   | 4.58560742917957   occ= 0
MO #79  (E1y #15) energy= 4.58052168367453   | 4.57556424547318   | 4.58547912187586   occ= 0
MO #80  (E2x #9 ) energy= 4.63187092260519   | 4.60893086317727   | 4.65481098203311   occ= 0
MO #81  (E2y #9 ) energy= 4.63187092260518   | 4.60893086317726   | 4.6548109820331    occ= 0
MO #82  (A1  #24) energy= 5.10337766472218   | 5.0982466190037    | 5.10850871044064   occ= 0
MO #83  (E1x #16) energy= 5.24717453131126   | 5.23144453481853   | 5.26290452780398   occ= 0
MO #84  (E1y #16) energy= 5.27184101369657   | 5.26876347676851   | 5.27491855062463   occ= 0
MO #85  (A1  #25) energy= 5.61633730524872   | 5.60322828160091   | 5.62944632889633   occ= 0
MO #86  (E3x #5 ) energy= 6.56342552091314   | 6.56279370702008   | 6.5640573348062    occ= 0
MO #87  (E3y #5 ) energy= 6.56342552091314   | 6.56279370702009   | 6.5640573348062    occ= 0
MO #88  (E2x #10) energy= 7.14064634657161   | 7.13888774471113   | 7.14240494843208   occ= 0
MO #89  (E2y #10) energy= 7.14064634657161   | 7.13888774471112   | 7.14240494843208   occ= 0
MO #90  (A1  #26) energy= 7.28179353580878   | 7.28000651777412   | 7.28358055384346   occ= 0
MO #91  (E1x #17) energy= 7.60576945519083   | 7.60289387164801   | 7.60864503873365   occ= 0
MO #92  (E1y #17) energy= 7.61549004600852   | 7.61485054487342   | 7.61612954714362   occ= 0
MO #93  (A1  #27) energy= 8.09238169813045   | 8.09124876523622   | 8.0935146310247    occ= 0
MO #94  (E2x #11) energy= 8.47943152273513   | 8.47899235970803   | 8.47987068576223   occ= 0
MO #95  (E2y #11) energy= 8.47943152273514   | 8.47899235970804   | 8.47987068576224   occ= 0
MO #96  (E1x #18) energy= 8.84520861152688   | 8.84254926119441   | 8.84786796185938   occ= 0
MO #97  (E1y #18) energy= 8.8542245455899    | 8.853638170236     | 8.85481092094381   occ= 0
MO #98  (E1x #19) energy= 8.89177362320138   | 8.88627738191943   | 8.89726986448332   occ= 0
MO #99  (E1y #19) energy= 8.90385967203358   | 8.90273542642293   | 8.90498391764422   occ= 0
MO #100 (A1  #28) energy= 9.4165738127201    | 9.41453642807348   | 9.41861119736678   occ= 0
MO #101 (A1  #29) energy= 10.4700617532886   | 10.4640813406674   | 10.4760421659098   occ= 0
MO #102 (E4x #2 ) energy= 10.6104725488836   | 10.5944194877532   | 10.6265256100141   occ= 0
MO #103 (E4y #2 ) energy= 10.6104725488836   | 10.5944194877531   | 10.626525610014    occ= 0
MO #104 (E3x #6 ) energy= 10.6911761730807   | 10.6786489265959   | 10.7037034195655   occ= 0
MO #105 (E3y #6 ) energy= 10.6911761730807   | 10.6786489265959   | 10.7037034195655   occ= 0
MO #106 (E1x #20) energy= 10.8619165292705   | 10.8206528604662   | 10.9031801980748   occ= 0
MO #107 (E1y #20) energy= 10.8999434275928   | 10.892546321913    | 10.9073405332726   occ= 0
MO #108 (E2x #12) energy= 10.9081380851041   | 10.8983205659426   | 10.9179556042656   occ= 0
MO #109 (E2y #12) energy= 10.9081380851041   | 10.8983205659426   | 10.9179556042656   occ= 0
MO #110 (E1x #21) energy= 11.1991245579236   | 11.1857524729775   | 11.2124966428698   occ= 0
MO #111 (E1y #21) energy= 11.2412658001435   | 11.2380252246724   | 11.2445063756145   occ= 0
MO #112 (A1  #30) energy= 11.389969473327    | 11.3815657619971   | 11.3983731846569   occ= 0
MO #113 (A1  #31) energy= 11.7845217981233   | 11.7734184802453   | 11.7956251160014   occ= 0
MO #114 (E3x #7 ) energy= 11.8512533552674   | 11.8256830697815   | 11.8768236407534   occ= 0
MO #115 (E3y #7 ) energy= 11.8512533552674   | 11.8256830697815   | 11.8768236407534   occ= 0
MO #116 (E2x #13) energy= 11.9683005900454   | 11.9503459150153   | 11.9862552650756   occ= 0
MO #117 (E2y #13) energy= 11.9683005900455   | 11.9503459150153   | 11.9862552650756   occ= 0
MO #118 (E1x #22) energy= 12.4464417199429   | 12.4259881663499   | 12.466895273536    occ= 0
MO #119 (E1y #22) energy= 12.4858050181763   | 12.4814433484274   | 12.4901666879252   occ= 0
MO #120 (E2x #14) energy= 12.7323108347021   | 12.7018592703331   | 12.7627623990711   occ= 0
MO #121 (E2y #14) energy= 12.7323108347021   | 12.7018592703331   | 12.7627623990711   occ= 0
MO #122 (E1x #23) energy= 13.1804282972872   | 13.1534086611744   | 13.2074479333999   occ= 0
MO #123 (E1y #23) energy= 13.21722714772     | 13.2121236373934   | 13.2223306580466   occ= 0
MO #124 (A1  #32) energy= 13.3162826041817   | 13.3105701400453   | 13.321995068318    occ= 0
MO #125 (A1  #33) energy= 14.9958717286927   | 14.9887844200835   | 15.002959037302    occ= 0
MO #126 (A1  #34) energy= 42.2800844782824   | 42.2702813448889   | 42.2898876116731   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.89118
pop of  0 O 3s        0.00222
pop of  0 O 4s        0.00075
pop of  0 O 5s        0.00021
pop of  0 O 6s        0.00006
pop of  0 O 2px       0.99828
pop of  0 O 2py       1.99407
pop of  0 O 2pz       1.42802
pop of  0 O 3px       0.00001
pop of  0 O 3py       0.00118
pop of  0 O 3pz       0.00014
pop of  0 O 4px       0.00023
pop of  0 O 4py       0.00044
pop of  0 O 4pz       0.00158
pop of  0 O 5px       0.00004
pop of  0 O 5py       0.00020
pop of  0 O 5pz       0.00008
pop of  0 O 6px       0.00001
pop of  0 O 6py       0.00003
pop of  0 O 6pz       0.00002
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00107
pop of  0 O 3dz^2     0.00442
pop of  0 O 3dxz      0.00054
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00028
pop of  0 O 4dz^2     0.00040
pop of  0 O 4dxz      0.00014
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00006
pop of  0 O 5dz^2     0.00004
pop of  0 O 5dxz      0.00003
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00001
pop of  0 O 6dz^2     0.00009
pop of  0 O 6dxz      0.00001
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00013
pop of  0 O 4f 0      0.00032
pop of  0 O 4f 1      0.00001
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00005
pop of  0 O 5f 0      0.00005
pop of  0 O 5f 1      0.00002
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00001
pop of  0 O 6f 0      0.00001
pop of  0 O 6f 1      0.00000
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00002
pop of  0 O 5g 0      0.00006
pop of  0 O 5g 1      0.00001
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00001
pop of  0 O 6g 0      0.00002
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.66160
pop of  1 H 2s        0.00575
pop of  1 H 3s        0.00098
pop of  1 H 4s        0.00013
pop of  1 H 5s        0.00007
pop of  1 H 2px       0.00052
pop of  1 H 2py       0.00219
pop of  1 H 2pz       0.00103
pop of  1 H 3px       0.00003
pop of  1 H 3py       0.00001
pop of  1 H 3pz       0.00057
pop of  1 H 4px       0.00005
pop of  1 H 4py       0.00004
pop of  1 H 4pz       0.00001
pop of  1 H 5px       0.00001
pop of  1 H 5py       0.00001
pop of  1 H 5pz       0.00003
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00016
pop of  1 H 3dz^2     0.00005
pop of  1 H 3dxz      0.00005
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00001
pop of  1 H 4dz^2     0.00001
pop of  1 H 4dxz      0.00000
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00000
pop of  1 H 5dz^2     0.00001
pop of  1 H 5dxz      0.00001
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00000
pop of  1 H 4f 0      0.00005
pop of  1 H 4f 1      0.00000
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00002
pop of  1 H 5f 0      0.00005
pop of  1 H 5f 1      0.00000
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.32655
charge of  1H =      0.32655
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.88489
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:41:39 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       625.96

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp9s4cwjxl
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp9s4cwjxl
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248847958671063  LUMO = 0.259702641717807
Initial guess E= -75.386186454201  |g|= 0.000925595
macro= 0  E= -75.38618701385  delta_E= -5.59649e-07  |g|= 0.000925595  1 KF 4 JK
macro= 1  E= -75.38618701385  delta_E= 1.42109e-14  |g|= 2.38204e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.38618701385  |g|= 2.38204e-07  total 3 KF 9 JK
converged SCF energy = -75.38618701385
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:41:53 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       656.57

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpbc6rtyg2
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpbc6rtyg2
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248847217682978  LUMO = 0.259702268231258
Initial guess E= -75.3861864533271  |g|= 0.000925024
macro= 0  E= -75.3861870138501  delta_E= -5.60523e-07  |g|= 0.000925024  1 KF 3 JK
macro= 1  E= -75.3861870138501  delta_E= -1.42109e-14  |g|= 2.38999e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3861870138501  |g|= 2.38999e-07  total 3 KF 8 JK
converged SCF energy = -75.3861870138501
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:42:13 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       689.87

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpelo9xjm2
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpelo9xjm2
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.249546115551077  LUMO = 0.0246118222900716
Initial guess E= -75.3870019990613  |g|= 0.023337
macro= 0  E= -75.3871235295963  delta_E= -0.000121531  |g|= 0.000431579  2 KF 8 JK
macro= 1  E= -75.3871235295964  delta_E= -5.68434e-14  |g|= 5.76336e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3871235295964  |g|= 5.76336e-06  total 4 KF 13 JK
converged SCF energy = -75.3871235295964
u+d contributions  -0.05899411371608929
uu+dd contributions  -0.09082371748436248
ud contributions  -0.19483774597242595
u+d contributions  -0.008823429331145603
uu+dd contributions  -0.040546754368322994
ud contributions  -0.14435699343516745
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:42:27 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       721.29

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpz6zrfopc
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpz6zrfopc
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248266753171196  LUMO = 0.259866181187812
Initial guess E= -75.3861861009156  |g|= 0.00116905
macro= 0  E= -75.38618701385  delta_E= -9.12934e-07  |g|= 0.00116905  1 KF 2 JK
macro= 1  E= -75.3861870138501  delta_E= -8.52651e-14  |g|= 3.6236e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3861870138501  |g|= 3.6236e-07  total 3 KF 7 JK
converged SCF energy = -75.3861870138501
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.18/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.18)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 20:42:49 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       757.54

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmppnvq1aco
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmppnvq1aco
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248955833709262  LUMO = 0.024611294137906
Initial guess E= -75.3869760993244  |g|= 0.0173275
macro= 0  E= -75.3870635710198  delta_E= -8.74717e-05  |g|= 0.000276907  2 KF 7 JK
macro= 1  E= -75.3870635710199  delta_E= -1.13687e-13  |g|= 1.10281e-05  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.3870635710199  |g|= 1.10281e-05  total 4 KF 12 JK
converged SCF energy = -75.3870635710199
u+d contributions  -0.025760330646381488
uu+dd contributions  -0.04895849153021165
ud contributions  -0.11158485267994128
u+d contributions  -0.00635779489059151
uu+dd contributions  -0.029521972837331635
ud contributions  -0.09213968394393102
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


 >>>>> AM I PREPARED?  False
qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
In the tapering subroutine, i=0, E(i)=-75.025381, i_min=-1
In the tapering subroutine, i=1, E(i)=-75.236539, i_min=0
In the tapering subroutine, i=2, E(i)=-75.386187, i_min=1
In the tapering subroutine, i=3, E(i)=-75.115339, i_min=2
In the tapering subroutine, i=4, E(i)=-75.383790, i_min=2
In the tapering subroutine, i=5, E(i)=-75.108841, i_min=2
In the tapering subroutine, i=6, E(i)=-74.832294, i_min=2
In the tapering subroutine, i=7, E(i)=-75.131851, i_min=2
In the tapering subroutine, i=8, E(i)=-75.236539, i_min=2
In the tapering subroutine, i=9, E(i)=-75.237736, i_min=2
In the tapering subroutine, i=10, E(i)=-75.137425, i_min=2
In the tapering subroutine, i=11, E(i)=-75.386187, i_min=2
In the tapering subroutine, i=12, E(i)=-75.130509, i_min=2
In the tapering subroutine, i=13, E(i)=-75.383790, i_min=2
In the tapering subroutine, i=14, E(i)=-75.131851, i_min=2
In the tapering subroutine, i=15, E(i)=-74.870477, i_min=2
after tapering qubits(H) =  4
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.006357776028518523
uu+dd contributions  -0.02952201433247659
ud contributions  -0.09210534390400135
 >>>>> AM I PREPARED?  True
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.006364467370249705
uu+dd contributions  -0.029531220765879294
ud contributions  -0.09212371371492065
 >>>>> AM I PREPARED?  True
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.006364467370249705
uu+dd contributions  -0.029531220765879294
ud contributions  -0.09212371371492065
