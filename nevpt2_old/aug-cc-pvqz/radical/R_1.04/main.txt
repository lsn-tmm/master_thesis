#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:54:53 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   1.040000000000 AA    0.000000000000   0.000000000000   1.965315169548 Bohr

nuclear repulsion = 4.07059393015385
point group symmetry = Coov
num. orbitals of irrep A1 = 34
num. orbitals of irrep E1x = 23
num. orbitals of irrep E1y = 23
num. orbitals of irrep E2x = 14
num. orbitals of irrep E2y = 14
num. orbitals of irrep E3x = 7
num. orbitals of irrep E3y = 7
num. orbitals of irrep E4x = 2
num. orbitals of irrep E4y = 2
number of shells = 33
number of NR pGTOs = 141
number of NR cGTOs = 126
basis = aug-cc-pvqz
ecp = {}
CPU time:         3.93
Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp69cjqzg8
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp69cjqzg8
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.425188045812783  LUMO (A1) = 0.0223834196918526
Initial guess E= -75.4012144176725  |g|= 0.216766
macro= 0  E= -75.4123207854768  delta_E= -0.0111064  |g|= 0.216766  2 KF 5 JK
macro= 1  E= -75.4126845215723  delta_E= -0.000363736  |g|= 0.0930426  2 KF 5 JK
macro= 2  E= -75.4111182761877  delta_E= 0.00156625  |g|= 0.0629827  2 KF 5 JK
macro= 3  E= -75.4124748665858  delta_E= -0.00135659  |g|= 0.111508  2 KF 5 JK
macro= 4  E= -75.4111175102367  delta_E= 0.00135736  |g|= 0.0623647  2 KF 5 JK
macro= 5  E= -75.4125136178503  delta_E= -0.00139611  |g|= 0.110803  2 KF 5 JK
macro= 6  E= -75.4112788485413  delta_E= 0.00123477  |g|= 0.0639028  2 KF 5 JK
macro= 7  E= -75.4125399725395  delta_E= -0.00126112  |g|= 0.108661  2 KF 5 JK
macro= 8  E= -75.4111527844407  delta_E= 0.00138719  |g|= 0.0631437  2 KF 5 JK
macro= 9  E= -75.4125384112287  delta_E= -0.00138563  |g|= 0.110911  2 KF 5 JK
macro= 10  E= -75.4111794849424  delta_E= 0.00135893  |g|= 0.0633783  2 KF 5 JK
macro= 11  E= -75.412547508954  delta_E= -0.00136802  |g|= 0.110501  2 KF 5 JK
macro= 12  E= -75.4111315505579  delta_E= 0.00141596  |g|= 0.0631178  2 KF 5 JK
macro= 13  E= -75.4125513922784  delta_E= -0.00141984  |g|= 0.111304  2 KF 5 JK
macro= 14  E= -75.4111192660366  delta_E= 0.00143213  |g|= 0.0630931  2 KF 5 JK
macro= 15  E= -75.4125577484131  delta_E= -0.00143848  |g|= 0.111511  2 KF 5 JK
macro= 16  E= -75.4110901276324  delta_E= 0.00146762  |g|= 0.0629378  2 KF 5 JK
macro= 17  E= -75.4125629681575  delta_E= -0.00147284  |g|= 0.111982  2 KF 5 JK
macro= 18  E= -75.4110691871542  delta_E= 0.00149378  |g|= 0.0628383  2 KF 5 JK
macro= 19  E= -75.4125687675835  delta_E= -0.00149958  |g|= 0.112317  2 KF 5 JK
macro= 20  E= -75.4110446004862  delta_E= 0.00152417  |g|= 0.0627043  2 KF 5 JK
macro= 21  E= -75.412574329654  delta_E= -0.00152973  |g|= 0.112704  2 KF 5 JK
macro= 22  E= -75.411022008474  delta_E= 0.00155232  |g|= 0.0625807  2 KF 5 JK
macro= 23  E= -75.4125800300877  delta_E= -0.00155802  |g|= 0.113055  2 KF 5 JK
macro= 24  E= -75.4109987932665  delta_E= 0.00158124  |g|= 0.062446  2 KF 5 JK
macro= 25  E= -75.4125856846495  delta_E= -0.00158689  |g|= 0.113411  2 KF 5 JK
macro= 26  E= -75.4109762202708  delta_E= 0.00160946  |g|= 0.0623108  2 KF 5 JK
macro= 27  E= -75.4125913696888  delta_E= -0.00161515  |g|= 0.113752  2 KF 5 JK
macro= 28  E= -75.4109537326816  delta_E= 0.00163764  |g|= 0.0621702  2 KF 5 JK
macro= 29  E= -75.4125970408177  delta_E= -0.00164331  |g|= 0.114088  2 KF 5 JK
macro= 30  E= -75.4109316218148  delta_E= 0.00166542  |g|= 0.0620269  2 KF 5 JK
macro= 31  E= -75.4126027090177  delta_E= -0.00167109  |g|= 0.114413  2 KF 5 JK
macro= 32  E= -75.4109097821482  delta_E= 0.00169293  |g|= 0.0618799  2 KF 5 JK
macro= 33  E= -75.412608359996  delta_E= -0.00169858  |g|= 0.114731  2 KF 5 JK
macro= 34  E= -75.4108882893675  delta_E= 0.00172007  |g|= 0.0617299  2 KF 5 JK
macro= 35  E= -75.4126139909184  delta_E= -0.0017257  |g|= 0.11504  2 KF 5 JK
macro= 36  E= -75.4108671330163  delta_E= 0.00174686  |g|= 0.0615769  2 KF 5 JK
macro= 37  E= -75.4126195938982  delta_E= -0.00175246  |g|= 0.115341  2 KF 5 JK
macro= 38  E= -75.4108463396726  delta_E= 0.00177325  |g|= 0.0614212  2 KF 5 JK
macro= 39  E= -75.4126251634378  delta_E= -0.00177882  |g|= 0.115633  2 KF 5 JK
macro= 40  E= -75.4108259164495  delta_E= 0.00179925  |g|= 0.0612631  2 KF 5 JK
macro= 41  E= -75.4126306931841  delta_E= -0.00180478  |g|= 0.115917  2 KF 5 JK
macro= 42  E= -75.4108058768797  delta_E= 0.00182482  |g|= 0.0611028  2 KF 5 JK
macro= 43  E= -75.4126361774059  delta_E= -0.0018303  |g|= 0.116192  2 KF 5 JK
macro= 44  E= -75.410786229185  delta_E= 0.00184995  |g|= 0.0609405  2 KF 5 JK
macro= 45  E= -75.4126416103986  delta_E= -0.00185538  |g|= 0.116459  2 KF 5 JK
macro= 46  E= -75.4107669816823  delta_E= 0.00187463  |g|= 0.0607766  2 KF 5 JK
macro= 47  E= -75.4126469867838  delta_E= -0.00188001  |g|= 0.116717  2 KF 5 JK
macro= 48  E= -75.4107481404252  delta_E= 0.00189885  |g|= 0.0606112  2 KF 5 JK
macro= 49  E= -75.4105299532414  delta_E= 0.000218187  |g|= 0.116968  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4105299532414  |g|= 0.116968  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4105299532414

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.

Freeze 0 electrons in irreps []
    9 free electrons in irreps A1 E1x E1y E2x E2y E3x E3y E4x E4y




******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> ********
method = SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp69cjqzg8
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.hf_symm.SymAdaptedROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp69cjqzg8
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
HOMO (E1x) = -0.279243326727928  LUMO (A1) = 0.0267738629689689
Initial guess E= -75.4133736241239  |g|= 0.0727889
macro= 0  E= -75.4142201326618  delta_E= -0.000846509  |g|= 0.0727889  2 KF 5 JK
macro= 1  E= -75.4142416647384  delta_E= -2.15321e-05  |g|= 0.0226547  2 KF 5 JK
macro= 2  E= -75.4140603809621  delta_E= 0.000181284  |g|= 0.0157713  2 KF 5 JK
macro= 3  E= -75.414237823078  delta_E= -0.000177442  |g|= 0.034117  2 KF 5 JK
macro= 4  E= -75.4140704094857  delta_E= 0.000167414  |g|= 0.0127084  2 KF 5 JK
macro= 5  E= -75.4142187876799  delta_E= -0.000148378  |g|= 0.0343364  2 KF 5 JK
macro= 6  E= -75.4141663451028  delta_E= 5.24426e-05  |g|= 0.0157793  2 KF 5 JK
macro= 7  E= -75.414201996652  delta_E= -3.56515e-05  |g|= 0.0273631  2 KF 5 JK
macro= 8  E= -75.4141212585415  delta_E= 8.07381e-05  |g|= 0.0172519  2 KF 5 JK
macro= 9  E= -75.414240791714  delta_E= -0.000119533  |g|= 0.0302104  2 KF 5 JK
macro= 10  E= -75.4140935359735  delta_E= 0.000147256  |g|= 0.0154461  2 KF 5 JK
macro= 11  E= -75.4142353835142  delta_E= -0.000141848  |g|= 0.0322947  2 KF 5 JK
macro= 12  E= -75.4141353683756  delta_E= 0.000100015  |g|= 0.0158057  2 KF 5 JK
macro= 13  E= -75.4142316989806  delta_E= -9.63306e-05  |g|= 0.0290331  2 KF 5 JK
macro= 14  E= -75.414137561342  delta_E= 9.41376e-05  |g|= 0.0154064  2 KF 5 JK
macro= 15  E= -75.4142323447902  delta_E= -9.47834e-05  |g|= 0.0288567  2 KF 5 JK
macro= 16  E= -75.4141333792458  delta_E= 9.89655e-05  |g|= 0.0154149  2 KF 5 JK
macro= 17  E= -75.4142331695618  delta_E= -9.97903e-05  |g|= 0.0291497  2 KF 5 JK
macro= 18  E= -75.4141318118338  delta_E= 0.000101358  |g|= 0.0154681  2 KF 5 JK
macro= 19  E= -75.4142333105688  delta_E= -0.000101499  |g|= 0.029275  2 KF 5 JK
macro= 20  E= -75.4141320030527  delta_E= 0.000101308  |g|= 0.0154724  2 KF 5 JK
macro= 21  E= -75.4142332212286  delta_E= -0.000101218  |g|= 0.0292682  2 KF 5 JK
macro= 22  E= -75.4141321968378  delta_E= 0.000101024  |g|= 0.0154562  2 KF 5 JK
macro= 23  E= -75.4142332217471  delta_E= -0.000101025  |g|= 0.0292578  2 KF 5 JK
macro= 24  E= -75.4141320523591  delta_E= 0.000101169  |g|= 0.0154425  2 KF 5 JK
macro= 25  E= -75.4141964786927  delta_E= -6.44263e-05  |g|= 0.0292715  2 KF 5 JK
macro= 26  E= -75.4141513617875  delta_E= 4.51169e-05  |g|= 0.0188032  2 KF 5 JK
macro= 27  E= -75.414186990742  delta_E= -3.5629e-05  |g|= 0.0283538  2 KF 5 JK
macro= 28  E= -75.4141400363011  delta_E= 4.69544e-05  |g|= 0.0194816  2 KF 5 JK
macro= 29  E= -75.4141780186925  delta_E= -3.79824e-05  |g|= 0.0291452  2 KF 5 JK
macro= 30  E= -75.4141473320732  delta_E= 3.06866e-05  |g|= 0.0205952  2 KF 5 JK
macro= 31  E= -75.4141780847838  delta_E= -3.07527e-05  |g|= 0.0287881  2 KF 5 JK
macro= 32  E= -75.4141431689402  delta_E= 3.49158e-05  |g|= 0.0204069  2 KF 5 JK
macro= 33  E= -75.4141767317137  delta_E= -3.35628e-05  |g|= 0.0290384  2 KF 5 JK
macro= 34  E= -75.4141455211112  delta_E= 3.12106e-05  |g|= 0.0206124  2 KF 5 JK
macro= 35  E= -75.4141769101254  delta_E= -3.1389e-05  |g|= 0.0289177  2 KF 5 JK
macro= 36  E= -75.4141439085139  delta_E= 3.30016e-05  |g|= 0.0205296  2 KF 5 JK
macro= 37  E= -75.4141762655241  delta_E= -3.2357e-05  |g|= 0.0290203  2 KF 5 JK
macro= 38  E= -75.4141446891229  delta_E= 3.15764e-05  |g|= 0.0206125  2 KF 5 JK
macro= 39  E= -75.4141761070406  delta_E= -3.14179e-05  |g|= 0.0289869  2 KF 5 JK
macro= 40  E= -75.4141440098683  delta_E= 3.20972e-05  |g|= 0.0205972  2 KF 5 JK
macro= 41  E= -75.4141756470028  delta_E= -3.16371e-05  |g|= 0.0290363  2 KF 5 JK
macro= 42  E= -75.4141442264089  delta_E= 3.14206e-05  |g|= 0.0206424  2 KF 5 JK
macro= 43  E= -75.4141753654389  delta_E= -3.1139e-05  |g|= 0.0290348  2 KF 5 JK
macro= 44  E= -75.4141438893934  delta_E= 3.1476e-05  |g|= 0.0206511  2 KF 5 JK
macro= 45  E= -75.4141749758229  delta_E= -3.10864e-05  |g|= 0.0290646  2 KF 5 JK
macro= 46  E= -75.414143895704  delta_E= 3.10801e-05  |g|= 0.020682  2 KF 5 JK
macro= 47  E= -75.4141746539193  delta_E= -3.07582e-05  |g|= 0.0290749  2 KF 5 JK
macro= 48  E= -75.4141436868743  delta_E= 3.0967e-05  |g|= 0.020699  2 KF 5 JK
macro= 49  E= -75.4141742930409  delta_E= -3.06062e-05  |g|= 0.0290974  2 KF 5 JK
Canonicalize SCF orbitals
macro X = 50  E=-75.4141742930409  |g|= 0.0290974  total 101 KF 301 JK
SCF not converged.
SCF energy = -75.4141742930409
**** SCF Summaries ****
Total Energy =                         -75.414174293040929
Nuclear Repulsion Energy =               4.070593930153847
One-electron Energy =                 -112.107350218951851
Two-electron Energy =                   32.622581995757074
Wave-function symmetry = Coov
occupancy for each irrep:     A1  E1x  E1y  E2x  E2y  E3x  E3y  E4x  E4y
double occ                     3    0    1    0    0    0    0    0    0
single occ                     0    1    0    0    0    0    0    0    0
**** MO energy ****
                          Roothaan           | alpha              | beta
MO #1   (A1  #1 ) energy= -20.6355817179569  | -20.652461874936   | -20.6187015609777  occ= 2
MO #2   (A1  #2 ) energy= -1.2908877215678   | -1.36240157737561  | -1.21937386576     occ= 2
MO #3   (A1  #3 ) energy= -0.644219552583146 | -0.66355167668179  | -0.624887428484501 occ= 2
MO #4   (E1y #1 ) energy= -0.537429678803185 | -0.556585478757765 | -0.518273878848605 occ= 2
MO #5   (E1x #1 ) energy= -0.248167358555678 | -0.645948885615704 | 0.149614168504353  occ= 1
MO #6   (A1  #4 ) energy= 0.0272839091292328 | 0.0266856957899668 | 0.0278821224685014 occ= 0
MO #7   (A1  #5 ) energy= 0.113005748937618  | 0.112179630049629  | 0.113831867825559  occ= 0
MO #8   (E1x #2 ) energy= 0.136340406819079  | 0.132294855949836  | 0.140385957688323  occ= 0
MO #9   (E1y #2 ) energy= 0.140117332984628  | 0.13954971651317   | 0.140684949456086  occ= 0
MO #10  (A1  #6 ) energy= 0.159516492438913  | 0.157625088727532  | 0.161407896150285  occ= 0
MO #11  (E1x #3 ) energy= 0.212311569258161  | 0.210667956392967  | 0.213955182123357  occ= 0
MO #12  (E1y #3 ) energy= 0.215037254174615  | 0.21482000581849   | 0.215254502530734  occ= 0
MO #13  (A1  #7 ) energy= 0.222383695985712  | 0.220690149377624  | 0.224077242593798  occ= 0
MO #14  (A1  #8 ) energy= 0.336123149676593  | 0.332640774880728  | 0.339605524472459  occ= 0
MO #15  (E2x #1 ) energy= 0.478355138769681  | 0.473469482657541  | 0.483240794881819  occ= 0
MO #16  (E2y #1 ) energy= 0.47835513876968   | 0.473469482657541  | 0.483240794881819  occ= 0
MO #17  (A1  #9 ) energy= 0.500825391527327  | 0.497385767826981  | 0.504265015227701  occ= 0
MO #18  (E1x #4 ) energy= 0.545814761009897  | 0.540557834187611  | 0.551071687832184  occ= 0
MO #19  (E1y #4 ) energy= 0.550545525173541  | 0.549845331477615  | 0.55124571886947   occ= 0
MO #20  (A1  #10) energy= 0.640109355397422  | 0.638827588156004  | 0.64139112263888   occ= 0
MO #21  (E1x #5 ) energy= 0.645057482262561  | 0.63263353634505   | 0.65748142818007   occ= 0
MO #22  (E1y #5 ) energy= 0.647954920005051  | 0.646427904573944  | 0.64948193543616   occ= 0
MO #23  (E2x #2 ) energy= 0.685576205386737  | 0.684994313061421  | 0.686158097712045  occ= 0
MO #24  (E2y #2 ) energy= 0.685576205386733  | 0.684994313061417  | 0.686158097712041  occ= 0
MO #25  (A1  #11) energy= 0.705651820954635  | 0.701092563640054  | 0.710211078269224  occ= 0
MO #26  (E1x #6 ) energy= 0.757857921906938  | 0.735617197108445  | 0.780098646705435  occ= 0
MO #27  (E1y #6 ) energy= 0.763062726320638  | 0.760376550281795  | 0.765748902359485  occ= 0
MO #28  (A1  #12) energy= 0.780433647046477  | 0.776658342379526  | 0.784208951713706  occ= 0
MO #29  (E1x #7 ) energy= 1.13341495420504   | 1.12258128481873   | 1.14424862359137   occ= 0
MO #30  (E1y #7 ) energy= 1.13955003271228   | 1.13809500234781   | 1.14100506307675   occ= 0
MO #31  (A1  #13) energy= 1.22385294317085   | 1.2152220058357    | 1.23248388050625   occ= 0
MO #32  (E3x #1 ) energy= 1.32434738114661   | 1.31985387118261   | 1.32884089111061   occ= 0
MO #33  (E3y #1 ) energy= 1.32434738114661   | 1.31985387118261   | 1.32884089111061   occ= 0
MO #34  (A1  #14) energy= 1.43490598144511   | 1.4291423583217    | 1.44066960456852   occ= 0
MO #35  (E2x #3 ) energy= 1.49820119871914   | 1.47480775896339   | 1.52159463847488   occ= 0
MO #36  (E2y #3 ) energy= 1.49820119871914   | 1.47480775896339   | 1.52159463847489   occ= 0
MO #37  (E1x #8 ) energy= 1.53991632130586   | 1.53151717612609   | 1.54831546648564   occ= 0
MO #38  (E1y #8 ) energy= 1.55400337972682   | 1.55252868698355   | 1.55547807247008   occ= 0
MO #39  (E2x #4 ) energy= 1.56678491409301   | 1.56303788899937   | 1.57053193918665   occ= 0
MO #40  (E2y #4 ) energy= 1.566784914093     | 1.56303788899936   | 1.57053193918665   occ= 0
MO #41  (A1  #15) energy= 1.61646186870752   | 1.61251753610213   | 1.62040620131288   occ= 0
MO #42  (A1  #16) energy= 1.66572551346625   | 1.6636667187897    | 1.66778430814318   occ= 0
MO #43  (E3x #2 ) energy= 1.71107938248296   | 1.70983306268179   | 1.71232570228413   occ= 0
MO #44  (E3y #2 ) energy= 1.71107938248296   | 1.70983306268179   | 1.71232570228413   occ= 0
MO #45  (E1x #9 ) energy= 1.72089782944945   | 1.71064633696437   | 1.73114932193454   occ= 0
MO #46  (E1y #9 ) energy= 1.72704377610788   | 1.72561461108885   | 1.72847294112689   occ= 0
MO #47  (E2x #5 ) energy= 1.89409402680474   | 1.89059861800682   | 1.89758943560265   occ= 0
MO #48  (E2y #5 ) energy= 1.89409402680476   | 1.89059861800684   | 1.89758943560267   occ= 0
MO #49  (A1  #17) energy= 1.92889162121218   | 1.92465022486918   | 1.93313301755491   occ= 0
MO #50  (E1x #10) energy= 2.11286489382594   | 2.09833668408674   | 2.12739310356514   occ= 0
MO #51  (E1y #10) energy= 2.12515886811768   | 2.12279914150931   | 2.12751859472606   occ= 0
MO #52  (A1  #18) energy= 2.34266718271417   | 2.33758876512395   | 2.34774560030441   occ= 0
MO #53  (E1x #11) energy= 2.59227009969362   | 2.55000036491023   | 2.63453983447701   occ= 0
MO #54  (E1y #11) energy= 2.60177677754223   | 2.59607444545767   | 2.6074791096268    occ= 0
MO #55  (E2x #6 ) energy= 2.85672929849161   | 2.85223997759949   | 2.86121861938374   occ= 0
MO #56  (E2y #6 ) energy= 2.85672929849163   | 2.8522399775995    | 2.86121861938376   occ= 0
MO #57  (E1x #12) energy= 2.90446166945002   | 2.89887378222152   | 2.91004955667854   occ= 0
MO #58  (E1y #12) energy= 2.91640446118205   | 2.91539777811718   | 2.91741114424691   occ= 0
MO #59  (A1  #19) energy= 3.0085793300282    | 3.00479532142255   | 3.0123633386339    occ= 0
MO #60  (A1  #20) energy= 3.56699726269065   | 3.55898063884563   | 3.57501388653614   occ= 0
MO #61  (E4x #1 ) energy= 3.65790003530839   | 3.65062902991414   | 3.66517104070265   occ= 0
MO #62  (E4y #1 ) energy= 3.65790003530838   | 3.65062902991413   | 3.66517104070264   occ= 0
MO #63  (E1x #13) energy= 3.76422791020368   | 3.74289212867615   | 3.78556369173118   occ= 0
MO #64  (E1y #13) energy= 3.7881514455721    | 3.78400870813475   | 3.79229418300944   occ= 0
MO #65  (E3x #3 ) energy= 3.88183848155477   | 3.87431887796572   | 3.88935808514382   occ= 0
MO #66  (E3y #3 ) energy= 3.88183848155477   | 3.87431887796572   | 3.88935808514382   occ= 0
MO #67  (A1  #21) energy= 3.97847824335935   | 3.96938644448102   | 3.98757004223774   occ= 0
MO #68  (E3x #4 ) energy= 4.08808238254382   | 4.07192092112518   | 4.10424384396245   occ= 0
MO #69  (E3y #4 ) energy= 4.08808238254382   | 4.07192092112518   | 4.10424384396245   occ= 0
MO #70  (E2x #7 ) energy= 4.16285519034542   | 4.15257402312704   | 4.1731363575638    occ= 0
MO #71  (E2y #7 ) energy= 4.16285519034541   | 4.15257402312703   | 4.1731363575638    occ= 0
MO #72  (E1x #14) energy= 4.20338851244882   | 4.18898622414679   | 4.21779080075086   occ= 0
MO #73  (A1  #22) energy= 4.21431306262857   | 4.20016795959472   | 4.22845816566284   occ= 0
MO #74  (E1y #14) energy= 4.22784151813845   | 4.22539008140181   | 4.23029295487511   occ= 0
MO #75  (E2x #8 ) energy= 4.24904887652339   | 4.2220806895356    | 4.27601706351119   occ= 0
MO #76  (E2y #8 ) energy= 4.24904887652338   | 4.22208068953559   | 4.27601706351118   occ= 0
MO #77  (A1  #23) energy= 4.34251583341135   | 4.33815852200215   | 4.34687314482055   occ= 0
MO #78  (E1x #15) energy= 4.69002690404388   | 4.66408135977783   | 4.71597244830993   occ= 0
MO #79  (E1y #15) energy= 4.71399963755184   | 4.70936004122674   | 4.71863923387693   occ= 0
MO #80  (E2x #9 ) energy= 4.75601408514866   | 4.73828676278466   | 4.77374140751267   occ= 0
MO #81  (E2y #9 ) energy= 4.75601408514867   | 4.73828676278467   | 4.77374140751267   occ= 0
MO #82  (A1  #24) energy= 5.2251933551631    | 5.21836902820003   | 5.23201768212631   occ= 0
MO #83  (E1x #16) energy= 5.41512509572128   | 5.3995081505952    | 5.43074204084737   occ= 0
MO #84  (E1y #16) energy= 5.44023571575377   | 5.4371930150375    | 5.44327841647006   occ= 0
MO #85  (A1  #25) energy= 5.66877479770917   | 5.65850643173374   | 5.67904316368492   occ= 0
MO #86  (E3x #5 ) energy= 6.6324228015169    | 6.63129346359593   | 6.63355213943787   occ= 0
MO #87  (E3y #5 ) energy= 6.6324228015169    | 6.63129346359593   | 6.63355213943788   occ= 0
MO #88  (E2x #10) energy= 7.51159517241111   | 7.50894818108758   | 7.51424216373462   occ= 0
MO #89  (E2y #10) energy= 7.5115951724111    | 7.50894818108757   | 7.51424216373461   occ= 0
MO #90  (A1  #26) energy= 7.58979574169744   | 7.58701159087918   | 7.5925798925157    occ= 0
MO #91  (E1x #17) energy= 7.70396128855577   | 7.70085647129203   | 7.70706610581948   occ= 0
MO #92  (E1y #17) energy= 7.71435039764847   | 7.7136784840353    | 7.71502231126162   occ= 0
MO #93  (A1  #27) energy= 8.35463308278022   | 8.35218649813356   | 8.35707966742692   occ= 0
MO #94  (E2x #11) energy= 8.52144702122346   | 8.52049610761422   | 8.5223979348327    occ= 0
MO #95  (E2y #11) energy= 8.52144702122347   | 8.52049610761423   | 8.5223979348327    occ= 0
MO #96  (E1x #18) energy= 8.75600742964508   | 8.75304696775648   | 8.75896789153368   occ= 0
MO #97  (E1y #18) energy= 8.76691541464239   | 8.76628631112626   | 8.76754451815855   occ= 0
MO #98  (E1x #19) energy= 9.47893030359113   | 9.47096460055241   | 9.48689600662982   occ= 0
MO #99  (E1y #19) energy= 9.49738095083997   | 9.49559306569933   | 9.49916883598064   occ= 0
MO #100 (A1  #28) energy= 9.5647163278967    | 9.56141210493449   | 9.56802055085892   occ= 0
MO #101 (E4x #2 ) energy= 10.6107117462383   | 10.5944970876978   | 10.6269264047789   occ= 0
MO #102 (E4y #2 ) energy= 10.6107117462383   | 10.5944970876977   | 10.6269264047788   occ= 0
MO #103 (E3x #6 ) energy= 10.7288229115696   | 10.7161535840288   | 10.7414922391105   occ= 0
MO #104 (E3y #6 ) energy= 10.7288229115696   | 10.7161535840288   | 10.7414922391105   occ= 0
MO #105 (E1x #20) energy= 10.9104626827017   | 10.8685939217524   | 10.9523314436509   occ= 0
MO #106 (A1  #29) energy= 10.9225769862175   | 10.9164392393208   | 10.9287147331145   occ= 0
MO #107 (E1y #20) energy= 10.9482497351211   | 10.9407943004027   | 10.9557051698396   occ= 0
MO #108 (E2x #12) energy= 11.0522467531536   | 11.0424113161238   | 11.0620821901834   occ= 0
MO #109 (E2y #12) energy= 11.0522467531536   | 11.0424113161237   | 11.0620821901834   occ= 0
MO #110 (E1x #21) energy= 11.4788854754444   | 11.4636241737676   | 11.4941467771212   occ= 0
MO #111 (A1  #30) energy= 11.515334141171    | 11.5067264319046   | 11.5239418504374   occ= 0
MO #112 (E1y #21) energy= 11.5195327520237   | 11.5161620238392   | 11.5229034802083   occ= 0
MO #113 (E3x #7 ) energy= 11.8585105982079   | 11.8327494616767   | 11.8842717347391   occ= 0
MO #114 (E3y #7 ) energy= 11.8585105982079   | 11.8327494616767   | 11.8842717347391   occ= 0
MO #115 (A1  #31) energy= 11.9246005167363   | 11.9137235949831   | 11.9354774384894   occ= 0
MO #116 (E2x #13) energy= 12.0008070842714   | 11.982722849073    | 12.0188913194699   occ= 0
MO #117 (E2y #13) energy= 12.0008070842714   | 11.982722849073    | 12.0188913194699   occ= 0
MO #118 (E1x #22) energy= 12.4966390841362   | 12.4762246035205   | 12.5170535647519   occ= 0
MO #119 (E1y #22) energy= 12.534836479427    | 12.5304402545627   | 12.5392327042914   occ= 0
MO #120 (E2x #14) energy= 12.7862478001791   | 12.7559382210257   | 12.8165573793325   occ= 0
MO #121 (E2y #14) energy= 12.7862478001791   | 12.7559382210257   | 12.8165573793325   occ= 0
MO #122 (A1  #32) energy= 13.8900064115359   | 13.8843965464049   | 13.895616276667    occ= 0
MO #123 (E1x #23) energy= 13.9580358101044   | 13.934924476555    | 13.9811471436537   occ= 0
MO #124 (E1y #23) energy= 13.9937640640381   | 13.9892064390281   | 13.9983216890482   occ= 0
MO #125 (A1  #33) energy= 16.2369052139768   | 16.2309867655533   | 16.2428236624009   occ= 0
MO #126 (A1  #34) energy= 42.5962277096024   | 42.5863933523705   | 42.6060620668356   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 O 1s        1.99999
pop of  0 O 2s        1.84535
pop of  0 O 3s        0.00355
pop of  0 O 4s        0.00112
pop of  0 O 5s        0.00024
pop of  0 O 6s        0.00005
pop of  0 O 2px       0.99704
pop of  0 O 2py       1.99223
pop of  0 O 2pz       1.48823
pop of  0 O 3px       0.00013
pop of  0 O 3py       0.00144
pop of  0 O 3pz       0.00082
pop of  0 O 4px       0.00067
pop of  0 O 4py       0.00060
pop of  0 O 4pz       0.00186
pop of  0 O 5px       0.00007
pop of  0 O 5py       0.00020
pop of  0 O 5pz       0.00007
pop of  0 O 6px       0.00001
pop of  0 O 6py       0.00002
pop of  0 O 6pz       0.00006
pop of  0 O 3dxy      0.00000
pop of  0 O 3dyz      0.00165
pop of  0 O 3dz^2     0.00700
pop of  0 O 3dxz      0.00078
pop of  0 O 3dx2-y2    0.00000
pop of  0 O 4dxy      0.00000
pop of  0 O 4dyz      0.00034
pop of  0 O 4dz^2     0.00057
pop of  0 O 4dxz      0.00016
pop of  0 O 4dx2-y2    0.00000
pop of  0 O 5dxy      0.00000
pop of  0 O 5dyz      0.00004
pop of  0 O 5dz^2     0.00008
pop of  0 O 5dxz      0.00002
pop of  0 O 5dx2-y2    0.00000
pop of  0 O 6dxy      0.00000
pop of  0 O 6dyz      0.00001
pop of  0 O 6dz^2     0.00011
pop of  0 O 6dxz      0.00000
pop of  0 O 6dx2-y2    0.00000
pop of  0 O 4f-3      0.00000
pop of  0 O 4f-2      0.00000
pop of  0 O 4f-1      0.00018
pop of  0 O 4f 0      0.00068
pop of  0 O 4f 1      0.00001
pop of  0 O 4f 2      0.00000
pop of  0 O 4f 3      0.00000
pop of  0 O 5f-3      0.00000
pop of  0 O 5f-2      0.00000
pop of  0 O 5f-1      0.00005
pop of  0 O 5f 0      0.00008
pop of  0 O 5f 1      0.00001
pop of  0 O 5f 2      0.00000
pop of  0 O 5f 3      0.00000
pop of  0 O 6f-3      0.00000
pop of  0 O 6f-2      0.00000
pop of  0 O 6f-1      0.00001
pop of  0 O 6f 0      0.00003
pop of  0 O 6f 1      0.00000
pop of  0 O 6f 2      0.00000
pop of  0 O 6f 3      0.00000
pop of  0 O 5g-4      0.00000
pop of  0 O 5g-3      0.00000
pop of  0 O 5g-2      0.00000
pop of  0 O 5g-1      0.00003
pop of  0 O 5g 0      0.00018
pop of  0 O 5g 1      0.00001
pop of  0 O 5g 2      0.00000
pop of  0 O 5g 3      0.00000
pop of  0 O 5g 4      0.00000
pop of  0 O 6g-4      0.00000
pop of  0 O 6g-3      0.00000
pop of  0 O 6g-2      0.00000
pop of  0 O 6g-1      0.00001
pop of  0 O 6g 0      0.00005
pop of  0 O 6g 1      0.00001
pop of  0 O 6g 2      0.00000
pop of  0 O 6g 3      0.00000
pop of  0 O 6g 4      0.00000
pop of  1 H 1s        0.63492
pop of  1 H 2s        0.00976
pop of  1 H 3s        0.00307
pop of  1 H 4s        0.00008
pop of  1 H 5s        0.00004
pop of  1 H 2px       0.00043
pop of  1 H 2py       0.00298
pop of  1 H 2pz       0.00082
pop of  1 H 3px       0.00034
pop of  1 H 3py       0.00000
pop of  1 H 3pz       0.00040
pop of  1 H 4px       0.00015
pop of  1 H 4py       0.00003
pop of  1 H 4pz       0.00011
pop of  1 H 5px       0.00003
pop of  1 H 5py       0.00001
pop of  1 H 5pz       0.00003
pop of  1 H 3dxy      0.00000
pop of  1 H 3dyz      0.00010
pop of  1 H 3dz^2     0.00020
pop of  1 H 3dxz      0.00007
pop of  1 H 3dx2-y2    0.00000
pop of  1 H 4dxy      0.00000
pop of  1 H 4dyz      0.00000
pop of  1 H 4dz^2     0.00001
pop of  1 H 4dxz      0.00001
pop of  1 H 4dx2-y2    0.00000
pop of  1 H 5dxy      0.00000
pop of  1 H 5dyz      0.00000
pop of  1 H 5dz^2     0.00009
pop of  1 H 5dxz      0.00003
pop of  1 H 5dx2-y2    0.00000
pop of  1 H 4f-3      0.00000
pop of  1 H 4f-2      0.00000
pop of  1 H 4f-1      0.00001
pop of  1 H 4f 0      0.00013
pop of  1 H 4f 1      0.00000
pop of  1 H 4f 2      0.00000
pop of  1 H 4f 3      0.00000
pop of  1 H 5f-3      0.00000
pop of  1 H 5f-2      0.00000
pop of  1 H 5f-1      0.00007
pop of  1 H 5f 0      0.00022
pop of  1 H 5f 1      0.00001
pop of  1 H 5f 2      0.00000
pop of  1 H 5f 3      0.00000
 ** Mulliken atomic charges  **
charge of  0O =     -0.34586
charge of  1H =      0.34586
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000,  1.79949
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:57:57 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       571.13

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpcgzauwsy
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 4  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpcgzauwsy
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248167358555678  LUMO = 0.364624498629452
Initial guess E= -75.4141861992964  |g|= 0.000665229
macro= 0  E= -75.4141864711962  delta_E= -2.719e-07  |g|= 0.000665229  1 KF 4 JK
macro= 1  E= -75.4141864711962  delta_E= -1.42109e-14  |g|= 1.20875e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4141864711962  |g|= 1.20875e-07  total 3 KF 9 JK
converged SCF energy = -75.4141864711962
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:58:15 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       607.07

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp0ljqqez_
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp0ljqqez_
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248166089192935  LUMO = 0.364623925682852
Initial guess E= -75.4141861981601  |g|= 0.000666414
macro= 0  E= -75.4141864711962  delta_E= -2.73036e-07  |g|= 0.000666414  1 KF 3 JK
macro= 1  E= -75.4141864711962  delta_E= 0  |g|= 1.21457e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4141864711962  |g|= 1.21457e-07  total 3 KF 8 JK
converged SCF energy = -75.4141864711962
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:58:42 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       648.09

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp5s785jun
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 3  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmp5s785jun
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248628803213018  LUMO = 0.0272747512201958
Initial guess E= -75.4148910310035  |g|= 0.0113786
macro= 0  E= -75.4149226653382  delta_E= -3.16343e-05  |g|= 0.000398474  2 KF 7 JK
macro= 1  E= -75.4149226653576  delta_E= -1.9412e-11  |g|= 1.24654e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4149226653576  |g|= 1.24654e-05  total 4 KF 13 JK
converged SCF energy = -75.4149226653576
u+d contributions  -0.05757740146623029
uu+dd contributions  -0.09005525005829665
ud contributions  -0.1967420889010871
u+d contributions  -0.00853656160533418
uu+dd contributions  -0.04091091279117424
ud contributions  -0.14740823098759506
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:59:02 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       681.09

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpy32x7g57
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpy32x7g57
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.247913202467346  LUMO = 0.36468865148217
Initial guess E= -75.4141861069726  |g|= 0.000772899
macro= 0  E= -75.4141864711961  delta_E= -3.64224e-07  |g|= 0.000772899  1 KF 2 JK
macro= 1  E= -75.4141864711961  delta_E= -1.42109e-14  |g|= 1.37647e-07  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4141864711961  |g|= 1.37647e-07  total 3 KF 7 JK
converged SCF energy = -75.4141864711961
#INFO: **** input file is /Users/mario/Documents/GitHub/UniMi/tesi_alessandro_tammaro/nevpt2/aug-cc-pvqz/radical/R_1.04/main.py ****
import numpy as np
import sys
sys.path.append('../../../src/')
from basis_constructor import Basis_Constructor
from bo_class          import BO_class
from bo_solver         import BO_solver
from fci_qse_solver    import FCI_QSE_solver
from fci_solver        import FCI_solver
from vqe_qse_solver    import VQE_QSE_solver
from pyscf             import gto,scf
from VQE_types         import vqe_data

outfile = open('results.txt','w')
mol = gto.M(atom=[['O',(0,0,0)],['H',(0,0,1.04)]],basis='aug-cc-pvqz',spin=1,charge=0,
            symmetry=True,verbose=4).build()
mf  = scf.ROHF(mol)
mf  = scf.newton(mf)
mf.kernel()
if(not mf.converged):
   mf.kernel(mf.make_rdm1())
mf.analyze()

BC_object = Basis_Constructor(mol,mf)
BC_object.compute_core_valence()
BC_object.compute_external()

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s frozen] NEVPT2 energy  %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

BO_IAO = BO_class(mol,mf)
BO_IAO.transform_integrals(BC_object.valence)
BO_IAO = BO_IAO.freeze_orbitals([0,1])
BO_IAO_solver = BO_solver(BO_IAO)
outfile.write("IAO, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_solver.solve_with_scf()[1])
outfile.write("IAO, [1s,2s frozen] FCI energy %.12f \n" % BO_IAO_solver.solve_with_fci()[0])

BO_IAO_external = BO_class(mol,mf)
BO_IAO_external.transform_integrals(BC_object.return_basis())
BO_IAO_external = BO_IAO_external.freeze_orbitals([0,1])
BO_IAO_external_solver = BO_solver(BO_IAO_external)
outfile.write("FULL, [1s,2s frozen] SCF energy %.12f \n" % BO_IAO_external_solver.solve_with_scf()[1])
outfile.write("FULL, [1s,2s frozen] FCI energy %.12f \n" % np.nan)

SOLVER = FCI_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+FCI [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())
SOLVER = FCI_QSE_solver(BO_IAO,BO_IAO_external)
outfile.write("FCI+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

VQE_settings = vqe_data()
SOLVER = VQE_QSE_solver(BO_IAO,BO_IAO_external)
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(q-UCCSD)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_q_uccsd_output.npy',allow_pickle=True).item()
outfile.write("VQE(q-UCCSD) energy %.12f \n" % x['energy'])
VQE_settings.ansatz = 'su2'
VQE_settings.optimizer = 'cg'
VQE_settings.reps = 3
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (I) %.12f \n" % x['energy'])
VQE_settings.instance = 'statevector_simulator'
VQE_settings.optimizer = 'cobyla'
VQE_settings.max_iter = 0
VQE_settings.initial_point = x['opt_params']
SOLVER.set_quantum_variables(VQE_settings)
outfile.write("VQE(Ry)+QSE [1s,2s frozen] NEVPT2 energy %.12f \n" % SOLVER.compute_nevpt2_energy())

#  -----------------------------------------------------------------------------

x = np.load('vqe_su2_output.npy',allow_pickle=True).item()
outfile.write("VQE(Ry) energy (II) %.12f \n" % x['energy'])
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Marios-MacBook-Pro.local', release='20.6.0', version='Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64', machine='x86_64', processor='i386')  Threads 1
Python 3.7.9 (default, Aug 31 2020, 07:22:35) 
[Clang 10.0.0 ]
numpy 1.20.1  scipy 1.6.0
Date: Sun Jan  2 18:59:27 2022
PySCF version 1.7.6
PySCF path  /Users/mario/anaconda3/envs/qiskit2021/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 0
[INPUT] num. electrons = 0
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom

nuclear repulsion = 0
number of shells = 0
number of NR pGTOs = 0
number of NR cGTOs = 0
basis = sto-3g
ecp = {}
CPU time:       721.95

WARN: Newton solver expects mo_coeff with mo_occ as initial guess but mo_occ is not found in the arguments.
      The given argument is treated as density matrix.





******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpioafy6v4
max_memory 4000 MB (current use 0 MB)
num. doubly occ = 2  num. singly occ = 1
******** <class 'pyscf.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/7m/f464jvrs78n7m3djcnsxfxgr0000gn/T/tmpioafy6v4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 0 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.248374428627442  LUMO = 0.0272721294459354
Initial guess E= -75.4148424911137  |g|= 0.00835769
macro= 0  E= -75.4148657237588  delta_E= -2.32326e-05  |g|= 0.000324057  2 KF 7 JK
macro= 1  E= -75.4148657237588  delta_E= 2.84217e-14  |g|= 7.72833e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 2  E=-75.4148657237588  |g|= 7.72833e-06  total 4 KF 12 JK
converged SCF energy = -75.4148657237588
u+d contributions  -0.024206887398562957
uu+dd contributions  -0.04841689875654729
ud contributions  -0.11475207406492298
u+d contributions  -0.005650932259420729
uu+dd contributions  -0.029834400369432423
ud contributions  -0.09614732098375584
----- VQE data ------
target_sector:  None
optimizer:  bfgs
max_iter:  1000
instance:  statevector_simulator
shots:  1000
ansatz:  q_uccsd
initial_point:  None


 >>>>> AM I PREPARED?  False
qse operators prepared for  u
qse operators prepared for  d
qse operators prepared for  uu
qse operators prepared for  dd
qse operators prepared for  ud
In the tapering subroutine, i=0, E(i)=-74.928064, i_min=-1
In the tapering subroutine, i=1, E(i)=-75.252063, i_min=0
In the tapering subroutine, i=2, E(i)=-75.414186, i_min=1
In the tapering subroutine, i=3, E(i)=-75.037514, i_min=2
In the tapering subroutine, i=4, E(i)=-75.409824, i_min=2
In the tapering subroutine, i=5, E(i)=-75.026068, i_min=2
In the tapering subroutine, i=6, E(i)=-74.859082, i_min=2
In the tapering subroutine, i=7, E(i)=-75.067018, i_min=2
In the tapering subroutine, i=8, E(i)=-75.252063, i_min=2
In the tapering subroutine, i=9, E(i)=-75.263032, i_min=2
In the tapering subroutine, i=10, E(i)=-75.061569, i_min=2
In the tapering subroutine, i=11, E(i)=-75.414186, i_min=2
In the tapering subroutine, i=12, E(i)=-75.049372, i_min=2
In the tapering subroutine, i=13, E(i)=-75.409824, i_min=2
In the tapering subroutine, i=14, E(i)=-75.067018, i_min=2
In the tapering subroutine, i=15, E(i)=-74.897394, i_min=2
after tapering qubits(H) =  4
qse operators tapered for  hamiltonian
qse operators tapered for  qse_s_u
qse operators tapered for  qse_h_u
qse operators tapered for  qse_s_d
qse operators tapered for  qse_h_d
qse operators tapered for  qse_s_uu
qse operators tapered for  qse_h_uu
qse operators tapered for  qse_s_dd
qse operators tapered for  qse_h_dd
qse operators tapered for  qse_s_ud
qse operators tapered for  qse_h_ud
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.005650880734169026
uu+dd contributions  -0.02983447795682057
ud contributions  -0.09613573116113314
 >>>>> AM I PREPARED?  True
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.005652144802507
uu+dd contributions  -0.029836309604313584
ud contributions  -0.09613863947436165
 >>>>> AM I PREPARED?  True
          
q_0: 
     
q_1:  X 
     
q_2: 
          
q_3: 
          
u+d contributions  -0.005652144802507
uu+dd contributions  -0.029836309604313584
ud contributions  -0.09613863947436165
